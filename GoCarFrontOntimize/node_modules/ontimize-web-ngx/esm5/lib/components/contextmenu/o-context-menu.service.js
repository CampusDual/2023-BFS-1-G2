import { Overlay, ScrollStrategyOptions } from '@angular/cdk/overlay';
import { ComponentPortal } from '@angular/cdk/portal';
import { ChangeDetectorRef, ElementRef, Injectable, Renderer2 } from '@angular/core';
import { Subject, Subscription } from 'rxjs';
import { OContextMenuContentComponent } from './context-menu/o-context-menu-content.component';
import { OContextMenuOverlayService } from './o-context-menu-overlay.service';
var OContextMenuService = (function () {
    function OContextMenuService(overlay, scrollStrategy, cd, overlayService, renderer) {
        this.overlay = overlay;
        this.scrollStrategy = scrollStrategy;
        this.cd = cd;
        this.overlayService = overlayService;
        this.renderer = renderer;
        this.showContextMenu = new Subject();
        this.closeContextMenu = new Subject();
        this.fakeElement = new ElementRef({ nativeElement: '' });
        this.subscription = new Subscription();
    }
    OContextMenuService.prototype.ngOnDestroy = function () {
        this.subscription.unsubscribe();
    };
    OContextMenuService.prototype.openContextMenu = function (context) {
        this.destroyOverlays();
        this.createOverlay(context);
    };
    OContextMenuService.prototype.destroyOverlays = function () {
        this.overlayService.destroyOverlays();
    };
    OContextMenuService.prototype.createOverlay = function (context) {
        var _this = this;
        context.event.preventDefault();
        context.event.stopPropagation();
        this.fakeElement.nativeElement.getBoundingClientRect = function () { return ({
            bottom: context.event.clientY,
            height: 0,
            left: context.event.clientX,
            right: context.event.clientX,
            top: context.event.clientY,
            width: 0,
            x: 0,
            y: 0,
            toJSON: function () { }
        }); };
        var positionStrategy = this.overlay.position()
            .flexibleConnectedTo(context.anchorElement || this.fakeElement)
            .withPositions([{
                overlayX: 'start',
                overlayY: 'top',
                originX: 'start',
                originY: 'bottom'
            }]);
        var overlayRef = this.overlay.create({
            positionStrategy: positionStrategy,
            hasBackdrop: false,
            panelClass: ['o-context-menu'],
            scrollStrategy: this.scrollStrategy.close()
        });
        this.overlayService.addOverlay(overlayRef);
        this.attachContextMenu(overlayRef, context);
        setTimeout(function () {
            overlayRef.hostElement.classList.add('overlay-ref-display-none');
            var nextSibling = overlayRef.hostElement.nextElementSibling;
            if (nextSibling) {
                var top_1 = nextSibling.getBoundingClientRect().top;
                _this.renderer.setStyle(nextSibling, 'top', top_1 - 32 + "px");
            }
            _this.cd.detectChanges();
        });
    };
    OContextMenuService.prototype.attachContextMenu = function (overlay, context) {
        var _this = this;
        var contextMenuContent = overlay.attach(new ComponentPortal(OContextMenuContentComponent));
        contextMenuContent.instance.overlay = overlay;
        contextMenuContent.instance.menuItems = context.menuItems;
        contextMenuContent.instance.externalMenuItems = context.externalMenuItems;
        contextMenuContent.instance.data = context.data;
        contextMenuContent.instance.menuClass = context.class;
        this.subscription.add(contextMenuContent.instance.close.subscribe(function () {
            _this.closeContextMenu.next();
            _this.destroyOverlays();
        }));
    };
    OContextMenuService.decorators = [
        { type: Injectable }
    ];
    OContextMenuService.ctorParameters = function () { return [
        { type: Overlay },
        { type: ScrollStrategyOptions },
        { type: ChangeDetectorRef },
        { type: OContextMenuOverlayService },
        { type: Renderer2 }
    ]; };
    return OContextMenuService;
}());
export { OContextMenuService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiby1jb250ZXh0LW1lbnUuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL29udGltaXplLXdlYi1uZ3gvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9jb250ZXh0bWVudS9vLWNvbnRleHQtbWVudS5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxPQUFPLEVBQWMscUJBQXFCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNsRixPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLGlCQUFpQixFQUFnQixVQUFVLEVBQUUsVUFBVSxFQUFhLFNBQVMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM5RyxPQUFPLEVBQUUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUc3QyxPQUFPLEVBQUUsNEJBQTRCLEVBQUUsTUFBTSxpREFBaUQsQ0FBQztBQUMvRixPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQztBQUU5RTtJQVFFLDZCQUNVLE9BQWdCLEVBQ2hCLGNBQXFDLEVBQ3JDLEVBQXFCLEVBQ3JCLGNBQTBDLEVBQzFDLFFBQW1CO1FBSm5CLFlBQU8sR0FBUCxPQUFPLENBQVM7UUFDaEIsbUJBQWMsR0FBZCxjQUFjLENBQXVCO1FBQ3JDLE9BQUUsR0FBRixFQUFFLENBQW1CO1FBQ3JCLG1CQUFjLEdBQWQsY0FBYyxDQUE0QjtRQUMxQyxhQUFRLEdBQVIsUUFBUSxDQUFXO1FBVnRCLG9CQUFlLEdBQXFDLElBQUksT0FBTyxFQUEyQixDQUFDO1FBQzNGLHFCQUFnQixHQUFtQixJQUFJLE9BQU8sRUFBRSxDQUFDO1FBQzlDLGdCQUFXLEdBQWUsSUFBSSxVQUFVLENBQUMsRUFBRSxhQUFhLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUNoRSxpQkFBWSxHQUFpQixJQUFJLFlBQVksRUFBRSxDQUFDO0lBUXRELENBQUM7SUFFRSx5Q0FBVyxH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QU8sQ0FBQztRQUM5QyxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsU0FBUyxHQUFHLE9BQU8sQ0FBQyxTQUFTLENBQUM7UUFDMUQsa0JBQWtCLENBQUMsUUFBUSxDQUFDLGlCQUFpQixHQUFHLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQztRQUMxRSxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsSUFBSSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUM7UUFDaEQsa0JBQWtCLENBQUMsUUFBUSxDQUFDLFNBQVMsR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDO1FBQ3RELElBQUksQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLGtCQUFrQixDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDO1lBQ2hFLEtBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUM3QixLQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7UUFDekIsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNOLENBQUM7O2dCQTNGRixVQUFVOzs7Z0JBVEYsT0FBTztnQkFBYyxxQkFBcUI7Z0JBRTFDLGlCQUFpQjtnQkFLakIsMEJBQTBCO2dCQUwwQyxTQUFTOztJQW9HdEYsMEJBQUM7Q0FBQSxBQTdGRCxJQTZGQztTQTVGWSxtQkFBbUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBPdmVybGF5LCBPdmVybGF5UmVmLCBTY3JvbGxTdHJhdGVneU9wdGlvbnMgfSBmcm9tICdAYW5ndWxhci9jZGsvb3ZlcmxheSc7XG5pbXBvcnQgeyBDb21wb25lbnRQb3J0YWwgfSBmcm9tICdAYW5ndWxhci9jZGsvcG9ydGFsJztcbmltcG9ydCB7IENoYW5nZURldGVjdG9yUmVmLCBDb21wb25lbnRSZWYsIEVsZW1lbnRSZWYsIEluamVjdGFibGUsIE9uRGVzdHJveSwgUmVuZGVyZXIyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBTdWJqZWN0LCBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcblxuaW1wb3J0IHsgSU9Db250ZXh0TWVudUNsaWNrRXZlbnQsIElPQ29udGV4dE1lbnVDb250ZXh0IH0gZnJvbSAnLi4vLi4vaW50ZXJmYWNlcy9vLWNvbnRleHQtbWVudS5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgT0NvbnRleHRNZW51Q29udGVudENvbXBvbmVudCB9IGZyb20gJy4vY29udGV4dC1tZW51L28tY29udGV4dC1tZW51LWNvbnRlbnQuY29tcG9uZW50JztcbmltcG9ydCB7IE9Db250ZXh0TWVudU92ZXJsYXlTZXJ2aWNlIH0gZnJvbSAnLi9vLWNvbnRleHQtbWVudS1vdmVybGF5LnNlcnZpY2UnO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgT0NvbnRleHRNZW51U2VydmljZSBpbXBsZW1lbnRzIE9uRGVzdHJveSB7XG5cbiAgcHVibGljIHNob3dDb250ZXh0TWVudTogU3ViamVjdDxJT0NvbnRleHRNZW51Q2xpY2tFdmVudD4gPSBuZXcgU3ViamVjdDxJT0NvbnRleHRNZW51Q2xpY2tFdmVudD4oKTtcbiAgcHVibGljIGNsb3NlQ29udGV4dE1lbnU6IFN1YmplY3Q8RXZlbnQ+ID0gbmV3IFN1YmplY3QoKTtcbiAgcHJvdGVjdGVkIGZha2VFbGVtZW50OiBFbGVtZW50UmVmID0gbmV3IEVsZW1lbnRSZWYoeyBuYXRpdmVFbGVtZW50OiAnJyB9KTtcbiAgcHJvdGVjdGVkIHN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uID0gbmV3IFN1YnNjcmlwdGlvbigpO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgb3ZlcmxheTogT3ZlcmxheSxcbiAgICBwcml2YXRlIHNjcm9sbFN0cmF0ZWd5OiBTY3JvbGxTdHJhdGVneU9wdGlvbnMsXG4gICAgcHJpdmF0ZSBjZDogQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgcHJpdmF0ZSBvdmVybGF5U2VydmljZTogT0NvbnRleHRNZW51T3ZlcmxheVNlcnZpY2UsXG4gICAgcHJpdmF0ZSByZW5kZXJlcjogUmVuZGVyZXIyXG4gICkgeyB9XG5cbiAgcHVibGljIG5nT25EZXN0cm95KCk6IHZvaWQge1xuICAgIHRoaXMuc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gIH1cblxuICBwdWJsaWMgb3BlbkNvbnRleHRNZW51KGNvbnRleHQ6IElPQ29udGV4dE1lbnVDb250ZXh0KTogdm9pZCB7XG4gICAgdGhpcy5kZXN0cm95T3ZlcmxheXMoKTtcbiAgICB0aGlzLmNyZWF0ZU92ZXJsYXkoY29udGV4dCk7XG4gIH1cblxuICBwcm90ZWN0ZWQgZGVzdHJveU92ZXJsYXlzKCk6IHZvaWQge1xuICAgIHRoaXMub3ZlcmxheVNlcnZpY2UuZGVzdHJveU92ZXJsYXlzKCk7XG4gIH1cblxuICAvLyBDcmVhdGUgb3ZlcmxheSBhbmQgYXR0YWNoIGBvLWNvbnRleHQtbWVudS1jb250ZW50YCB0byBpdCBpbiBvcmRlciB0byB0cmlnZ2VyIHRoZSBtZW51IGNsaWNrLCB0aGUgbWVudSBvcGVucyBpbiBhIG5ldyBvdmVybGF5XG4gIC8vIFRPRE86IHRyeSB0byB1c2Ugb25seSBvbmUgb3ZlcmxheVxuICBwcm90ZWN0ZWQgY3JlYXRlT3ZlcmxheShjb250ZXh0OiBJT0NvbnRleHRNZW51Q29udGV4dCk6IHZvaWQge1xuICAgIGNvbnRleHQuZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBjb250ZXh0LmV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgdGhpcy5mYWtlRWxlbWVudC5uYXRpdmVFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCA9ICgpOiBET01SZWN0ID0+ICh7XG4gICAgICBib3R0b206IGNvbnRleHQuZXZlbnQuY2xpZW50WSxcbiAgICAgIGhlaWdodDogMCxcbiAgICAgIGxlZnQ6IGNvbnRleHQuZXZlbnQuY2xpZW50WCxcbiAgICAgIHJpZ2h0OiBjb250ZXh0LmV2ZW50LmNsaWVudFgsXG4gICAgICB0b3A6IGNvbnRleHQuZXZlbnQuY2xpZW50WSxcbiAgICAgIHdpZHRoOiAwLFxuICAgICAgeDogMCxcbiAgICAgIHk6IDAsXG4gICAgICB0b0pTT046ICgpID0+IHsgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgcG9zaXRpb25TdHJhdGVneSA9IHRoaXMub3ZlcmxheS5wb3NpdGlvbigpXG4gICAgICAuZmxleGlibGVDb25uZWN0ZWRUbyhjb250ZXh0LmFuY2hvckVsZW1lbnQgfHwgdGhpcy5mYWtlRWxlbWVudClcbiAgICAgIC53aXRoUG9zaXRpb25zKFt7XG4gICAgICAgIG92ZXJsYXlYOiAnc3RhcnQnLFxuICAgICAgICBvdmVybGF5WTogJ3RvcCcsXG4gICAgICAgIG9yaWdpblg6ICdzdGFydCcsXG4gICAgICAgIG9yaWdpblk6ICdib3R0b20nXG4gICAgICB9XSk7XG5cbiAgICBjb25zdCBvdmVybGF5UmVmID0gdGhpcy5vdmVybGF5LmNyZWF0ZSh7XG4gICAgICBwb3NpdGlvblN0cmF0ZWd5OiBwb3NpdGlvblN0cmF0ZWd5LFxuICAgICAgaGFzQmFja2Ryb3A6IGZhbHNlLFxuICAgICAgcGFuZWxDbGFzczogWydvLWNvbnRleHQtbWVudSddLFxuICAgICAgc2Nyb2xsU3RyYXRlZ3k6IHRoaXMuc2Nyb2xsU3RyYXRlZ3kuY2xvc2UoKVxuICAgIH0pO1xuXG4gICAgdGhpcy5vdmVybGF5U2VydmljZS5hZGRPdmVybGF5KG92ZXJsYXlSZWYpO1xuXG4gICAgdGhpcy5hdHRhY2hDb250ZXh0TWVudShvdmVybGF5UmVmLCBjb250ZXh0KTtcblxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgLy8gV29ya2Fyb3VuZCB0byBkZWxldGUgZmlyc3QgbGV2ZWwgbWVudSB0cmlnZ2VyXG4gICAgICBvdmVybGF5UmVmLmhvc3RFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ292ZXJsYXktcmVmLWRpc3BsYXktbm9uZScpO1xuICAgICAgY29uc3QgbmV4dFNpYmxpbmcgPSBvdmVybGF5UmVmLmhvc3RFbGVtZW50Lm5leHRFbGVtZW50U2libGluZztcbiAgICAgIGlmIChuZXh0U2libGluZykge1xuICAgICAgICBjb25zdCB0b3AgPSBuZXh0U2libGluZy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3A7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUobmV4dFNpYmxpbmcsICd0b3AnLCBgJHt0b3AgLSAzMn1weGApO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcbiAgICB9KVxuICB9XG5cbiAgcHJvdGVjdGVkIGF0dGFjaENvbnRleHRNZW51KG92ZXJsYXk6IE92ZXJsYXlSZWYsIGNvbnRleHQ6IElPQ29udGV4dE1lbnVDb250ZXh0KTogdm9pZCB7XG4gICAgY29uc3QgY29udGV4dE1lbnVDb250ZW50OiBDb21wb25lbnRSZWY8T0NvbnRleHRNZW51Q29udGVudENvbXBvbmVudD4gPSBvdmVybGF5LmF0dGFjaChuZXcgQ29tcG9uZW50UG9ydGFsKE9Db250ZXh0TWVudUNvbnRlbnRDb21wb25lbnQpKTtcbiAgICBjb250ZXh0TWVudUNvbnRlbnQuaW5zdGFuY2Uub3ZlcmxheSA9IG92ZXJsYXk7XG4gICAgY29udGV4dE1lbnVDb250ZW50Lmluc3RhbmNlLm1lbnVJdGVtcyA9IGNvbnRleHQubWVudUl0ZW1zO1xuICAgIGNvbnRleHRNZW51Q29udGVudC5pbnN0YW5jZS5leHRlcm5hbE1lbnVJdGVtcyA9IGNvbnRleHQuZXh0ZXJuYWxNZW51SXRlbXM7XG4gICAgY29udGV4dE1lbnVDb250ZW50Lmluc3RhbmNlLmRhdGEgPSBjb250ZXh0LmRhdGE7XG4gICAgY29udGV4dE1lbnVDb250ZW50Lmluc3RhbmNlLm1lbnVDbGFzcyA9IGNvbnRleHQuY2xhc3M7XG4gICAgdGhpcy5zdWJzY3JpcHRpb24uYWRkKGNvbnRleHRNZW51Q29udGVudC5pbnN0YW5jZS5jbG9zZS5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgdGhpcy5jbG9zZUNvbnRleHRNZW51Lm5leHQoKTtcbiAgICAgIHRoaXMuZGVzdHJveU92ZXJsYXlzKCk7XG4gICAgfSkpO1xuICB9XG5cbn1cbiJdfQ==