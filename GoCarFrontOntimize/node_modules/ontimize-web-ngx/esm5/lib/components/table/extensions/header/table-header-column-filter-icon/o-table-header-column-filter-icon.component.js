import { animate, state, style, transition, trigger } from '@angular/animations';
import { ChangeDetectionStrategy, Component, forwardRef, Inject, ViewEncapsulation } from '@angular/core';
import { AnimationDurations } from '@angular/material';
import { BehaviorSubject, Subscription } from 'rxjs';
import { Util } from '../../../../../util/util';
import { OTableComponent } from '../../../o-table.component';
export var DEFAULT_INPUTS_O_TABLE_COLUMN_FILTER_ICON = [
    'column'
];
var OTableHeaderColumnFilterIconComponent = (function () {
    function OTableHeaderColumnFilterIconComponent(table) {
        var _this = this;
        this.table = table;
        this.isColumnFilterActive = new BehaviorSubject(false);
        this.filterIconHintVisible = new BehaviorSubject(false);
        this.indicatorNumber = new BehaviorSubject('');
        this.subscription = new Subscription();
        this.filterIconStateView = new BehaviorSubject('INACTIVE');
        this.subscription.add(this.table.onFilterByColumnChange.subscribe(function () {
            _this.updateStateColumnFilter();
        }));
        this.subscription.add(this.filterIconHintVisible.subscribe(function (value) {
            _this.setFilterIconHintVisible(value);
        }));
    }
    OTableHeaderColumnFilterIconComponent.prototype.ngOnInit = function () {
        this.updateStateColumnFilter();
    };
    OTableHeaderColumnFilterIconComponent.prototype.updateStateColumnFilter = function () {
        this.indicatorNumber.next(this.getFilterIndicatorNumbered());
        this.isColumnFilterActive.next(Util.isDefined(this.getColumnValueFilterByAttr()));
        this.filterIconStateView.next(this.isColumnFilterActive.getValue() ? 'ACTIVE' : 'INACTIVE');
    };
    OTableHeaderColumnFilterIconComponent.prototype.getColumnValueFilterByAttr = function () {
        var _this = this;
        var columnValueFilters = this.table.dataSource.getColumnValueFilters();
        return columnValueFilters.find(function (item) { return item.attr === _this.column.attr; });
    };
    OTableHeaderColumnFilterIconComponent.prototype.openColumnFilterDialog = function (event) {
        this.table.openColumnFilterDialog(this.column, event);
    };
    OTableHeaderColumnFilterIconComponent.prototype.getFilterIndicatorNumbered = function () {
        var _this = this;
        var result = '';
        var columnValueFilters = this.table.dataSource.getColumnValueFilters();
        if (columnValueFilters.length < 2) {
            return result;
        }
        var index = columnValueFilters.findIndex(function (x) { return x.attr === _this.column.attr; });
        if (index > -1) {
            result += index + 1;
        }
        return result;
    };
    OTableHeaderColumnFilterIconComponent.prototype.setFilterIconHintVisible = function (visible) {
        if (this.filterIconStateView.getValue() === 'ACTIVE') {
            return;
        }
        this.filterIconStateView.next(visible ? 'HINT' : 'INACTIVE');
    };
    OTableHeaderColumnFilterIconComponent.prototype.ngOnDestroy = function () {
        this.subscription.unsubscribe();
    };
    OTableHeaderColumnFilterIconComponent.decorators = [
        { type: Component, args: [{
                    selector: 'o-table-header-column-filter-icon',
                    inputs: DEFAULT_INPUTS_O_TABLE_COLUMN_FILTER_ICON,
                    template: "<mat-icon class=\"column-filter-icon\" [ngClass]=\"{'column-filter-icon-active':isColumnFilterActive | async}\"\n  (click)=\"openColumnFilterDialog($event)\" [@iconState]=\"filterIconStateView | async\">\n  filter_alt\n</mat-icon>\n<span class=\"o-table-header-indicator-numbered\">\n  {{ indicatorNumber | async }}\n</span>",
                    encapsulation: ViewEncapsulation.None,
                    changeDetection: ChangeDetectionStrategy.OnPush,
                    host: {
                        '[class.o-table-column-filter-icon]': 'true'
                    },
                    animations: [
                        trigger('iconState', [
                            state('ACTIVE, HINT', style({ opacity: 1 })),
                            state('INACTIVE', style({ opacity: 0 })),
                            transition('* <=> HINT', animate(AnimationDurations.ENTERING))
                        ]),
                    ],
                    styles: [".o-table .o-table-container .mat-table .mat-header-cell .o-table-column-filter-icon{display:flex;position:absolute;left:0}.o-table .o-table-container .mat-table .mat-header-cell .o-table-column-filter-icon .o-table-header-indicator-numbered{right:-5px;bottom:-8px}"]
                }] }
    ];
    OTableHeaderColumnFilterIconComponent.ctorParameters = function () { return [
        { type: OTableComponent, decorators: [{ type: Inject, args: [forwardRef(function () { return OTableComponent; }),] }] }
    ]; };
    return OTableHeaderColumnFilterIconComponent;
}());
export { OTableHeaderColumnFilterIconComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiby10YWJsZS1oZWFkZXItY29sdW1uLWZpbHRlci1pY29uLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL29udGltaXplLXdlYi1uZ3gvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy90YWJsZS9leHRlbnNpb25zL2hlYWRlci90YWJsZS1oZWFkZXItY29sdW1uLWZpbHRlci1pY29uL28tdGFibGUtaGVhZGVyLWNvbHVtbi1maWx0ZXItaWNvbi5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLFVBQVUsRUFBRSxPQUFPLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUNqRixPQUFPLEVBQUUsdUJBQXVCLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxNQUFNLEVBQXFCLGlCQUFpQixFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzdILE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ3ZELE9BQU8sRUFBRSxlQUFlLEVBQUUsWUFBWSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBR3JELE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUVoRCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFFN0QsTUFBTSxDQUFDLElBQU0seUNBQXlDLEdBQUc7SUFDdkQsUUFBUTtDQUNULENBQUE7QUFFRDtJQTZCRSwrQ0FDb0QsS0FBc0I7UUFEMUUsaUJBV0M7UUFWbUQsVUFBSyxHQUFMLEtBQUssQ0FBaUI7UUFSbkUseUJBQW9CLEdBQTZCLElBQUksZUFBZSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzVFLDBCQUFxQixHQUE2QixJQUFJLGVBQWUsQ0FBQyxLQUFLLENBQUMsQ0FBQTtRQUM1RSxvQkFBZSxHQUE0QixJQUFJLGVBQWUsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNsRSxpQkFBWSxHQUFHLElBQUksWUFB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QUFRLEVBQUUsbUNBQW1DO29CQUM3QyxNQUFNLEVBQUUseUNBQXlDO29CQUNqRCxnVkFBaUU7b0JBRWpFLGFBQWEsRUFBRSxpQkFBaUIsQ0FBQyxJQUFJO29CQUNyQyxlQUFlLEVBQUUsdUJBQXVCLENBQUMsTUFBTTtvQkFDL0MsSUFBSSxFQUFFO3dCQUNKLG9DQUFvQyxFQUFFLE1BQU07cUJBQzdDO29CQUNELFVBQVUsRUFBRTt3QkFDVixPQUFPLENBQUMsV0FBVyxFQUFFOzRCQUNuQixLQUFLLENBQUMsY0FBYyxFQUFFLEtBQUssQ0FBQyxFQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDOzRCQUM1QyxLQUFLLENBQUMsVUFBVSxFQUFFLEtBQUssQ0FBQyxFQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDOzRCQUN4QyxVQUFVLENBQUMsWUFBWSxFQUFFLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsQ0FBQzt5QkFDL0QsQ0FBQztxQkFFSDs7aUJBQ0Y7OztnQkF4QlEsZUFBZSx1QkFvQ25CLE1BQU0sU0FBQyxVQUFVLENBQUMsY0FBTSxPQUFBLGVBQWUsRUFBZixDQUFlLENBQUM7O0lBNkQ3Qyw0Q0FBQztDQUFBLEFBM0ZELElBMkZDO1NBeEVZLHFDQUFxQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGFuaW1hdGUsIHN0YXRlLCBzdHlsZSwgdHJhbnNpdGlvbiwgdHJpZ2dlciB9IGZyb20gJ0Bhbmd1bGFyL2FuaW1hdGlvbnMnO1xuaW1wb3J0IHsgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksIENvbXBvbmVudCwgZm9yd2FyZFJlZiwgSW5qZWN0LCBPbkRlc3Ryb3ksIE9uSW5pdCwgVmlld0VuY2Fwc3VsYXRpb24gfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEFuaW1hdGlvbkR1cmF0aW9ucyB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsJztcbmltcG9ydCB7IEJlaGF2aW9yU3ViamVjdCwgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XG5cbmltcG9ydCB7IE9Db2x1bW5WYWx1ZUZpbHRlciB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL3R5cGVzL3RhYmxlL28tY29sdW1uLXZhbHVlLWZpbHRlci50eXBlJztcbmltcG9ydCB7IFV0aWwgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi91dGlsL3V0aWwnO1xuaW1wb3J0IHsgT0NvbHVtbiB9IGZyb20gJy4uLy4uLy4uL2NvbHVtbic7XG5pbXBvcnQgeyBPVGFibGVDb21wb25lbnQgfSBmcm9tICcuLi8uLi8uLi9vLXRhYmxlLmNvbXBvbmVudCc7XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX0lOUFVUU19PX1RBQkxFX0NPTFVNTl9GSUxURVJfSUNPTiA9IFtcbiAgJ2NvbHVtbidcbl1cbmV4cG9ydCBkZWNsYXJlIHR5cGUgU1RBVEVWSUVXID0gJ0hJTlQnIHwgJ0FDVElWRScgfCAnSU5BQ1RJVkUnXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdvLXRhYmxlLWhlYWRlci1jb2x1bW4tZmlsdGVyLWljb24nLFxuICBpbnB1dHM6IERFRkFVTFRfSU5QVVRTX09fVEFCTEVfQ09MVU1OX0ZJTFRFUl9JQ09OLFxuICB0ZW1wbGF0ZVVybDogJy4vby10YWJsZS1oZWFkZXItY29sdW1uLWZpbHRlci1pY29uLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vby10YWJsZS1oZWFkZXItY29sdW1uLWZpbHRlci1pY29uLmNvbXBvbmVudC5zY3NzJ10sXG4gIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxuICBob3N0OiB7XG4gICAgJ1tjbGFzcy5vLXRhYmxlLWNvbHVtbi1maWx0ZXItaWNvbl0nOiAndHJ1ZSdcbiAgfSxcbiAgYW5pbWF0aW9uczogW1xuICAgIHRyaWdnZXIoJ2ljb25TdGF0ZScsIFtcbiAgICAgIHN0YXRlKCdBQ1RJVkUsIEhJTlQnLCBzdHlsZSh7IG9wYWNpdHk6IDEgfSkpLFxuICAgICAgc3RhdGUoJ0lOQUNUSVZFJywgc3R5bGUoeyBvcGFjaXR5OiAwIH0pKSxcbiAgICAgIHRyYW5zaXRpb24oJyogPD0+IEhJTlQnLCBhbmltYXRlKEFuaW1hdGlvbkR1cmF0aW9ucy5FTlRFUklORykpXG4gICAgXSksXG5cbiAgXVxufSlcbmV4cG9ydCBjbGFzcyBPVGFibGVIZWFkZXJDb2x1bW5GaWx0ZXJJY29uQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3kge1xuXG4gIHB1YmxpYyBjb2x1bW46IE9Db2x1bW47XG4gIHB1YmxpYyBpc0NvbHVtbkZpbHRlckFjdGl2ZTogQmVoYXZpb3JTdWJqZWN0PGJvb2xlYW4+ID0gbmV3IEJlaGF2aW9yU3ViamVjdChmYWxzZSk7XG4gIHB1YmxpYyBmaWx0ZXJJY29uSGludFZpc2libGU6IEJlaGF2aW9yU3ViamVjdDxib29sZWFuPiA9IG5ldyBCZWhhdmlvclN1YmplY3QoZmFsc2UpXG4gIHB1YmxpYyBpbmRpY2F0b3JOdW1iZXI6IEJlaGF2aW9yU3ViamVjdDxzdHJpbmc+ID0gbmV3IEJlaGF2aW9yU3ViamVjdCgnJyk7XG4gIHByaXZhdGUgc3Vic2NyaXB0aW9uID0gbmV3IFN1YnNjcmlwdGlvbigpO1xuICBwdWJsaWMgZmlsdGVySWNvblN0YXRlVmlldzogQmVoYXZpb3JTdWJqZWN0PFNUQVRFVklFVz4gPSBuZXcgQmVoYXZpb3JTdWJqZWN0PFNUQVRFVklFVz4oJ0lOQUNUSVZFJyk7XG5cblxuICBjb25zdHJ1Y3RvcihcbiAgICBASW5qZWN0KGZvcndhcmRSZWYoKCkgPT4gT1RhYmxlQ29tcG9uZW50KSkgcHVibGljIHRhYmxlOiBPVGFibGVDb21wb25lbnRcbiAgKSB7XG4gICAgdGhpcy5zdWJzY3JpcHRpb24uYWRkKHRoaXMudGFibGUub25GaWx0ZXJCeUNvbHVtbkNoYW5nZS5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgdGhpcy51cGRhdGVTdGF0ZUNvbHVtbkZpbHRlcigpO1xuICAgIH0pKTtcblxuICAgIHRoaXMuc3Vic2NyaXB0aW9uLmFkZCh0aGlzLmZpbHRlckljb25IaW50VmlzaWJsZS5zdWJzY3JpYmUoKHZhbHVlKSA9PiB7XG5cbiAgICAgIHRoaXMuc2V0RmlsdGVySWNvbkhpbnRWaXNpYmxlKHZhbHVlKTtcbiAgICB9KSk7XG4gIH1cblxuICBuZ09uSW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLnVwZGF0ZVN0YXRlQ29sdW1uRmlsdGVyKCk7XG4gIH1cblxuICBwdWJsaWMgdXBkYXRlU3RhdGVDb2x1bW5GaWx0ZXIoKSB7XG4gICAgdGhpcy5pbmRpY2F0b3JOdW1iZXIubmV4dCh0aGlzLmdldEZpbHRlckluZGljYXRvck51bWJlcmVkKCkpO1xuXG4gICAgdGhpcy5pc0NvbHVtbkZpbHRlckFjdGl2ZS5uZXh0KFV0aWwuaXNEZWZpbmVkKHRoaXMuZ2V0Q29sdW1uVmFsdWVGaWx0ZXJCeUF0dHIoKSkpO1xuICAgIHRoaXMuZmlsdGVySWNvblN0YXRlVmlldy5uZXh0KHRoaXMuaXNDb2x1bW5GaWx0ZXJBY3RpdmUuZ2V0VmFsdWUoKSA/ICdBQ1RJVkUnIDogJ0lOQUNUSVZFJyk7XG4gIH1cblxuICBwcm90ZWN0ZWQgZ2V0Q29sdW1uVmFsdWVGaWx0ZXJCeUF0dHIoKTogT0NvbHVtblZhbHVlRmlsdGVyIHtcbiAgICBjb25zdCBjb2x1bW5WYWx1ZUZpbHRlcnMgPSB0aGlzLnRhYmxlLmRhdGFTb3VyY2UuZ2V0Q29sdW1uVmFsdWVGaWx0ZXJzKCk7XG4gICAgcmV0dXJuIGNvbHVtblZhbHVlRmlsdGVycy5maW5kKGl0ZW0gPT4gaXRlbS5hdHRyID09PSB0aGlzLmNvbHVtbi5hdHRyKTtcbiAgfVxuXG4gIHB1YmxpYyBvcGVuQ29sdW1uRmlsdGVyRGlhbG9nKGV2ZW50KSB7XG4gICAgdGhpcy50YWJsZS5vcGVuQ29sdW1uRmlsdGVyRGlhbG9nKHRoaXMuY29sdW1uLCBldmVudCk7XG4gIH1cblxuICBwdWJsaWMgZ2V0RmlsdGVySW5kaWNhdG9yTnVtYmVyZWQoKTogc3RyaW5nIHtcbiAgICBsZXQgcmVzdWx0ID0gJyc7XG5cbiAgICBjb25zdCBjb2x1bW5WYWx1ZUZpbHRlcnMgPSB0aGlzLnRhYmxlLmRhdGFTb3VyY2UuZ2V0Q29sdW1uVmFsdWVGaWx0ZXJzKCk7XG4gICAgaWYgKGNvbHVtblZhbHVlRmlsdGVycy5sZW5ndGggPCAyKSB7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIGNvbnN0IGluZGV4ID0gY29sdW1uVmFsdWVGaWx0ZXJzLmZpbmRJbmRleCh4ID0+IHguYXR0ciA9PT0gdGhpcy5jb2x1bW4uYXR0cik7XG4gICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgIHJlc3VsdCArPSBpbmRleCArIDE7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSBcImhpbnRcIiBzdGF0ZSBzdWNoIHRoYXQgdGhlIGljb24gd2lsbCBiZSBzZW1pLXRyYW5zcGFyZW50bHkgZGlzcGxheWVkIGFzIGEgaGludCB0byB0aGVcbiAgICogdXNlciBzaG93aW5nIHdoYXQgdGhlIGFjdGl2ZSBmaWx0ZXIgYnkgY29sdW1uIHdpbGwgYmVjb21lLiBJZiBzZXQgdG8gZmFsc2UsIHRoZSBpY29uIHdpbGwgZmFkZSBhd2F5LlxuICAgKi9cbiAgc2V0RmlsdGVySWNvbkhpbnRWaXNpYmxlKHZpc2libGU6IGJvb2xlYW4pIHtcbiAgICAvLyBOby1vcCBpZiB0aGUgc29ydCBoZWFkZXIgaXMgQUNUSVZFIC0gc2hvdWxkIG5vdCBtYWtlIHRoZSBoaW50IHZpc2libGUuXG4gICAgaWYgKHRoaXMuZmlsdGVySWNvblN0YXRlVmlldy5nZXRWYWx1ZSgpID09PSAnQUNUSVZFJykgeyByZXR1cm47IH1cbiAgICB0aGlzLmZpbHRlckljb25TdGF0ZVZpZXcubmV4dCh2aXNpYmxlID8gJ0hJTlQnIDogJ0lOQUNUSVZFJyk7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcbiAgICB0aGlzLnN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICB9XG59XG4iXX0=