import { DefaultServiceComponentStateClass } from './o-component-state.class';
import { Util } from '../../util';
export class OTableComponentStateClass extends DefaultServiceComponentStateClass {
    constructor() {
        super(...arguments);
        this['grouped-column-types'] = [];
    }
    get filterBuilderValues() {
        return this['filter-builder-values'];
    }
    set filterBuilderValues(value) {
        this['filter-builder-values'] = value;
    }
    get selectColumnVisible() {
        return this['select-column-visible'];
    }
    set selectColumnVisible(value) {
        this['select-column-visible'] = value;
    }
    get quickFilterValue() {
        return this['filter'];
    }
    set quickFilterValue(value) {
        this['filter'] = value;
    }
    get columnsDisplay() {
        return this['oColumns-display'];
    }
    set columnsDisplay(value) {
        this['oColumns-display'] = value;
    }
    getColumnDisplay(oCol) {
        return (this.columnsDisplay || []).find(col => col.attr === oCol.attr);
    }
    get initialConfiguration() {
        return this['initial-configuration'];
    }
    set initialConfiguration(value) {
        this['initial-configuration'] = value;
    }
    get sortColumns() {
        return this['sort-columns'];
    }
    set sortColumns(value) {
        this['sort-columns'] = value;
    }
    get groupedColumnTypes() {
        return this['grouped-column-types'];
    }
    set groupedColumnTypes(value) {
        this['grouped-column-types'] = value;
    }
    get filterColumns() {
        return this['filter-columns'];
    }
    set filterColumns(value) {
        this['filter-columns'] = value;
    }
    get filterColumnActiveByDefault() {
        return this['filter-column-active-by-default'];
    }
    get groupedColumns() {
        return this['grouped-columns'];
    }
    set groupedColumns(value) {
        this['grouped-columns'] = value;
    }
    get columnValueFilters() {
        return this['column-value-filters'] || [];
    }
    set columnValueFilters(value) {
        this['column-value-filters'] = value;
    }
    get storedFilters() {
        return this['user-stored-filters'] || [];
    }
    addStoredFilter(filter) {
        if (!Util.isDefined(this['user-stored-filters'])) {
            this['user-stored-filters'] = [];
        }
        this.storedFilters.push(filter);
    }
    deleteStoredFilter(filterName) {
        const index = this.storedFilters.findIndex((item) => item.name === filterName);
        if (index >= 0) {
            this.storedFilters.splice(index, 1);
        }
    }
    getStoredFilter(filterName) {
        let result;
        const filter = this.storedFilters.find((item) => item.name === filterName);
        if (filter) {
            result = filter['stored-filter'];
        }
        return result;
    }
    applyFilter(filterName) {
        const filter = this.getStoredFilter(filterName);
        if (filter) {
            this.columnValueFilters = filter['column-value-filters'];
            this.quickFilterValue = filter['filter'];
            this.filterCaseSensitive = filter['filter-case-sensitive'];
            this.filterBuilderValues = filter['filter-builder-values'];
            this.oColumns = filter['oColumns'];
        }
    }
    get storedConfigurations() {
        return this['user-stored-configurations'] || [];
    }
    addStoredConfiguration(configuration) {
        if (!Util.isDefined(this['user-stored-configurations'])) {
            this['user-stored-configurations'] = [];
        }
        this.storedConfigurations.push(configuration);
    }
    deleteStoredConfiguration(configurationName) {
        const index = this.storedConfigurations.findIndex((item) => item.name === configurationName);
        if (index >= 0) {
            this.storedConfigurations.splice(index, 1);
        }
    }
    getStoredConfiguration(configurationName) {
        return this.storedConfigurations.find((item) => item.name === configurationName);
    }
    applyConfiguration(configurationName) {
        const configuration = this.getStoredConfiguration(configurationName);
        if (configuration) {
            const properties = configuration['stored-properties'] || [];
            const conf = configuration['stored-configuration'];
            this.copyPropertiesFromConfiguration(properties, conf);
        }
    }
    reset(pageable) {
        const result = {
            'user-stored-filters': this.storedFilters,
            'user-stored-configurations': this.storedConfigurations
        };
        if (pageable) {
            result['totalQueryRecordsNumber'] = this.totalQueryRecordsNumber;
        }
        result['currentPage'] = 0;
        Object.assign(this, {});
        Object.assign(this, result);
    }
    copyPropertiesFromConfiguration(properties, configuration) {
        properties.forEach(property => {
            switch (property) {
                case 'sort-columns':
                    this.sortColumns = configuration['sort-columns'];
                    break;
                case 'oColumns-display':
                    this.columnsDisplay = configuration['oColumns-display'];
                    this.selectColumnVisible = configuration['select-column-visible'];
                    break;
                case 'quick-filter':
                case 'columns-filter':
                    this.columnValueFilters = configuration['column-value-filters'];
                    break;
                case 'grouped-columns':
                    this.groupedColumns = configuration['grouped-columns'];
                    break;
                case 'page':
                    this.currentPage = configuration['currentPage'];
                    this.totalQueryRecordsNumber = configuration['totalQueryRecordsNumber'];
                    this.queryRecordOffset = configuration['queryRecordOffset'];
                    this.queryRows = configuration['query-rows'];
                    break;
                case 'filter-builder':
                    this.filterBuilderValues = configuration['filter-builder'];
                    break;
            }
        });
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiby10YWJsZS1jb21wb25lbnQtc3RhdGUuY2xhc3MuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9vbnRpbWl6ZS13ZWItbmd4LyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2VzL3N0YXRlL28tdGFibGUtY29tcG9uZW50LXN0YXRlLmNsYXNzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQU9BLE9BQU8sRUFBRSxpQ0FBaUMsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBSTlFLE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFHbEMsTUFBTSxPQUFPLHlCQUEwQixTQUFRLGlDQUFpQztJQUFoRjs7UUE4QlksNEJBQXNCLEdBQTBCLEVBQUUsQ0FBQztJQXNNL0QsQ0FBQztJQXBNQyxJQUFXLG1CQUFtQjtRQUM1QixPQUFPLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO0lBQ3ZDLENBQUM7SUFDRCxJQUFXLG1CQUFtQixDQUFDLEtBQTZCO1FBQzFELElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxHQUFHLEtBQUssQ0FBQztJQUN4QyxDQUFDO0lBRUQsSUFBSSxtQkFBbUI7UUFDckIsT0FBTyxJQUFJLENBQUMsdUJBQXVCLENBQUMsQ0FBQztJQUN2QyxDQUFDO0lBRUQsSUFBSSxtQkFBbUIsQ0FBQyxLQUFjO1FBQ3BDLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxHQUFHLEtBQUssQ0FBQztJQUN4QyxDQUFDO0lBRUQsSUFBSSxnQkFBZ0I7UUFDbEIsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDeEIsQ0FBQztJQUVELElBQUksZ0JBQWdCLENBQUMsS0FBYTtRQUNoQyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsS0FBSyxDQUFDO0lBQ3pCLENBQUM7SUFFRCxJQUFJLGNBQWM7UUFDaEIsT0FBTyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQztJQUNsQyxDQUFDO0lBRUQsSUFBSSxjQUFjLENBQUMsS0FBdUI7UUFDeEMsSUFBSSxDQUFDLGtCQUFr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bW4gfSBmcm9tICcuLi8uLi9jb21wb25lbnRzL3RhYmxlL2NvbHVtbi9vLWNvbHVtbi5jbGFzcyc7XG5pbXBvcnQge1xuICBPRmlsdGVyQ29sdW1uXG59IGZyb20gJy4uLy4uL2NvbXBvbmVudHMvdGFibGUvZXh0ZW5zaW9ucy9oZWFkZXIvdGFibGUtY29sdW1ucy1maWx0ZXIvY29sdW1ucy9vLXRhYmxlLWNvbHVtbnMtZmlsdGVyLWNvbHVtbi5jb21wb25lbnQnO1xuaW1wb3J0IHsgT0NvbHVtbkRpc3BsYXkgfSBmcm9tICcuLi8uLi90eXBlcy90YWJsZS9vLWNvbHVtbi1kaXNwbGF5LnR5cGUnO1xuaW1wb3J0IHsgT0NvbHVtblNlYXJjaGFibGUgfSBmcm9tICcuLi8uLi90eXBlcy90YWJsZS9vLWNvbHVtbi1zZWFyY2hhYmxlLnR5cGUnO1xuaW1wb3J0IHsgT0NvbHVtblZhbHVlRmlsdGVyIH0gZnJvbSAnLi4vLi4vdHlwZXMvdGFibGUvby1jb2x1bW4tdmFsdWUtZmlsdGVyLnR5cGUnO1xuaW1wb3J0IHsgRGVmYXVsdFNlcnZpY2VDb21wb25lbnRTdGF0ZUNsYXNzIH0gZnJvbSAnLi9vLWNvbXBvbmVudC1zdGF0ZS5jbGFzcyc7XG5pbXBvcnQgeyBPVGFibGVDb25maWd1cmF0aW9uIH0gZnJvbSAnLi4vLi4vdHlwZXMvdGFibGUvby10YWJsZS1jb25maWd1cmF0aW9uLnR5cGUnO1xuaW1wb3J0IHsgT1RhYmxlRmlsdGVyc1N0YXR1cywgT1RhYmxlU3RvcmVkRmlsdGVyIH0gZnJvbSAnLi4vLi4vdHlwZXMvdGFibGUvby10YWJsZS1maWx0ZXItc3RhdHVzLnR5cGUnO1xuaW1wb3J0IHsgT0ZpbHRlckJ1aWxkZXJWYWx1ZXMgfSBmcm9tICcuLi8uLi90eXBlcy9vLWZpbHRlci1idWlsZGVyLXZhbHVlcy50eXBlJztcbmltcG9ydCB7IFV0aWwgfSBmcm9tICcuLi8uLi91dGlsJztcbmltcG9ydCB7IE9Hcm91cGVkQ29sdW1uVHlwZXMgfSBmcm9tICcuLi8uLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBPVGFibGVDb21wb25lbnRTdGF0ZUNsYXNzIGV4dGVuZHMgRGVmYXVsdFNlcnZpY2VDb21wb25lbnRTdGF0ZUNsYXNzIHtcbiAgLy8gc29ydFxuICBwcm90ZWN0ZWQgJ3NvcnQtY29sdW1ucyc6IHN0cmluZztcbiAgLy8gY29sdW1ucy1kaXNwbGF5XG4gIHByb3RlY3RlZCAnb0NvbHVtbnMtZGlzcGxheSc6IE9Db2x1bW5EaXNwbGF5W107XG4gIHByb3RlY3RlZCAnc2VsZWN0LWNvbHVtbi12aXNpYmxlJzogYm9vbGVhbjtcbiAgLy8gcXVpY2stZmlsdGVyXG4gIHByb3RlY3RlZCAnZmlsdGVyJzogc3RyaW5nO1xuICBwcm90ZWN0ZWQgJ29Db2x1bW5zJzogT0NvbHVtblNlYXJjaGFibGVbXTtcbiAgLy8gY29sdW1ucy1maWx0ZXJcbiAgcHJvdGVjdGVkICdjb2x1bW4tdmFsdWUtZmlsdGVycyc6IE9Db2x1bW5WYWx1ZUZpbHRlcltdO1xuICAvLyBwYWdlXG4gICdjdXJyZW50UGFnZSc6IG51bWJlcjtcbiAgLy8gc2VsZWN0aW9uXG4gICdzZWxlY3Rpb24nOiBhbnlbXTtcbiAgLy8gaW5pdGlhbC1jb25maWd1cmF0aW9uXG4gIHByb3RlY3RlZCAnaW5pdGlhbC1jb25maWd1cmF0aW9uJzogT1RhYmxlQ29tcG9uZW50U3RhdGVDbGFzcztcbiAgLy8gZmlsdGVyLWNvbHVtbi1hY3RpdmVcbiAgcHJvdGVjdGVkICdmaWx0ZXItY29sdW1uLWFjdGl2ZSc6IGJvb2xlYW47XG4gIC8vIGZpbHRlci1jb2x1bW5zXG4gIHByb3RlY3RlZCAnZmlsdGVyLWNvbHVtbnMnOiBPRmlsdGVyQ29sdW1uW107XG4gIHByb3RlY3RlZCAnZmlsdGVyLWNvbHVtbi1hY3RpdmUtYnktZGVmYXVsdCc6IGJvb2xlYW47XG4gIC8vIGdyb3VwZWQtY29sdW1uc1xuICBwcm90ZWN0ZWQgJ2dyb3VwZWQtY29sdW1ucyc6IHN0cmluZ1tdO1xuICAvLyBzdG9yZWQgZmlsdGVycyBhbmQgY29uZmlndXJhdGlvbnNcbiAgcHJvdGVjdGVkICd1c2VyLXN0b3JlZC1maWx0ZXJzJzogT1RhYmxlRmlsdGVyc1N0YXR1c1tdO1xuICBwcm90ZWN0ZWQgJ3VzZXItc3RvcmVkLWNvbmZpZ3VyYXRpb25zJzogT1RhYmxlQ29uZmlndXJhdGlvbltdO1xuICAvLyBzdG9yZWQgZmlsdGVycyBidWlsZGVyIHZhbHVlc1xuICBwcm90ZWN0ZWQgJ2ZpbHRlci1idWlsZGVyLXZhbHVlcyc6IE9GaWx0ZXJCdWlsZGVyVmFsdWVzW107XG5cbiAgcHJvdGVjdGVkICdncm91cGVkLWNvbHVtbi10eXBlcyc6IE9Hcm91cGVkQ29sdW1uVHlwZXNbXSA9IFtdO1xuXG4gIHB1YmxpYyBnZXQgZmlsdGVyQnVpbGRlclZhbHVlcygpOiBPRmlsdGVyQnVpbGRlclZhbHVlc1tdIHtcbiAgICByZXR1cm4gdGhpc1snZmlsdGVyLWJ1aWxkZXItdmFsdWVzJ107XG4gIH1cbiAgcHVibGljIHNldCBmaWx0ZXJCdWlsZGVyVmFsdWVzKHZhbHVlOiBPRmlsdGVyQnVpbGRlclZhbHVlc1tdKSB7XG4gICAgdGhpc1snZmlsdGVyLWJ1aWxkZXItdmFsdWVzJ10gPSB2YWx1ZTtcbiAgfVxuXG4gIGdldCBzZWxlY3RDb2x1bW5WaXNpYmxlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzWydzZWxlY3QtY29sdW1uLXZpc2libGUnXTtcbiAgfVxuXG4gIHNldCBzZWxlY3RDb2x1bW5WaXNpYmxlKHZhbHVlOiBib29sZWFuKSB7XG4gICAgdGhpc1snc2VsZWN0LWNvbHVtbi12aXNpYmxlJ10gPSB2YWx1ZTtcbiAgfVxuXG4gIGdldCBxdWlja0ZpbHRlclZhbHVlKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXNbJ2ZpbHRlciddO1xuICB9XG5cbiAgc2V0IHF1aWNrRmlsdGVyVmFsdWUodmFsdWU6IHN0cmluZykge1xuICAgIHRoaXNbJ2ZpbHRlciddID0gdmFsdWU7XG4gIH1cblxuICBnZXQgY29sdW1uc0Rpc3BsYXkoKTogT0NvbHVtbkRpc3BsYXlbXSB7XG4gICAgcmV0dXJuIHRoaXNbJ29Db2x1bW5zLWRpc3BsYXknXTtcbiAgfVxuXG4gIHNldCBjb2x1bW5zRGlzcGxheSh2YWx1ZTogT0NvbHVtbkRpc3BsYXlbXSkge1xuICAgIHRoaXNbJ29Db2x1bW5zLWRpc3BsYXknXSA9IHZhbHVlO1xuICB9XG5cbiAgZ2V0Q29sdW1uRGlzcGxheShvQ29sOiBPQ29sdW1uKTogT0NvbHVtbkRpc3BsYXkge1xuICAgIHJldHVybiAodGhpcy5jb2x1bW5zRGlzcGxheSB8fCBbXSkuZmluZChjb2wgPT4gY29sLmF0dHIgPT09IG9Db2wuYXR0cik7XG4gIH1cblxuICBnZXQgaW5pdGlhbENvbmZpZ3VyYXRpb24oKTogT1RhYmxlQ29tcG9uZW50U3RhdGVDbGFzcyB7XG4gICAgcmV0dXJuIHRoaXNbJ2luaXRpYWwtY29uZmlndXJhdGlvbiddO1xuICB9XG5cbiAgc2V0IGluaXRpYWxDb25maWd1cmF0aW9uKHZhbHVlOiBPVGFibGVDb21wb25lbnRTdGF0ZUNsYXNzKSB7XG4gICAgdGhpc1snaW5pdGlhbC1jb25maWd1cmF0aW9uJ10gPSB2YWx1ZTtcbiAgfVxuXG4gIGdldCBzb3J0Q29sdW1ucygpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzWydzb3J0LWNvbHVtbnMnXTtcbiAgfVxuXG4gIHNldCBzb3J0Q29sdW1ucyh2YWx1ZTogc3RyaW5nKSB7XG4gICAgdGhpc1snc29ydC1jb2x1bW5zJ10gPSB2YWx1ZTtcbiAgfVxuICBnZXQgZ3JvdXBlZENvbHVtblR5cGVzKCk6IE9Hcm91cGVkQ29sdW1uVHlwZXNbXSB7XG4gICAgcmV0dXJuIHRoaXNbJ2dyb3VwZWQtY29sdW1uLXR5cGVzJ107XG4gIH1cbiAgc2V0IGdyb3VwZWRDb2x1bW5UeXBlcyh2YWx1ZTogT0dyb3VwZWRDb2x1bW5UeXBlc1tdKSB7XG4gICAgdGhpc1snZ3JvdXBlZC1jb2x1bW4tdHlwZXMnXSA9IHZhbHVlO1xuICB9XG4gIGdldCBmaWx0ZXJDb2x1bW5zKCk6IE9GaWx0ZXJDb2x1bW5bXSB7XG4gICAgcmV0dXJuIHRoaXNbJ2ZpbHRlci1jb2x1bW5zJ107XG4gIH1cblxuICBzZXQgZmlsdGVyQ29sdW1ucyh2YWx1ZTogT0ZpbHRlckNvbHVtbltdKSB7XG4gICAgdGhpc1snZmlsdGVyLWNvbHVtbnMnXSA9IHZhbHVlO1xuICB9XG5cbiAgZ2V0IGZpbHRlckNvbHVtbkFjdGl2ZUJ5RGVmYXVsdCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpc1snZmlsdGVyLWNvbHVtbi1hY3RpdmUtYnktZGVmYXVsdCddO1xuICB9XG5cbiAgZ2V0IGdyb3VwZWRDb2x1bW5zKCk6IHN0cmluZ1tdIHtcbiAgICByZXR1cm4gdGhpc1snZ3JvdXBlZC1jb2x1bW5zJ107XG4gIH1cblxuICBzZXQgZ3JvdXBlZENvbHVtbnModmFsdWU6IHN0cmluZ1tdKSB7XG4gICAgdGhpc1snZ3JvdXBlZC1jb2x1bW5zJ10gPSB2YWx1ZTtcbiAgfVxuXG4gIGdldCBjb2x1bW5WYWx1ZUZpbHRlcnMoKTogT0NvbHVtblZhbHVlRmlsdGVyW10ge1xuICAgIHJldHVybiB0aGlzWydjb2x1bW4tdmFsdWUtZmlsdGVycyddIHx8IFtdO1xuICB9XG5cbiAgc2V0IGNvbHVtblZhbHVlRmlsdGVycyh2YWx1ZTogT0NvbHVtblZhbHVlRmlsdGVyW10pIHtcbiAgICB0aGlzWydjb2x1bW4tdmFsdWUtZmlsdGVycyddID0gdmFsdWU7XG4gIH1cblxuICBnZXQgc3RvcmVkRmlsdGVycygpOiBPVGFibGVGaWx0ZXJzU3RhdHVzW10ge1xuICAgIHJldHVybiB0aGlzWyd1c2VyLXN0b3JlZC1maWx0ZXJzJ10gfHwgW107XG4gIH1cblxuICBhZGRTdG9yZWRGaWx0ZXIoZmlsdGVyOiBPVGFibGVGaWx0ZXJzU3RhdHVzKSB7XG4gICAgaWYgKCFVdGlsLmlzRGVmaW5lZCh0aGlzWyd1c2VyLXN0b3JlZC1maWx0ZXJzJ10pKSB7XG4gICAgICB0aGlzWyd1c2VyLXN0b3JlZC1maWx0ZXJzJ10gPSBbXTtcbiAgICB9XG4gICAgdGhpcy5zdG9yZWRGaWx0ZXJzLnB1c2goZmlsdGVyKTtcbiAgfVxuXG4gIGRlbGV0ZVN0b3JlZEZpbHRlcihmaWx0ZXJOYW1lOiBzdHJpbmcpIHtcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuc3RvcmVkRmlsdGVycy5maW5kSW5kZXgoKGl0ZW06IE9UYWJsZUZpbHRlcnNTdGF0dXMpID0+IGl0ZW0ubmFtZSA9PT0gZmlsdGVyTmFtZSk7XG4gICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgIHRoaXMuc3RvcmVkRmlsdGVycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH1cbiAgfVxuXG4gIGdldFN0b3JlZEZpbHRlcihmaWx0ZXJOYW1lOiBzdHJpbmcpOiBPVGFibGVTdG9yZWRGaWx0ZXIge1xuICAgIGxldCByZXN1bHQ6IE9UYWJsZVN0b3JlZEZpbHRlcjtcbiAgICBjb25zdCBmaWx0ZXIgPSB0aGlzLnN0b3JlZEZpbHRlcnMuZmluZCgoaXRlbTogT1RhYmxlRmlsdGVyc1N0YXR1cykgPT4gaXRlbS5uYW1lID09PSBmaWx0ZXJOYW1lKTtcbiAgICBpZiAoZmlsdGVyKSB7XG4gICAgICByZXN1bHQgPSBmaWx0ZXJbJ3N0b3JlZC1maWx0ZXInXTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIGFwcGx5RmlsdGVyKGZpbHRlck5hbWU6IHN0cmluZykge1xuICAgIGNvbnN0IGZpbHRlciA9IHRoaXMuZ2V0U3RvcmVkRmlsdGVyKGZpbHRlck5hbWUpO1xuICAgIGlmIChmaWx0ZXIpIHtcbiAgICAgIHRoaXMuY29sdW1uVmFsdWVGaWx0ZXJzID0gZmlsdGVyWydjb2x1bW4tdmFsdWUtZmlsdGVycyddO1xuICAgICAgdGhpcy5xdWlja0ZpbHRlclZhbHVlID0gZmlsdGVyWydmaWx0ZXInXTtcbiAgICAgIHRoaXMuZmlsdGVyQ2FzZVNlbnNpdGl2ZSA9IGZpbHRlclsnZmlsdGVyLWNhc2Utc2Vuc2l0aXZlJ107XG4gICAgICB0aGlzLmZpbHRlckJ1aWxkZXJWYWx1ZXMgPSBmaWx0ZXJbJ2ZpbHRlci1idWlsZGVyLXZhbHVlcyddO1xuICAgICAgdGhpcy5vQ29sdW1ucyA9IGZpbHRlclsnb0NvbHVtbnMnXTtcbiAgICB9XG4gIH1cblxuICBnZXQgc3RvcmVkQ29uZmlndXJhdGlvbnMoKTogT1RhYmxlQ29uZmlndXJhdGlvbltdIHtcbiAgICByZXR1cm4gdGhpc1sndXNlci1zdG9yZWQtY29uZmlndXJhdGlvbnMnXSB8fCBbXTtcbiAgfVxuXG4gIGFkZFN0b3JlZENvbmZpZ3VyYXRpb24oY29uZmlndXJhdGlvbjogT1RhYmxlQ29uZmlndXJhdGlvbikge1xuICAgIGlmICghVXRpbC5pc0RlZmluZWQodGhpc1sndXNlci1zdG9yZWQtY29uZmlndXJhdGlvbnMnXSkpIHtcbiAgICAgIHRoaXNbJ3VzZXItc3RvcmVkLWNvbmZpZ3VyYXRpb25zJ10gPSBbXTtcbiAgICB9XG4gICAgdGhpcy5zdG9yZWRDb25maWd1cmF0aW9ucy5wdXNoKGNvbmZpZ3VyYXRpb24pO1xuICB9XG5cbiAgZGVsZXRlU3RvcmVkQ29uZmlndXJhdGlvbihjb25maWd1cmF0aW9uTmFtZTogc3RyaW5nKSB7XG4gICAgY29uc3QgaW5kZXggPSB0aGlzLnN0b3JlZENvbmZpZ3VyYXRpb25zLmZpbmRJbmRleCgoaXRlbTogT1RhYmxlQ29uZmlndXJhdGlvbikgPT4gaXRlbS5uYW1lID09PSBjb25maWd1cmF0aW9uTmFtZSk7XG4gICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgIHRoaXMuc3RvcmVkQ29uZmlndXJhdGlvbnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9XG4gIH1cblxuICBnZXRTdG9yZWRDb25maWd1cmF0aW9uKGNvbmZpZ3VyYXRpb25OYW1lOiBzdHJpbmcpOiBPVGFibGVDb25maWd1cmF0aW9uIHtcbiAgICByZXR1cm4gdGhpcy5zdG9yZWRDb25maWd1cmF0aW9ucy5maW5kKChpdGVtOiBPVGFibGVDb25maWd1cmF0aW9uKSA9PiBpdGVtLm5hbWUgPT09IGNvbmZpZ3VyYXRpb25OYW1lKTtcbiAgfVxuXG4gIGFwcGx5Q29uZmlndXJhdGlvbihjb25maWd1cmF0aW9uTmFtZTogc3RyaW5nKSB7XG4gICAgY29uc3QgY29uZmlndXJhdGlvbiA9IHRoaXMuZ2V0U3RvcmVkQ29uZmlndXJhdGlvbihjb25maWd1cmF0aW9uTmFtZSk7XG4gICAgaWYgKGNvbmZpZ3VyYXRpb24pIHtcbiAgICAgIGNvbnN0IHByb3BlcnRpZXMgPSBjb25maWd1cmF0aW9uWydzdG9yZWQtcHJvcGVydGllcyddIHx8IFtdO1xuICAgICAgY29uc3QgY29uZjogT1RhYmxlQ29tcG9uZW50U3RhdGVDbGFzcyA9IGNvbmZpZ3VyYXRpb25bJ3N0b3JlZC1jb25maWd1cmF0aW9uJ107XG4gICAgICB0aGlzLmNvcHlQcm9wZXJ0aWVzRnJvbUNvbmZpZ3VyYXRpb24ocHJvcGVydGllcywgY29uZik7XG4gICAgfVxuICB9XG5cbiAgcmVzZXQocGFnZWFibGU6IGJvb2xlYW4pIHtcbiAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAndXNlci1zdG9yZWQtZmlsdGVycyc6IHRoaXMuc3RvcmVkRmlsdGVycyxcbiAgICAgICd1c2VyLXN0b3JlZC1jb25maWd1cmF0aW9ucyc6IHRoaXMuc3RvcmVkQ29uZmlndXJhdGlvbnNcbiAgICB9O1xuICAgIGlmIChwYWdlYWJsZSkge1xuICAgICAgcmVzdWx0Wyd0b3RhbFF1ZXJ5UmVjb3Jkc051bWJlciddID0gdGhpcy50b3RhbFF1ZXJ5UmVjb3Jkc051bWJlcjtcbiAgICB9XG4gICAgcmVzdWx0WydjdXJyZW50UGFnZSddID0gMDtcblxuICAgIE9iamVjdC5hc3NpZ24odGhpcywge30pO1xuICAgIE9iamVjdC5hc3NpZ24odGhpcywgcmVzdWx0KTtcbiAgfVxuXG4gIHByb3RlY3RlZCBjb3B5UHJvcGVydGllc0Zyb21Db25maWd1cmF0aW9uKHByb3BlcnRpZXM6IHN0cmluZ1tdLCBjb25maWd1cmF0aW9uOiBPVGFibGVDb21wb25lbnRTdGF0ZUNsYXNzKSB7XG4gICAgcHJvcGVydGllcy5mb3JFYWNoKHByb3BlcnR5ID0+IHtcbiAgICAgIHN3aXRjaCAocHJvcGVydHkpIHtcbiAgICAgICAgY2FzZSAnc29ydC1jb2x1bW5zJzpcbiAgICAgICAgICB0aGlzLnNvcnRDb2x1bW5zID0gY29uZmlndXJhdGlvblsnc29ydC1jb2x1bW5zJ107XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ29Db2x1bW5zLWRpc3BsYXknOlxuICAgICAgICAgIHRoaXMuY29sdW1uc0Rpc3BsYXkgPSBjb25maWd1cmF0aW9uWydvQ29sdW1ucy1kaXNwbGF5J107XG4gICAgICAgICAgdGhpcy5zZWxlY3RDb2x1bW5WaXNpYmxlID0gY29uZmlndXJhdGlvblsnc2VsZWN0LWNvbHVtbi12aXNpYmxlJ107XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3F1aWNrLWZpbHRlcic6XG4gICAgICAgIGNhc2UgJ2NvbHVtbnMtZmlsdGVyJzpcbiAgICAgICAgICB0aGlzLmNvbHVtblZhbHVlRmlsdGVycyA9IGNvbmZpZ3VyYXRpb25bJ2NvbHVtbi12YWx1ZS1maWx0ZXJzJ107XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2dyb3VwZWQtY29sdW1ucyc6XG4gICAgICAgICAgdGhpcy5ncm91cGVkQ29sdW1ucyA9IGNvbmZpZ3VyYXRpb25bJ2dyb3VwZWQtY29sdW1ucyddO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdwYWdlJzpcbiAgICAgICAgICB0aGlzLmN1cnJlbnRQYWdlID0gY29uZmlndXJhdGlvblsnY3VycmVudFBhZ2UnXTtcbiAgICAgICAgICB0aGlzLnRvdGFsUXVlcnlSZWNvcmRzTnVtYmVyID0gY29uZmlndXJhdGlvblsndG90YWxRdWVyeVJlY29yZHNOdW1iZXInXTtcbiAgICAgICAgICB0aGlzLnF1ZXJ5UmVjb3JkT2Zmc2V0ID0gY29uZmlndXJhdGlvblsncXVlcnlSZWNvcmRPZmZzZXQnXTtcbiAgICAgICAgICB0aGlzLnF1ZXJ5Um93cyA9IGNvbmZpZ3VyYXRpb25bJ3F1ZXJ5LXJvd3MnXTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZmlsdGVyLWJ1aWxkZXInOlxuICAgICAgICAgIHRoaXMuZmlsdGVyQnVpbGRlclZhbHVlcyA9IGNvbmZpZ3VyYXRpb25bJ2ZpbHRlci1idWlsZGVyJ107XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiJdfQ==