/**
 * @fileoverview added by tsickle
 * Generated from: lib/components/report/o-report-new/o-report-new.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ViewChild, ViewEncapsulation } from '@angular/core';
import { DialogService, OFileInputComponent, OFormComponent, OTextInputComponent } from 'ontimize-web-ngx';
import { OAlertService } from '../../../services/o-alert.service';
var OReportNewComponent = /** @class */ (function () {
    function OReportNewComponent(alertService, dialogService) {
        this.alertService = alertService;
        this.dialogService = dialogService;
        this.loading = false;
    }
    /**
     * @return {?}
     */
    OReportNewComponent.prototype.getFileData = /**
     * @return {?}
     */
    function () {
        return {
            'name': this.name.getValue(),
            'type': this.type.getValue(),
            'description': this.description.getValue(),
        };
    };
    /**
     * @return {?}
     */
    OReportNewComponent.prototype.onUploadFile = /**
     * @return {?}
     */
    function () {
        this.loading = false;
        this.confirm();
        this.form._clearAndCloseFormAfterInsert();
    };
    /**
     * @return {?}
     */
    OReportNewComponent.prototype.onError = /**
     * @return {?}
     */
    function () {
        if (this.dialogService) {
            this.dialogService.error('ERROR', 'SERVER_ERROR_MESSAGE');
            this.loading = false;
        }
    };
    /**
     * @return {?}
     */
    OReportNewComponent.prototype.confirm = /**
     * @return {?}
     */
    function () {
        this.alertService.announceAlert('alert');
    };
    /**
     * @param {?} e
     * @return {?}
     */
    OReportNewComponent.prototype.onClickSave = /**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        var _this = this;
        Object.keys(this.form.formGroup.controls).forEach((/**
         * @param {?} control
         * @return {?}
         */
        function (control) {
            _this.form.formGroup.controls[control].markAsTouched();
        }));
        if (!this.form.formGroup.valid) {
            this.dialogService.alert('ERROR', 'MESSAGES.FORM_VALIDATION_ERROR');
            return;
        }
        this.loading = true;
        this.file.onClickUpload(e);
    };
    OReportNewComponent.decorators = [
        { type: Component, args: [{
                    selector: 'o-report-new',
                    template: "<o-form #form service-type=\"report\" entity=\"addReport\" keys=\"UUID\" header-actions=\"R;I;U;D\" show-header-navigation=\"no\">\n  <div o-form-toolbar-buttons>\n    <button type=\"button\" class=\"o-form-toolbar-button\" mat-stroked-button (click)=\"onClickSave($event)\" attr=\"fillreport\">\n      <mat-icon>save</mat-icon>\n      <span>{{ 'SAVE'| oReportsTranslate}}</span>\n    </button>\n  </div>\n  <o-column attr=\"row1\" title=\"REPORT_DATA\" icon=\"description\" layout-gap=\"14px\" fxFill>\n    <div fxLayout=\"row wrap\" fxLayoutGap=\"14px\" fxLayoutAlign=\"start start\" fxFlex>\n      <o-text-input #name class=\"input-padding\" attr=\"NAME\" label=\"REPORT_NAME\" fxFlex=\"50\" required=\"yes\"></o-text-input>\n      <o-text-input #type class=\"input-padding\" attr=\"REPORT_TYPE\" label=\"REPORT_TYPE\" fxFlex required=\"yes\"></o-text-input>\n    </div>\n    <o-textarea-input #description attr=\"DESCRIPTION\" label=\"REPORT_DESCRIPTION\" fxFlex required=\"yes\"></o-textarea-input>\n    <o-file-input #file attr=\"file\" fxFlex=\"50\" service=\"report\" service-type=\"report\" entity=\"addReport\" label=\"REPORT_ZIPFOLDER\" show-info=\"yes\"\n      workspace-key=\"id\" required=\"yes\" (onUploadFile)=\"onUploadFile()\" accept-file-type=\".zip\" [additional-data]=\"getFileData()\"\n      (onErrorFile)=\"onError()\">\n    </o-file-input>\n  </o-column>\n</o-form>\n<div class=\"loading\" *ngIf=\"loading\">\n  <div class=\"spinner\">\n    <mat-spinner mode=\"indeterminate\"></mat-spinner>\n  </div>\n</div>\n",
                    encapsulation: ViewEncapsulation.None,
                    host: {
                        '[class.app-report-store-new]': 'true'
                    },
                    styles: [".o-form-toolbar-button.o-form-toolbar-button-insert{display:none}.loading{position:fixed;top:0;left:0;right:0;bottom:0;width:100%;height:100%;background-color:#fff;opacity:.5;z-index:1000}.spinner{position:absolute;top:50%;left:50%;margin-top:-20px;margin-left:-25px;width:50px;height:40px;text-align:center;font-size:10px;opacity:1}"]
                }] }
    ];
    /** @nocollapse */
    OReportNewComponent.ctorParameters = function () { return [
        { type: OAlertService },
        { type: DialogService }
    ]; };
    OReportNewComponent.propDecorators = {
        name: [{ type: ViewChild, args: ['name', { static: true },] }],
        type: [{ type: ViewChild, args: ['type', { static: true },] }],
        description: [{ type: ViewChild, args: ['description', { static: true },] }],
        form: [{ type: ViewChild, args: ['form', { static: true },] }],
        file: [{ type: ViewChild, args: ['file', { static: true },] }]
    };
    return OReportNewComponent;
}());
export { OReportNewComponent };
if (false) {
    /** @type {?} */
    OReportNewComponent.prototype.name;
    /** @type {?} */
    OReportNewComponent.prototype.type;
    /** @type {?} */
    OReportNewComponent.prototype.description;
    /** @type {?} */
    OReportNewComponent.prototype.form;
    /** @type {?} */
    OReportNewComponent.prototype.file;
    /** @type {?} */
    OReportNewComponent.prototype.subscription;
    /** @type {?} */
    OReportNewComponent.prototype.loading;
    /**
     * @type {?}
     * @private
     */
    OReportNewComponent.prototype.alertService;
    /**
     * @type {?}
     * @private
     */
    OReportNewComponent.prototype.dialogService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiby1yZXBvcnQtbmV3LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL29udGltaXplLXdlYi1uZ3gtcmVwb3J0LyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvcmVwb3J0L28tcmVwb3J0LW5ldy9vLXJlcG9ydC1uZXcuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDeEUsT0FBTyxFQUFFLGFBQWEsRUFBRSxtQkFBbUIsRUFBRSxjQUFjLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUUzRyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUNBQW1DLENBQUM7QUFFbEU7SUF5QkUsNkJBQ1UsWUFBMkIsRUFDM0IsYUFBNEI7UUFENUIsaUJBQVksR0FBWixZQUFZLENBQWU7UUFDM0Isa0JBQWEsR0FBYixhQUFhLENBQWU7UUFKdEMsWUFBTyxHQUFZLEtBQUssQ0FBQztJQUtyQixDQUFDOzs7O0lBRUwseUNBQVc7OztJQUFYO1FBQ0UsT0FBTztZQUNMLE1BQU0sRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRTtZQUM1QixNQUFNLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUU7WUFDNUIsYUFBYSxFQUFFLElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxFQUFFO1NBQzNDLENBQUM7SUFDSixDQUFDOzs7O0lBRUQsMENBQVk7OztJQUFaO1FBQ0UsSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7UUFDckIsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQ2YsSUFBSSxDQUFDLElBQUksQ0FBQyw2QkFBNkIsRUFBRSxDQUFDO0lBQzVDLENBQUM7Ozs7SUFFRCxxQ0FBTzs7O0lBQVA7UUFDRSxJQUFJLElBQUksQ0FBQyxhQUFhLEVBQUU7WUFDdEIsSUFBSSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUM5QixzQkFBc0IsQ0FBQyxDQUFDO1lBQzFCLElBQUksQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDO1NBQ3RCO0lBQ0gsQ0FBQzs7OztJQUVELHFDQUFPOzs7SUFBUDtRQUNFLElBQUksQ0FBQyxZQUFZLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQzNDLENBQUM7Ozs7O0lBRUQseUNBQVc7Ozs7SUFBWCxVQUFZLENBQVE7UUFBcEIsaUJBV0M7UUFWQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxDQUFDLE9BQU87Ozs7UUFBQyxVQUFDLE9BQU87WUFDeEQsS0FBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQ3hELENBQUMsRUFBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssRUFBRTtZQUM5QixJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUUsZ0NBQWdDLENBQUMsQ0FBQztZQUNwRSxPQUFPO1NBQ1I7UUFDRCxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQztRQUNwQixJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM3QixDQUFDOztnQkFuRUYsU0FBUyxTQUFDO29CQUNULFFBQVEsRUFBRSxjQUFjO29CQUN4QiwyZ0RBQTRDO29CQUU1QyxhQUFhLEVBQUUsaUJBQWlCLENBQUMsSUFBSTtvQkFDckMsSUFBSSxFQUFFO3dCQUNKLDhCQUE4QixFQUFFLE1BQU07cUJBQ3ZDOztpQkFDRjs7OztnQkFWUSxhQUFhO2dCQUZiLGFBQWE7Ozt1QkFlbkIsU0FBUyxTQUFDLE1BQU0sRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7dUJBRWxDLFNBQVMsU0FBQyxNQUFNLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFOzhCQUVsQyxTQUFTLFNBQUMsYUFBYSxFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTt1QkFFekMsU0FBUyxTQUFDLE1BQU0sRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7dUJBRWxDLFNBQVMsU0FBQyxNQUFNLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFOztJQWtEckMsMEJBQUM7Q0FBQSxBQXJFRCxJQXFFQztTQTVEWSxtQkFBbUI7OztJQUU5QixtQ0FDMEI7O0lBQzFCLG1DQUMwQjs7SUFDMUIsMENBQ2lDOztJQUNqQyxtQ0FDcUI7O0lBQ3JCLG1DQUMwQjs7SUFFMUIsMkNBQTJCOztJQUMzQixzQ0FBeUI7Ozs7O0lBR3ZCLDJDQUFtQzs7Ozs7SUFDbkMsNENBQW9DIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBWaWV3Q2hpbGQsIFZpZXdFbmNhcHN1bGF0aW9uIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBEaWFsb2dTZXJ2aWNlLCBPRmlsZUlucHV0Q29tcG9uZW50LCBPRm9ybUNvbXBvbmVudCwgT1RleHRJbnB1dENvbXBvbmVudCB9IGZyb20gJ29udGltaXplLXdlYi1uZ3gnO1xuaW1wb3J0IHsgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBPQWxlcnRTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vc2VydmljZXMvby1hbGVydC5zZXJ2aWNlJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnby1yZXBvcnQtbmV3JyxcbiAgdGVtcGxhdGVVcmw6ICcuL28tcmVwb3J0LW5ldy5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL28tcmVwb3J0LW5ldy5jb21wb25lbnQuc2NzcyddLFxuICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxuICBob3N0OiB7XG4gICAgJ1tjbGFzcy5hcHAtcmVwb3J0LXN0b3JlLW5ld10nOiAndHJ1ZSdcbiAgfVxufSlcbmV4cG9ydCBjbGFzcyBPUmVwb3J0TmV3Q29tcG9uZW50IHtcblxuICBAVmlld0NoaWxkKCduYW1lJywgeyBzdGF0aWM6IHRydWUgfSlcbiAgbmFtZTogT1RleHRJbnB1dENvbXBvbmVudDtcbiAgQFZpZXdDaGlsZCgndHlwZScsIHsgc3RhdGljOiB0cnVlIH0pXG4gIHR5cGU6IE9UZXh0SW5wdXRDb21wb25lbnQ7XG4gIEBWaWV3Q2hpbGQoJ2Rlc2NyaXB0aW9uJywgeyBzdGF0aWM6IHRydWUgfSlcbiAgZGVzY3JpcHRpb246IE9UZXh0SW5wdXRDb21wb25lbnQ7XG4gIEBWaWV3Q2hpbGQoJ2Zvcm0nLCB7IHN0YXRpYzogdHJ1ZSB9KVxuICBmb3JtOiBPRm9ybUNvbXBvbmVudDtcbiAgQFZpZXdDaGlsZCgnZmlsZScsIHsgc3RhdGljOiB0cnVlIH0pXG4gIGZpbGU6IE9GaWxlSW5wdXRDb21wb25lbnQ7XG5cbiAgc3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XG4gIGxvYWRpbmc6IGJvb2xlYW4gPSBmYWxzZTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGFsZXJ0U2VydmljZTogT0FsZXJ0U2VydmljZSxcbiAgICBwcml2YXRlIGRpYWxvZ1NlcnZpY2U6IERpYWxvZ1NlcnZpY2VcbiAgKSB7IH1cblxuICBnZXRGaWxlRGF0YSgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgJ25hbWUnOiB0aGlzLm5hbWUuZ2V0VmFsdWUoKSxcbiAgICAgICd0eXBlJzogdGhpcy50eXBlLmdldFZhbHVlKCksXG4gICAgICAnZGVzY3JpcHRpb24nOiB0aGlzLmRlc2NyaXB0aW9uLmdldFZhbHVlKCksXG4gICAgfTtcbiAgfVxuXG4gIG9uVXBsb2FkRmlsZSgpIHtcbiAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcbiAgICB0aGlzLmNvbmZpcm0oKTtcbiAgICB0aGlzLmZvcm0uX2NsZWFyQW5kQ2xvc2VGb3JtQWZ0ZXJJbnNlcnQoKTtcbiAgfVxuXG4gIG9uRXJyb3IoKSB7XG4gICAgaWYgKHRoaXMuZGlhbG9nU2VydmljZSkge1xuICAgICAgdGhpcy5kaWFsb2dTZXJ2aWNlLmVycm9yKCdFUlJPUicsXG4gICAgICAgICdTRVJWRVJfRVJST1JfTUVTU0FHRScpO1xuICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgY29uZmlybSgpIHtcbiAgICB0aGlzLmFsZXJ0U2VydmljZS5hbm5vdW5jZUFsZXJ0KCdhbGVydCcpO1xuICB9XG5cbiAgb25DbGlja1NhdmUoZTogRXZlbnQpIHtcbiAgICBPYmplY3Qua2V5cyh0aGlzLmZvcm0uZm9ybUdyb3VwLmNvbnRyb2xzKS5mb3JFYWNoKChjb250cm9sKSA9PiB7XG4gICAgICB0aGlzLmZvcm0uZm9ybUdyb3VwLmNvbnRyb2xzW2NvbnRyb2xdLm1hcmtBc1RvdWNoZWQoKTtcbiAgICB9KTtcblxuICAgIGlmICghdGhpcy5mb3JtLmZvcm1Hcm91cC52YWxpZCkge1xuICAgICAgdGhpcy5kaWFsb2dTZXJ2aWNlLmFsZXJ0KCdFUlJPUicsICdNRVNTQUdFUy5GT1JNX1ZBTElEQVRJT05fRVJST1InKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTtcbiAgICB0aGlzLmZpbGUub25DbGlja1VwbG9hZChlKTtcbiAgfVxuXG59XG4iXX0=