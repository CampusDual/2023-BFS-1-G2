/**
 * @fileoverview added by tsickle
 * Generated from: lib/components/report/o-report-new/o-report-new.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ViewChild, ViewEncapsulation } from '@angular/core';
import { DialogService, OFileInputComponent, OFormComponent, OTextInputComponent } from 'ontimize-web-ngx';
import { OAlertService } from '../../../services/o-alert.service';
export class OReportNewComponent {
    /**
     * @param {?} alertService
     * @param {?} dialogService
     */
    constructor(alertService, dialogService) {
        this.alertService = alertService;
        this.dialogService = dialogService;
        this.loading = false;
    }
    /**
     * @return {?}
     */
    getFileData() {
        return {
            'name': this.name.getValue(),
            'type': this.type.getValue(),
            'description': this.description.getValue(),
        };
    }
    /**
     * @return {?}
     */
    onUploadFile() {
        this.loading = false;
        this.confirm();
        this.form._clearAndCloseFormAfterInsert();
    }
    /**
     * @return {?}
     */
    onError() {
        if (this.dialogService) {
            this.dialogService.error('ERROR', 'SERVER_ERROR_MESSAGE');
            this.loading = false;
        }
    }
    /**
     * @return {?}
     */
    confirm() {
        this.alertService.announceAlert('alert');
    }
    /**
     * @param {?} e
     * @return {?}
     */
    onClickSave(e) {
        Object.keys(this.form.formGroup.controls).forEach((/**
         * @param {?} control
         * @return {?}
         */
        (control) => {
            this.form.formGroup.controls[control].markAsTouched();
        }));
        if (!this.form.formGroup.valid) {
            this.dialogService.alert('ERROR', 'MESSAGES.FORM_VALIDATION_ERROR');
            return;
        }
        this.loading = true;
        this.file.onClickUpload(e);
    }
}
OReportNewComponent.decorators = [
    { type: Component, args: [{
                selector: 'o-report-new',
                template: "<o-form #form service-type=\"report\" entity=\"addReport\" keys=\"UUID\" header-actions=\"R;I;U;D\" show-header-navigation=\"no\">\n  <div o-form-toolbar-buttons>\n    <button type=\"button\" class=\"o-form-toolbar-button\" mat-stroked-button (click)=\"onClickSave($event)\" attr=\"fillreport\">\n      <mat-icon>save</mat-icon>\n      <span>{{ 'SAVE'| oReportsTranslate}}</span>\n    </button>\n  </div>\n  <o-column attr=\"row1\" title=\"REPORT_DATA\" icon=\"description\" layout-gap=\"14px\" fxFill>\n    <div fxLayout=\"row wrap\" fxLayoutGap=\"14px\" fxLayoutAlign=\"start start\" fxFlex>\n      <o-text-input #name class=\"input-padding\" attr=\"NAME\" label=\"REPORT_NAME\" fxFlex=\"50\" required=\"yes\"></o-text-input>\n      <o-text-input #type class=\"input-padding\" attr=\"REPORT_TYPE\" label=\"REPORT_TYPE\" fxFlex required=\"yes\"></o-text-input>\n    </div>\n    <o-textarea-input #description attr=\"DESCRIPTION\" label=\"REPORT_DESCRIPTION\" fxFlex required=\"yes\"></o-textarea-input>\n    <o-file-input #file attr=\"file\" fxFlex=\"50\" service=\"report\" service-type=\"report\" entity=\"addReport\" label=\"REPORT_ZIPFOLDER\" show-info=\"yes\"\n      workspace-key=\"id\" required=\"yes\" (onUploadFile)=\"onUploadFile()\" accept-file-type=\".zip\" [additional-data]=\"getFileData()\"\n      (onErrorFile)=\"onError()\">\n    </o-file-input>\n  </o-column>\n</o-form>\n<div class=\"loading\" *ngIf=\"loading\">\n  <div class=\"spinner\">\n    <mat-spinner mode=\"indeterminate\"></mat-spinner>\n  </div>\n</div>\n",
                encapsulation: ViewEncapsulation.None,
                host: {
                    '[class.app-report-store-new]': 'true'
                },
                styles: [".o-form-toolbar-button.o-form-toolbar-button-insert{display:none}.loading{position:fixed;top:0;left:0;right:0;bottom:0;width:100%;height:100%;background-color:#fff;opacity:.5;z-index:1000}.spinner{position:absolute;top:50%;left:50%;margin-top:-20px;margin-left:-25px;width:50px;height:40px;text-align:center;font-size:10px;opacity:1}"]
            }] }
];
/** @nocollapse */
OReportNewComponent.ctorParameters = () => [
    { type: OAlertService },
    { type: DialogService }
];
OReportNewComponent.propDecorators = {
    name: [{ type: ViewChild, args: ['name', { static: true },] }],
    type: [{ type: ViewChild, args: ['type', { static: true },] }],
    description: [{ type: ViewChild, args: ['description', { static: true },] }],
    form: [{ type: ViewChild, args: ['form', { static: true },] }],
    file: [{ type: ViewChild, args: ['file', { static: true },] }]
};
if (false) {
    /** @type {?} */
    OReportNewComponent.prototype.name;
    /** @type {?} */
    OReportNewComponent.prototype.type;
    /** @type {?} */
    OReportNewComponent.prototype.description;
    /** @type {?} */
    OReportNewComponent.prototype.form;
    /** @type {?} */
    OReportNewComponent.prototype.file;
    /** @type {?} */
    OReportNewComponent.prototype.subscription;
    /** @type {?} */
    OReportNewComponent.prototype.loading;
    /**
     * @type {?}
     * @private
     */
    OReportNewComponent.prototype.alertService;
    /**
     * @type {?}
     * @private
     */
    OReportNewComponent.prototype.dialogService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiby1yZXBvcnQtbmV3LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL29udGltaXplLXdlYi1uZ3gtcmVwb3J0LyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvcmVwb3J0L28tcmVwb3J0LW5ldy9vLXJlcG9ydC1uZXcuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDeEUsT0FBTyxFQUFFLGFBQWEsRUFBRSxtQkFBbUIsRUFBRSxjQUFjLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUUzRyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUNBQW1DLENBQUM7QUFXbEUsTUFBTSxPQUFPLG1CQUFtQjs7Ozs7SUFnQjlCLFlBQ1UsWUFBMkIsRUFDM0IsYUFBNEI7UUFENUIsaUJBQVksR0FBWixZQUFZLENBQWU7UUFDM0Isa0JBQWEsR0FBYixhQUFhLENBQWU7UUFKdEMsWUFBTyxHQUFZLEtBQUssQ0FBQztJQUtyQixDQUFDOzs7O0lBRUwsV0FBVztRQUNULE9BQU87WUFDTCxNQUFNLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUU7WUFDNUIsTUFBTSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFO1lBQzVCLGFBQWEsRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsRUFBRTtTQUMzQyxDQUFDO0lBQ0osQ0FBQzs7OztJQUVELFlBQVk7UUFDVixJQUFJLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQztRQUNyQixJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDZixJQUFJLENBQUMsSUFBSSxDQUFDLDZCQUE2QixFQUFFLENBQUM7SUFDNUMsQ0FBQzs7OztJQUVELE9BQU87UUFDTCxJQUFJLElBQUksQ0FBQyxhQUFhLEVBQUU7WUFDdEIsSUFBSSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUM5QixzQkFBc0IsQ0FBQyxDQUFDO1lBQzFCLElBQUksQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDO1NBQ3RCO0lBQ0gsQ0FBQzs7OztJQUVELE9BQU87UUFDTCxJQUFJLENBQUMsWUFBWSxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUMzQyxDQUFDOzs7OztJQUVELFdBQVcsQ0FBQyxDQUFRO1FBQ2xCLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLENBQUMsT0FBTzs7OztRQUFDLENBQUMsT0FBTyxFQUFFLEVBQUU7WUFDNUQsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQ3hELENBQUMsRUFBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssRUFBRTtZQUM5QixJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUUsZ0NBQWdDLENBQUMsQ0FBQztZQUNwRSxPQUFPO1NBQ1I7UUFDRCxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQztRQUNwQixJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM3QixDQUFDOzs7WUFuRUYsU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSxjQUFjO2dCQUN4QiwyZ0RBQTRDO2dCQUU1QyxhQUFhLEVBQUUsaUJBQWlCLENBQUMsSUFBSTtnQkFDckMsSUFBSSxFQUFFO29CQUNKLDhCQUE4QixFQUFFLE1BQU07aUJBQ3ZDOzthQUNGOzs7O1lBVlEsYUFBYTtZQUZiLGFBQWE7OzttQkFlbkIsU0FBUyxTQUFDLE1BQU0sRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7bUJBRWxDLFNBQVMsU0FBQyxNQUFNLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFOzBCQUVsQyxTQUFTLFNBQUMsYUFBYSxFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTttQkFFekMsU0FBUyxTQUFDLE1BQU0sRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7bUJBRWxDLFNBQVMsU0FBQyxNQUFNLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFOzs7O0lBUm5DLG1DQUMwQjs7SUFDMUIsbUNBQzBCOztJQUMxQiwwQ0FDaUM7O0lBQ2pDLG1DQUNxQjs7SUFDckIsbUNBQzBCOztJQUUxQiwyQ0FBMkI7O0lBQzNCLHNDQUF5Qjs7Ozs7SUFHdkIsMkNBQW1DOzs7OztJQUNuQyw0Q0FBb0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIFZpZXdDaGlsZCwgVmlld0VuY2Fwc3VsYXRpb24gfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IERpYWxvZ1NlcnZpY2UsIE9GaWxlSW5wdXRDb21wb25lbnQsIE9Gb3JtQ29tcG9uZW50LCBPVGV4dElucHV0Q29tcG9uZW50IH0gZnJvbSAnb250aW1pemUtd2ViLW5neCc7XG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IE9BbGVydFNlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi9zZXJ2aWNlcy9vLWFsZXJ0LnNlcnZpY2UnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdvLXJlcG9ydC1uZXcnLFxuICB0ZW1wbGF0ZVVybDogJy4vby1yZXBvcnQtbmV3LmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vby1yZXBvcnQtbmV3LmNvbXBvbmVudC5zY3NzJ10sXG4gIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXG4gIGhvc3Q6IHtcbiAgICAnW2NsYXNzLmFwcC1yZXBvcnQtc3RvcmUtbmV3XSc6ICd0cnVlJ1xuICB9XG59KVxuZXhwb3J0IGNsYXNzIE9SZXBvcnROZXdDb21wb25lbnQge1xuXG4gIEBWaWV3Q2hpbGQoJ25hbWUnLCB7IHN0YXRpYzogdHJ1ZSB9KVxuICBuYW1lOiBPVGV4dElucHV0Q29tcG9uZW50O1xuICBAVmlld0NoaWxkKCd0eXBlJywgeyBzdGF0aWM6IHRydWUgfSlcbiAgdHlwZTogT1RleHRJbnB1dENvbXBvbmVudDtcbiAgQFZpZXdDaGlsZCgnZGVzY3JpcHRpb24nLCB7IHN0YXRpYzogdHJ1ZSB9KVxuICBkZXNjcmlwdGlvbjogT1RleHRJbnB1dENvbXBvbmVudDtcbiAgQFZpZXdDaGlsZCgnZm9ybScsIHsgc3RhdGljOiB0cnVlIH0pXG4gIGZvcm06IE9Gb3JtQ29tcG9uZW50O1xuICBAVmlld0NoaWxkKCdmaWxlJywgeyBzdGF0aWM6IHRydWUgfSlcbiAgZmlsZTogT0ZpbGVJbnB1dENvbXBvbmVudDtcblxuICBzdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcbiAgbG9hZGluZzogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgYWxlcnRTZXJ2aWNlOiBPQWxlcnRTZXJ2aWNlLFxuICAgIHByaXZhdGUgZGlhbG9nU2VydmljZTogRGlhbG9nU2VydmljZVxuICApIHsgfVxuXG4gIGdldEZpbGVEYXRhKCkge1xuICAgIHJldHVybiB7XG4gICAgICAnbmFtZSc6IHRoaXMubmFtZS5nZXRWYWx1ZSgpLFxuICAgICAgJ3R5cGUnOiB0aGlzLnR5cGUuZ2V0VmFsdWUoKSxcbiAgICAgICdkZXNjcmlwdGlvbic6IHRoaXMuZGVzY3JpcHRpb24uZ2V0VmFsdWUoKSxcbiAgICB9O1xuICB9XG5cbiAgb25VcGxvYWRGaWxlKCkge1xuICAgIHRoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgIHRoaXMuY29uZmlybSgpO1xuICAgIHRoaXMuZm9ybS5fY2xlYXJBbmRDbG9zZUZvcm1BZnRlckluc2VydCgpO1xuICB9XG5cbiAgb25FcnJvcigpIHtcbiAgICBpZiAodGhpcy5kaWFsb2dTZXJ2aWNlKSB7XG4gICAgICB0aGlzLmRpYWxvZ1NlcnZpY2UuZXJyb3IoJ0VSUk9SJyxcbiAgICAgICAgJ1NFUlZFUl9FUlJPUl9NRVNTQUdFJyk7XG4gICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBjb25maXJtKCkge1xuICAgIHRoaXMuYWxlcnRTZXJ2aWNlLmFubm91bmNlQWxlcnQoJ2FsZXJ0Jyk7XG4gIH1cblxuICBvbkNsaWNrU2F2ZShlOiBFdmVudCkge1xuICAgIE9iamVjdC5rZXlzKHRoaXMuZm9ybS5mb3JtR3JvdXAuY29udHJvbHMpLmZvckVhY2goKGNvbnRyb2wpID0+IHtcbiAgICAgIHRoaXMuZm9ybS5mb3JtR3JvdXAuY29udHJvbHNbY29udHJvbF0ubWFya0FzVG91Y2hlZCgpO1xuICAgIH0pO1xuXG4gICAgaWYgKCF0aGlzLmZvcm0uZm9ybUdyb3VwLnZhbGlkKSB7XG4gICAgICB0aGlzLmRpYWxvZ1NlcnZpY2UuYWxlcnQoJ0VSUk9SJywgJ01FU1NBR0VTLkZPUk1fVkFMSURBVElPTl9FUlJPUicpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmxvYWRpbmcgPSB0cnVlO1xuICAgIHRoaXMuZmlsZS5vbkNsaWNrVXBsb2FkKGUpO1xuICB9XG5cbn1cbiJdfQ==