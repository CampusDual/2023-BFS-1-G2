/**
 * @fileoverview added by tsickle
 * Generated from: lib/components/report-on-demand/report-on-demand/report-on-demand.component.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { moveItemInArray } from '@angular/cdk/drag-drop';
import { Injector, ViewChild, ViewEncapsulation } from '@angular/core';
import { Component, Inject } from '@angular/core';
import { MatSelectionList } from '@angular/material';
import { MatDialog, MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';
import { AppConfig, DialogService, OTableComponent, OTranslateService, SnackBarService, Util } from 'ontimize-web-ngx';
import { OReportService } from '../../../services/o-report.service';
import { DefaultOReportPreferences } from '../../../types/report-preferences.type';
import { Utils } from '../../../util/utils';
import { ApplyConfigurationDialogComponent } from '../apply-configuration/apply-configuration-dialog.component';
import { SavePreferencesDialogComponent } from '../save-preferences-dialog/save-preferences-dialog.component';
import { SelectFunctionDialogComponent } from '../select-function-dialog/select-function-dialog.component';
import { StyleDialogComponent } from '../style-dialog/style-dialog.component';
export class ReportOnDemandComponent {
    /**
     * @param {?} injector
     * @param {?} dialogRef
     * @param {?} data
     */
    constructor(injector, dialogRef, data) {
        this.injector = injector;
        this.dialogRef = dialogRef;
        this.data = data;
        this.orientations = [{ text: "vertical", value: true }, { text: "horizontal", value: false }];
        this.functionsData = [];
        this.initialFunctionsData = [];
        this.appliedConfiguration = false;
        this.selectedFunctions = [];
        this.stylesArray = [
            { value: 'grid', viewValue: 'GRID' },
            { value: 'rowNumber', viewValue: 'ROW_NUMBER' },
            { value: 'columnName', viewValue: 'COLUMNS_NAMES' },
            { value: 'backgroundOnOddRows', viewValue: 'BACKGROUND_ODD_ROWS' },
            { value: 'hideGroupDetails', viewValue: 'GROUP_DETAILS' },
            { value: 'groupNewPage', viewValue: 'GROUP_PAGE' },
            { value: 'firstGroupNewPage', viewValue: 'FIRST_GROUP_PAGE' }
        ];
        this.columnsOrderBy = [];
        this.openedSidenav = true;
        this.fullscreen = false;
        this.blankPdf = 'JVBERi0xLjYKJcOkw7zDtsOfCjIgMCBvYmoKPDwvTGVuZ3RoIDMgMCBSL0ZpbHRlci9GbGF0ZURlY29kZT4+CnN0cmVhbQp4nDPQM1Qo5ypUMFAw0DMwslAwtTTVMzI3VbAwMdSzMDNUKErlCtdSyOMKVAAAtxIIrgplbmRzdHJlYW0KZW5kb2JqCgozIDAgb2JqCjUwCmVuZG9iagoKNSAwIG9iago8PAo+PgplbmRvYmoKCjYgMCBvYmoKPDwvRm9udCA1IDAgUgovUHJvY1NldFsvUERGL1RleHRdCj4+CmVuZG9iagoKMSAwIG9iago8PC9UeXBlL1BhZ2UvUGFyZW50IDQgMCBSL1Jlc291cmNlcyA2IDAgUi9NZWRpYUJveFswIDAgNTk1LjMwMzkzNzAwNzg3NCA4NDEuODg5NzYzNzc5NTI4XS9Hcm91cDw8L1MvVHJhbnNwYXJlbmN5L0NTL0RldmljZVJHQi9JIHRydWU+Pi9Db250ZW50cyAyIDAgUj4+CmVuZG9iagoKNCAwIG9iago8PC9UeXBlL1BhZ2VzCi9SZXNvdXJjZXMgNiAwIFIKL01lZGlhQm94WyAwIDAgNTk1IDg0MSBdCi9LaWRzWyAxIDAgUiBdCi9Db3VudCAxPj4KZW5kb2JqCgo3IDAgb2JqCjw8L1R5cGUvQ2F0YWxvZy9QYWdlcyA0IDAgUgovT3BlbkFjdGlvblsxIDAgUiAvWFlaIG51bGwgbnVsbCAwXQovTGFuZyhlcy1FUykKPj4KZW5kb2JqCgo4IDAgb2JqCjw8L0F1dGhvcjxGRUZGMDA1MDAwNjEwMDc0MDA3MjAwNjkwMDYzMDA2OTAwNjEwMDIwMDA0RDAwNjEwMDcyMDA3NDAwRUQwMDZFMDA2NTAwN0EwMDIwMDA1NDAwNjkwMDZDMDA3NjAwNjU+Ci9DcmVhdG9yPEZFRkYwMDU3MDA3MjAwNjkwMDc0MDA2NTAwNzI+Ci9Qcm9kdWNlcjxGRUZGMDA0QzAwNjkwMDYyMDA3MjAwNjUwMDRGMDA2NjAwNjYwMDY5MDA2MzAwNjUwMDIwMDAzNzAwMkUwMDMxPgovQ3JlYXRpb25EYXRlKEQ6MjAyMjA1MTAxNDUyMDYrMDInMDAnKT4+CmVuZG9iagoKeHJlZgowIDkKMDAwMDAwMDAwMCA2NTUzNSBmIAowMDAwMDAwMjM0IDAwMDAwIG4gCjAwMDAwMDAwMTkgMDAwMDAgbiAKMDAwMDAwMDE0MCAwMDAwMCBuIAowMDAwMDAwNDAyIDAwMDAwIG4gCjAwMDAwMDAxNTkgMDAwMDAgbiAKMDAwMDAwMDE4MSAwMDAwMCBuIAowMDAwMDAwNTAwIDAwMDAwIG4gCjAwMDAwMDA1OTYgMDAwMDAgbiAKdHJhaWxlcgo8PC9TaXplIDkvUm9vdCA3IDAgUgovSW5mbyA4IDAgUgovSUQgWyA8RDdBODhCRTRFREFDRkU1RDFGMTIwMzNFMDUyN0JERkU+CjxEN0E4OEJFNEVEQUNGRTVEMUYxMjAzM0UwNTI3QkRGRT4gXQovRG9jQ2hlY2tzdW0gLzgwNTA5NDU4QjgyN0RCRDQ2QzlEODdBMjY4NjdCNEFDCj4+CnN0YXJ0eHJlZgo4NzYKJSVFT0YK';
        this.appConfig = this.injector.get(AppConfig);
        this.translateService = this.injector.get(OTranslateService);
        this.snackBarService = this.injector.get(SnackBarService);
        this.reportService = this.injector.get(OReportService);
        this.dialogService = this.injector.get(DialogService);
        this.dialog = this.injector.get(MatDialog);
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.initialize();
    }
    /**
     * @protected
     * @return {?}
     */
    initialize() {
        this.table = this.data;
        this.language = this.translateService.getCurrentLang();
        this.service = this.table.service;
        this.columnsArray = this.parseColumnsVisible();
        this.initialColumnsData = this.parseReportColumn(this.columnsArray);
        this.initialColumnsToGroupData = this.columnsArray;
        this.currentConfiguration = { ENTITY: this.table.entity };
        this.initializeReportPreferences();
        this.getFunctions();
    }
    /**
     * @param {?=} serviceName
     * @return {?}
     */
    getDefaultServiceConfiguration(serviceName) {
        /** @type {?} */
        const configuration = this.appConfig.getServiceConfiguration();
        /** @type {?} */
        let servConfig = {};
        if (serviceName && configuration.hasOwnProperty(serviceName)) {
            servConfig = configuration[serviceName];
        }
        return servConfig;
    }
    /**
     * @return {?}
     */
    previewReport() {
        this.openReport();
    }
    /**
     * @return {?}
     */
    clearCurrentPreferences() {
        this.initializeReportPreferences();
        if (this.columnsList) {
            this.columnsList.deselectAll();
        }
        if (this.functionsList) {
            this.functionsList.deselectAll();
        }
        if (this.orderByList) {
            this.orderByList.deselectAll();
        }
    }
    /**
     * @protected
     * @return {?}
     */
    initializeReportPreferences() {
        /* initialize columnsData and functionsData because they are modified by
        changing settings */
        this.columnsData = Utils.cloneObject(this.initialColumnsData);
        this.functionsData = Utils.cloneObject(this.initialFunctionsData);
        this.columnsToGroupData = Utils.cloneObject(this.initialColumnsToGroupData);
        this.columnsOrderBy = [];
        this.pdf = this.blankPdf;
        this.currentPreference = new DefaultOReportPreferences();
        this.currentPreference.entity = this.table.entity;
        this.currentPreference.service = this.table.service;
    }
    /**
     * @protected
     * @return {?}
     */
    parseColumnsVisible() {
        /** @type {?} */
        const columnsArray = Util.parseArray(this.table.columns);
        return this.table.oTableOptions.columns.filter((/**
         * @param {?} oCol
         * @return {?}
         */
        oCol => oCol.type !== "image" && oCol.visible && columnsArray.findIndex((/**
         * @param {?} column
         * @return {?}
         */
        column => column === oCol.attr)) > -1)).map((/**
         * @param {?} x
         * @return {?}
         */
        (x) => x.attr));
    }
    /**
     * @protected
     * @param {?} columns
     * @return {?}
     */
    parseReportColumn(columns) {
        return columns.map((/**
         * @param {?} column
         * @return {?}
         */
        column => {
            /** @type {?} */
            let reportColumn = {
                id: column, name: this.translateService.get(column)
            };
            /** @type {?} */
            let columnStyle = this.parseColumnStyle(column);
            if (Util.isObject(columnStyle) && Object.keys(columnStyle).length > 0) {
                reportColumn.columnStyle = columnStyle;
            }
            return reportColumn;
        }));
    }
    /**
     * @protected
     * @param {?} column
     * @return {?}
     */
    parseColumnStyle(column) {
        /** @type {?} */
        let columnStyle = {};
        /** @type {?} */
        const renderer = this.createRenderer(column);
        if (Util.isDefined(renderer) && Util.isDefined(renderer.type)) {
            columnStyle.renderer = renderer;
        }
        return columnStyle;
    }
    /**
     * @protected
     * @param {?} columnsOrderBy
     * @return {?}
     */
    parseColumnsOrderBy(columnsOrderBy) {
        return columnsOrderBy.map((/**
         * @param {?} column
         * @return {?}
         */
        column => {
            return { columnId: column.columnId, columnName: column.name, ascendent: column.ascendent };
        }));
    }
    /**
     * @protected
     * @return {?}
     */
    openReport() {
        /** @type {?} */
        const serviceConfiguration = this.getDefaultServiceConfiguration(this.currentPreference.service);
        /** @type {?} */
        let pathService;
        if (Util.isObject(serviceConfiguration) && serviceConfiguration.hasOwnProperty('path')) {
            pathService = serviceConfiguration.path;
        }
        this.reportService.createReport({
            "title": this.currentPreference.title, "groups": this.currentPreference.groups, "entity": this.currentPreference.entity, "path": pathService,
            "service": this.currentPreference.service, "vertical": this.currentPreference.vertical, "functions": this.currentPreference.functions,
            "style": this.currentPreference.style, "subtitle": this.currentPreference.subtitle, "columns": this.currentPreference.columns, "orderBy": this.currentPreference.orderBy,
            "language": this.language
        }).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        res => {
            if (res && res.data.length && res.code === 0) {
                this.pdf = res.data[0].file;
            }
        }));
    }
    /**
     * @return {?}
     */
    getFunctions() {
        this.reportService.getFunctions({
            "columns": this.columnsArray, "entity": this.currentPreference.entity,
            "service": this.currentPreference.service, "language": this.language
        }).subscribe((/**
         * @param {?} res
         * @return {?}
         */
        res => {
            if (res && res.data.length && res.code === 0) {
                this.functionsData = this.parseDefaultFunctionsData(res.data[0].functions);
                this.initialFunctionsData = Utils.cloneObject(this.functionsData);
            }
        }));
    }
    /**
     * @param {?} listColumns
     * @return {?}
     */
    parseDefaultFunctionsData(listColumns) {
        return listColumns.filter((/**
         * @param {?} column
         * @return {?}
         */
        column => this.columnsData.
            findIndex((/**
         * @param {?} columnData
         * @return {?}
         */
        columnData => columnData.columnStyle && columnData.columnStyle.renderer && columnData.columnStyle.renderer.type === 'service' && columnData.id === column.columnName)) === -1));
    }
    /**
     * Checks preference data is consistent with the table data
     * @private
     * @return {?}
     */
    checkPreferenceData() {
        this.currentPreference.columns = this.currentPreference.columns.filter((/**
         * @param {?} column
         * @return {?}
         */
        column => this.initialColumnsData.findIndex((/**
         * @param {?} columnData
         * @return {?}
         */
        columnData => columnData.id === column.id)) > -1));
        this.currentPreference.groups = this.currentPreference.groups.filter((/**
         * @param {?} column
         * @return {?}
         */
        column => this.initialColumnsToGroupData.findIndex((/**
         * @param {?} columnData
         * @return {?}
         */
        columnData => columnData === column)) > -1));
        this.currentPreference.functions = this.currentPreference.functions.filter((/**
         * @param {?} column
         * @return {?}
         */
        column => this.initialFunctionsData.findIndex((/**
         * @param {?} columnData
         * @return {?}
         */
        columnData => columnData.columnName === column.columnName)) > -1));
        this.currentPreference.orderBy = this.currentPreference.orderBy.filter((/**
         * @param {?} column
         * @return {?}
         */
        column => this.columnsOrderBy.findIndex((/**
         * @param {?} columnData
         * @return {?}
         */
        columnData => columnData.columnId === column.columnId)) > -1));
    }
    /**
     * @param {?} configuration
     * @return {?}
     */
    applyConfiguration(configuration) {
        this.clearCurrentPreferences();
        this.currentConfiguration = configuration;
        this.currentPreference = JSON.parse(this.currentConfiguration.PREFERENCES);
        this.currentPreference.columns.forEach((/**
         * @param {?} column
         * @return {?}
         */
        (column) => this.updateColumnsOrderByData(column.id)));
        this.checkPreferenceData();
        // Set the functionsData with the data that is loaded from the configuration because it changes
        this.functionsData = this.functionsData.map((/**
         * @param {?} functionData
         * @return {?}
         */
        (functionData) => {
            /** @type {?} */
            const index = this.currentPreference.functions.findIndex((/**
             * @param {?} x
             * @return {?}
             */
            x => x.columnName === functionData.columnName));
            if (index > -1) {
                functionData.type = this.currentPreference.functions[index].type;
            }
            return functionData;
        }));
        this.columnsData.sort((/**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        (a, b) => {
            /** @type {?} */
            let indexA = this.currentPreference.columns.findIndex((/**
             * @param {?} x
             * @return {?}
             */
            x => x.id === a.id));
            /** @type {?} */
            let indexB = this.currentPreference.columns.findIndex((/**
             * @param {?} x
             * @return {?}
             */
            x => x.id === b.id));
            return this.getSortIndex(indexA, indexB);
        }));
        this.columnsOrderBy.sort((/**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        (a, b) => {
            /** @type {?} */
            let indexA = this.currentPreference.orderBy.findIndex((/**
             * @param {?} x
             * @return {?}
             */
            x => x.columnId === a.columnId));
            /** @type {?} */
            let indexB = this.currentPreference.orderBy.findIndex((/**
             * @param {?} x
             * @return {?}
             */
            x => x.columnId === b.columnId));
            return this.getSortIndex(indexA, indexB);
        }));
        this.columnsToGroupData.sort((/**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        (a, b) => {
            /** @type {?} */
            let indexA = this.currentPreference.groups.findIndex((/**
             * @param {?} x
             * @return {?}
             */
            x => x === a));
            /** @type {?} */
            let indexB = this.currentPreference.groups.findIndex((/**
             * @param {?} x
             * @return {?}
             */
            x => x === b));
            return this.getSortIndex(indexA, indexB);
        }));
    }
    /**
     * @private
     * @param {?} indexA
     * @param {?} indexB
     * @return {?}
     */
    getSortIndex(indexA, indexB) {
        if (indexA === -1) {
            return 0;
        }
        if (indexB === -1) {
            return indexB;
        }
        else {
            return indexA - indexB;
        }
    }
    /**
     * @param {?} event
     * @param {?} id
     * @return {?}
     */
    showColumnStyleDialog(event, id) {
        event.stopPropagation();
        /** @type {?} */
        const columnData = Object.assign({}, this.currentPreference.columns.find((/**
         * @param {?} x
         * @return {?}
         */
        (x) => x.id === id)));
        if (Util.isDefined(columnData)) {
            this.dialog
                .open(StyleDialogComponent, {
                data: columnData,
                panelClass: ['o-dialog-class', 'o-table-dialog']
            })
                .afterClosed()
                .subscribe((/**
             * @param {?} data
             * @return {?}
             */
            (data) => {
                if (Util.isDefined(data) && data) {
                    /** @type {?} */
                    const column = Utils.cloneObject(data);
                    this.updateColumnStyleConfigurationData(column);
                }
            }));
        }
    }
    /**
     * @param {?} data
     * @return {?}
     */
    updateColumnStyleConfigurationData(data) {
        /** @type {?} */
        let columns = Utils.cloneObject(this.currentPreference.columns);
        this.currentPreference.columns = [];
        /** @type {?} */
        const indexColumnData = this.columnsData.findIndex((/**
         * @param {?} x
         * @return {?}
         */
        x => x.id === data.id));
        if (indexColumnData > -1) {
            this.columnsData[indexColumnData] = data;
        }
        /** @type {?} */
        const indexColumnStyleData = columns.findIndex((/**
         * @param {?} x
         * @return {?}
         */
        x => x.id === data.id));
        if (indexColumnStyleData > -1) {
            columns[indexColumnStyleData] = data;
        }
        this.currentPreference.columns = columns;
    }
    /**
     * @param {?} event
     * @param {?} reportFunction
     * @return {?}
     */
    selectFunction(event, reportFunction) {
        event.stopPropagation();
        if (reportFunction.columnName != 'TOTAL') {
            this.dialog
                .open(SelectFunctionDialogComponent, {
                data: reportFunction,
                panelClass: ['o-dialog-class', 'o-table-dialog']
            })
                .afterClosed()
                .subscribe((/**
             * @param {?} data
             * @return {?}
             */
            (data) => {
                //Updated current functions selected and functionsData
                if (data) {
                    this.updatedFunctionData(data);
                    this.updatedSelectFunction(data);
                }
            }));
        }
    }
    /**
     * @private
     * @param {?} data
     * @return {?}
     */
    updatedFunctionData(data) {
        /** @type {?} */
        const index = this.functionsData.findIndex((/**
         * @param {?} x
         * @return {?}
         */
        x => x.columnName === data.columnName));
        if (index === -1) {
            this.functionsData.push(data);
        }
        else {
            this.functionsData[index] = data;
        }
    }
    /**
     * @private
     * @param {?} selectedFunction
     * @return {?}
     */
    updatedSelectFunction(selectedFunction) {
        this.currentPreference.functions.forEach((/**
         * @param {?} data
         * @param {?} i
         * @return {?}
         */
        (data, i) => {
            if (data.columnName === selectedFunction.columnName) {
                this.currentPreference.functions[i] = data;
            }
        }));
    }
    /**
     * @return {?}
     */
    openSaveAsPreferences() {
        this.dialog
            .open(SavePreferencesDialogComponent, {
            panelClass: ['o-dialog-class', 'o-table-dialog']
        })
            .afterClosed()
            .subscribe((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            if (Util.isDefined(data) && data) {
                this.savePreferences(data);
            }
        }));
    }
    /**
     * @param {?} event
     * @return {?}
     */
    dropColumns(event) {
        moveItemInArray(this.columnsData, event.previousIndex, event.currentIndex);
        this.updateColumnsSort();
    }
    /**
     * @param {?} event
     * @return {?}
     */
    dropGroups(event) {
        moveItemInArray(this.columnsToGroupData, event.previousIndex, event.currentIndex);
        this.updateColumnToGroupSort();
    }
    /**
     * @param {?} event
     * @return {?}
     */
    dropColumnsOrderBy(event) {
        moveItemInArray(this.columnsOrderBy, event.previousIndex, event.currentIndex);
        this.updateColumnGroupBySort();
    }
    /**
     * @return {?}
     */
    updateColumnsSort() {
        this.currentPreference.columns.sort((/**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        (a, b) => {
            /** @type {?} */
            let indexA = this.columnsData.findIndex((/**
             * @param {?} x
             * @return {?}
             */
            x => x.id === a.id));
            /** @type {?} */
            let indexB = this.columnsData.findIndex((/**
             * @param {?} x
             * @return {?}
             */
            x => x.id === b.id));
            return indexA - indexB;
        }));
    }
    /**
     * @return {?}
     */
    updateColumnGroupBySort() {
        this.currentPreference.orderBy.sort((/**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        (a, b) => {
            /** @type {?} */
            let indexA = this.columnsOrderBy.findIndex((/**
             * @param {?} x
             * @return {?}
             */
            x => x.columnId === a.columnId));
            /** @type {?} */
            let indexB = this.columnsOrderBy.findIndex((/**
             * @param {?} x
             * @return {?}
             */
            x => x.columnId === b.columnId));
            return indexA - indexB;
        }));
    }
    /**
     * @return {?}
     */
    updateColumnToGroupSort() {
        this.currentPreference.groups.sort((/**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        (a, b) => {
            /** @type {?} */
            let indexA = this.columnsToGroupData.findIndex((/**
             * @param {?} x
             * @return {?}
             */
            x => x === a));
            /** @type {?} */
            let indexB = this.columnsToGroupData.findIndex((/**
             * @param {?} x
             * @return {?}
             */
            x => x === b));
            return indexA - indexB;
        }));
    }
    /**
     * @return {?}
     */
    onApplyConfigurationClicked() {
        this.dialog.open(ApplyConfigurationDialogComponent, {
            width: 'calc((75em - 100%) * 1000)',
            maxWidth: '65vw',
            minWidth: '30vw',
            disableClose: true,
            panelClass: ['o-dialog-class', 'o-table-dialog'],
            data: { entity: this.currentPreference.entity, service: this.currentPreference.service },
        }).afterClosed()
            .subscribe((/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            if (Util.isDefined(data) && data) {
                this.applyConfiguration(data);
                this.appliedConfiguration = true;
            }
        }), (/**
         * @param {?} _error
         * @return {?}
         */
        _error => {
            this.appliedConfiguration = false;
        }));
    }
    /**
     * @return {?}
     */
    openSavePreferences() {
        if (Util.isDefined(this.currentConfiguration.ID)) {
            this.savePreferences({ name: this.currentConfiguration.NAME, description: this.currentConfiguration.DESCRIPTION }, true);
        }
        else {
            this.dialog
                .open(SavePreferencesDialogComponent, {
                panelClass: ['o-dialog-class', 'o-table-dialog']
            })
                .afterClosed()
                .subscribe((/**
             * @param {?} data
             * @return {?}
             */
            (data) => {
                if (Util.isDefined(data) && data) {
                    this.savePreferences(data, true);
                }
            }));
        }
    }
    /**
     * @param {?} data
     * @param {?=} update
     * @return {?}
     */
    savePreferences(data, update) {
        /** @type {?} */
        let preference = {
            "name": data.name, "description": data.description,
            "entity": this.currentPreference.entity, "service": this.currentPreference.service, "type": "REPORT", "params": {
                "title": this.currentPreference.title, "groups": this.currentPreference.groups,
                "vertical": this.currentPreference.vertical, "functions": this.currentPreference.functions, "style": this.currentPreference.style,
                "subtitle": this.currentPreference.subtitle, "columns": this.currentPreference.columns, "orderBy": this.currentPreference.orderBy, "entity": this.currentPreference.entity, "service": this.currentPreference.service
            }
        };
        if (update) {
            this.reportService.savePreferences(this.currentConfiguration.ID, preference).subscribe((/**
             * @param {?} res
             * @return {?}
             */
            res => {
                this.showConfirmOperatinInSnackBar(res);
            }));
        }
        else {
            this.reportService.saveAsPreferences(preference).subscribe((/**
             * @param {?} res
             * @return {?}
             */
            res => {
                if (res && res.code === 0) {
                    this.showConfirmOperatinInSnackBar(res);
                }
            }));
        }
    }
    /**
     * @private
     * @param {?} res
     * @return {?}
     */
    showConfirmOperatinInSnackBar(res) {
        if (res && res.code === 0) {
            this.snackBarService.open('MESSAGES.SAVED', { icon: 'check_circle' });
        }
    }
    /**
     * @return {?}
     */
    setFullscreenDialog() {
        Utils.setFullscreenDialog(this.fullscreen, this.dialogRef);
        this.fullscreen = !this.fullscreen;
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onSelectionChangeColumns(event) {
        /** @type {?} */
        const selectedColumn = event.option.value;
        /** @type {?} */
        const selectColumnId = selectedColumn.id;
        this.updateColumnsOrderByData(selectColumnId, event);
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onSelectionChangeGroups(event) {
        if (!event.option.selected)
            return;
        /** @type {?} */
        let groupSelected = event.option.value;
        this.updateColumnsOrderByData(groupSelected, event);
        if (event.option.selected &&
            this.currentPreference.columns.findIndex((/**
             * @param {?} x
             * @return {?}
             */
            x => x.id === groupSelected)) === -1) {
            /** @type {?} */
            const columnStyleSelected = this.columnsData.filter((/**
             * @param {?} x
             * @return {?}
             */
            (x) => x.id === groupSelected));
            if (columnStyleSelected.length > 0) {
                this.addColumnData(columnStyleSelected[0]);
            }
        }
    }
    /**
     * @param {?} columnId
     * @param {?=} event
     * @return {?}
     */
    updateColumnsOrderByData(columnId, event) {
        if (!event) {
            /** @type {?} */
            const existColumn = this.columnsArray.findIndex((/**
             * @param {?} col
             * @return {?}
             */
            col => col === columnId));
            if (existColumn === -1) {
                console.warn('The loaded configuration has the column ' + columnId + ' configured but this column does not exist as a table column');
                return;
            }
        }
        /** @type {?} */
        const columnGroupBySelected = { columnId: columnId, ascendent: true };
        /** @type {?} */
        let index = this.columnsOrderBy.findIndex((/**
         * @param {?} x
         * @return {?}
         */
        x => x.columnId === columnId));
        if ((!event) || (event && event.option.selected)) {
            if (index === -1) {
                this.columnsOrderBy.push(columnGroupBySelected);
            }
        }
        else if (index > -1) {
            this.columnsOrderBy.splice(index);
        }
    }
    /**
     * @param {?} columnSelected
     * @return {?}
     */
    addColumnData(columnSelected) {
        //Object Deep Cloning
        /** @type {?} */
        let currentPreference = Utils.cloneObject(this.currentPreference);
        currentPreference.columns.push(columnSelected);
        this.currentPreference = currentPreference;
        this.updateColumnsSort();
    }
    /**
     * @param {?} event
     * @return {?}
     */
    onSelectionChangeFunctions(event) {
        if (!event.option.selected || event.option.value.columnName === 'TOTAL')
            return;
        /** @type {?} */
        const functionSelect = event.option.value;
        /** @type {?} */
        const columnSelectedToGroup = functionSelect.columnName;
        if (event.option.selected &&
            this.currentPreference.columns.findIndex((/**
             * @param {?} x
             * @return {?}
             */
            x => x.id === columnSelectedToGroup)) === -1) {
            /** @type {?} */
            const column = this.columnsData.find((/**
             * @param {?} x
             * @return {?}
             */
            x => x.id === columnSelectedToGroup));
            this.addColumnData(column);
        }
    }
    /**
     * @param {?} column
     * @param {?} event
     * @return {?}
     */
    changeOrder(column, event) {
        /** @type {?} */
        const columnSelectedToOrder = this.columnsOrderBy.find((/**
         * @param {?} x
         * @return {?}
         */
        x => x.columnId === column.columnId));
        if (columnSelectedToOrder) {
            columnSelectedToOrder.ascendent = !columnSelectedToOrder.ascendent;
        }
        event.stopPropagation();
    }
    /**
     * @param {?} column
     * @return {?}
     */
    isCheckedColumn(column) {
        return this.currentPreference.columns.length > 0 ? this.currentPreference.columns.filter((/**
         * @param {?} x
         * @return {?}
         */
        x => x.id === column.id)).length > 0 : false;
    }
    /**
     * @param {?} column
     * @return {?}
     */
    isCheckedFunction(column) {
        return this.currentPreference.functions.length > 0 ? this.currentPreference.functions.filter((/**
         * @param {?} x
         * @return {?}
         */
        x => (x.columnName === column.columnName && x.type === column.type) && x.type !== 'TOTAL')).length > 0 : false;
    }
    /**
     * @param {?} co1
     * @param {?} co2
     * @return {?}
     */
    columnsOrderByCompareFunction(co1, co2) {
        return co1.columnId === co2.columnId;
    }
    /**
     * @param {?} value
     * @return {?}
     */
    onCheckboxStyleClick(value) {
        if (this.currentPreference.style[value]) {
            this.currentPreference.style[value] = false;
        }
        else {
            this.currentPreference.style[value] = true;
        }
    }
    /**
     * @param {?} co1
     * @param {?} co2
     * @return {?}
     */
    columnsCompareFunction(co1, co2) {
        return co1.id === co2.id;
    }
    /**
     * @param {?} co1
     * @param {?} co2
     * @return {?}
     */
    functionsCompareFunction(co1, co2) {
        return co1.columnName === co2.columnName;
    }
    /**
     * @protected
     * @param {?} column
     * @return {?}
     */
    createRenderer(column) {
        /** @type {?} */
        let oColumn = this.table.oTableOptions.columns.find((/**
         * @param {?} x
         * @return {?}
         */
        x => x.attr === column));
        /** @type {?} */
        let newRenderer;
        if (Util.isDefined(oColumn) && Util.isDefined(oColumn.type) && oColumn.type !== 'string') {
            /** @type {?} */
            const type = oColumn.type;
            newRenderer = {};
            /** @type {?} */
            let columnRenderer = oColumn.renderer;
            switch (type) {
                case 'currency':
                    newRenderer.type = type;
                    newRenderer.currencySymbol = columnRenderer.currencySymbol;
                    newRenderer.currencySymbolPosition = columnRenderer.currencySymbolPosition;
                    break;
                case 'date':
                    newRenderer.type = type;
                    newRenderer.format = columnRenderer.format;
                    break;
                case 'integer':
                    newRenderer.type = type;
                    newRenderer.grouping = columnRenderer.grouping;
                    newRenderer.thousandSeparator = columnRenderer.thousandSeparator;
                    break;
                case 'real':
                    newRenderer.type = type;
                    newRenderer.decimalSeparator = columnRenderer.decimalSeparator;
                    newRenderer.grouping = columnRenderer.grouping;
                    newRenderer.thousandSeparator = columnRenderer.thousandSeparator;
                    break;
                case 'service':
                    newRenderer.type = type;
                    newRenderer.entity = columnRenderer.entity;
                    newRenderer.service = columnRenderer.service;
                    newRenderer.keyColumn = oColumn.attr;
                    newRenderer.columns = Util.parseArray(columnRenderer.columns);
                    newRenderer.valueColumn = columnRenderer.valueColumn;
                    newRenderer.parentKeys = Util.parseArray(columnRenderer.parentKeys);
                    /** @type {?} */
                    const serviceConfiguration = this.getDefaultServiceConfiguration(columnRenderer.service);
                    if (Util.isObject(serviceConfiguration) && Object.hasOwnProperty(serviceConfiguration.path)) {
                        newRenderer.path = serviceConfiguration.path;
                    }
                    break;
            }
        }
        return newRenderer;
    }
}
ReportOnDemandComponent.decorators = [
    { type: Component, args: [{
                selector: 'o-report-on-demand',
                template: "<div mat-dialog-title class=\"dialog-title\" fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n  {{ 'REPORT_ON_DEMAND_TITLE' | oReportsTranslate }}\n  <div>\n    <mat-icon svgIcon=\"ontimize:settings\" #configurationMenuButton [matMenuTriggerFor]=\"configurationMenu\"></mat-icon>\n    <mat-icon aria-label=\"fullscreen dialog\" (click)=\"setFullscreenDialog()\">\n      <ng-container *ngIf=\"fullscreen\">fullscreen_exit</ng-container>\n      <ng-container *ngIf=\"!fullscreen\">fullscreen</ng-container>\n    </mat-icon>\n    <mat-icon svgIcon=\"ontimize:close\" [mat-dialog-close]=\"true\"></mat-icon>\n\n    <mat-menu #configurationMenu=\"matMenu\" class=\"o-mat-menu\">\n      <button type=\"button\" [disabled]=\"!appliedConfiguration\" mat-menu-item (click)=\"openSavePreferences()\">\n        {{ 'BUTTONS.SAVE_CONFIGURATION' | oReportsTranslate }}\n      </button>\n      <button type=\"button\" mat-menu-item (click)=\"openSaveAsPreferences()\">\n        {{ 'BUTTONS.SAVEAS_CONFIGURATION' | oReportsTranslate }}\n      </button>\n      <button type=\"button\" mat-menu-item (click)=\"onApplyConfigurationClicked()\">\n        {{'BUTTONS.APPLY_CONFIGURATION'| oReportsTranslate }}\n      </button>\n    </mat-menu>\n  </div>\n</div>\n<div #dialog mat-dialog-content class=\"dialog-container\">\n  <mat-sidenav-container class=\"mat-sidenav-container\" [class.opened]=\"openedSidenav\" fxFill>\n    <mat-sidenav #sidenav [(opened)]=\"openedSidenav\" mode=\"side\" class=\"report-on-demand-sidenav\">\n      <div fxLayout=\"column\" fxFill fxLayoutGap=\"20px\">\n        <o-button (click)=\"openedSidenav=!openedSidenav\" svg-icon=\"ontimize:menu\" type=\"ICON\" label=\"\"\n          [matTooltip]=\"(sidenav.opened?'HIDE_FILTERS':'SHOW_FILTERS') | oTranslate\">\n        </o-button>\n\n        <div fxLayout=\"column\" *ngIf=\"openedSidenav\" class=\"container-title\" fxLayoutGap=\"10px\">\n          <mat-form-field>\n            <input [(ngModel)]=\"currentPreference.title\" matInput placeholder=\"{{ 'TITLE' | oReportsTranslate }}\">\n          </mat-form-field>\n          <mat-form-field>\n            <input [(ngModel)]=\"currentPreference.subtitle\" matInput placeholder=\"{{ 'SUBTITLE' | oReportsTranslate }}\">\n          </mat-form-field>\n        </div>\n\n        <mat-accordion multi=\"true\" displayMode=\"flat\" fxFlex=\"1 1 auto\" *ngIf=\"openedSidenav\" [@.disabled]=\"true\">\n          <mat-expansion-panel class=\"acordions\">\n            <mat-expansion-panel-header collapsedHeight=\"32px\" expandedHeight=\"32px\">\n              <mat-panel-title>\n                {{ 'ORIENTATION' | oReportsTranslate }}\n              </mat-panel-title>\n            </mat-expansion-panel-header>\n            <mat-radio-group name=\"Orientation\" [(ngModel)]=\"currentPreference.vertical\" fxLayout=\"column\" fxLayoutGap=\"12px\">\n              <mat-radio-button *ngFor=\"let orientation of orientations\" name=\"Orientation\" [value]=\"orientation.value\"\n                [checked]=\"currentPreference.vertical === orientation.value\">\n                {{ orientation.text | oReportsTranslate}}\n              </mat-radio-button>\n            </mat-radio-group>\n          </mat-expansion-panel>\n\n          <mat-expansion-panel class=\"acordions\">\n            <mat-expansion-panel-header collapsedHeight=\"32px\" expandedHeight=\"32px\">\n              <mat-panel-title>\n                {{ 'STYLE' | oReportsTranslate }}\n              </mat-panel-title>\n            </mat-expansion-panel-header>\n            <mat-selection-list dense #settings>\n              <mat-list-option checkboxPosition=\"before\" [selected]=\"currentPreference.style[choice.value]\" *ngFor=\"let choice of stylesArray\"\n                [value]=\"choice.value\" (click)=\"onCheckboxStyleClick(choice.value)\">\n                <div fxLayout=\"row\">\n                  <span fxFlex>\n                    {{choice.viewValue | oReportsTranslate}}\n                  </span>\n                </div>\n              </mat-list-option>\n            </mat-selection-list>\n          </mat-expansion-panel>\n\n          <mat-expansion-panel class=\"acordions\" expanded=\"true\">\n            <mat-expansion-panel-header collapsedHeight=\"32px\" expandedHeight=\"32px\">\n              <mat-panel-title>\n                {{ 'COLUMNS' | oReportsTranslate }}\n              </mat-panel-title>\n            </mat-expansion-panel-header>\n            <mat-selection-list dense #columnsList cdkDropList [cdkDropListData]=\"columnsData\" (cdkDropListDropped)=\"dropColumns($event)\"\n              class=\"columns\" [(ngModel)]=\"currentPreference.columns\" (selectionChange)=\"onSelectionChangeColumns($event)\"\n              [compareWith]=\"columnsCompareFunction\">\n              <mat-list-option checkboxPosition=\"before\" *ngFor=\"let column of columnsData\" [value]=\"column\" cdkDrag>\n                <div fxLayout=\"row\" fxLayoutAlign=\"space-around center\">\n                  <span mat-line fxFlex>\n                    {{column.id | oReportsTranslate}}\n                  </span>\n                  <mat-icon mat-list-icon *ngIf=\"isCheckedColumn(column)\" (click)=\"showColumnStyleDialog($event, column.id)\" class=\"button-edit\">\n                    edit\n                  </mat-icon>\n                  <mat-icon mat-list-icon class=\"button-edit\">drag_handle</mat-icon>\n                </div>\n              </mat-list-option>\n            </mat-selection-list>\n          </mat-expansion-panel>\n          <mat-expansion-panel class=\"acordions\" *ngIf=\"columnsOrderBy.length > 0\">\n            <mat-expansion-panel-header collapsedHeight=\"32px\" expandedHeight=\"32px\">\n              <mat-panel-title>\n                {{ 'ORDER_BY' | oReportsTranslate }}\n              </mat-panel-title>\n            </mat-expansion-panel-header>\n            <mat-selection-list dense #orderByList cdkDropList [cdkDropListData]=\"columnsOrderBy\" (cdkDropListDropped)=\"dropColumnsOrderBy($event)\"\n              class=\"columns\" [(ngModel)]=\"currentPreference.orderBy\" [compareWith]=\"columnsOrderByCompareFunction\">\n              <mat-list-option checkboxPosition=\"before\" *ngFor=\"let column of columnsOrderBy\" [value]=\"column\" cdkDrag>\n                <div fxLayout=\"row\" fxLayoutAlign=\"space-around center\">\n                  <span mat-line fxFlex>\n                    {{column.columnId | oReportsTranslate}}\n                  </span>\n                  <mat-icon *ngIf=\"column.ascendent\" (click)=\"changeOrder(column, $event)\" mat-list-icon svgIcon=\"ontimize:sort_by_alpha_asc\"\n                    class=\"button-edit\"></mat-icon>\n                  <mat-icon *ngIf=\"!column.ascendent\" (click)=\"changeOrder(column, $event)\" mat-list-icon svgIcon=\"ontimize:sort_by_alpha_desc\"\n                    class=\"button-edit\"></mat-icon>\n                  <mat-icon mat-list-icon class=\"button-edit\">drag_handle</mat-icon>\n                </div>\n              </mat-list-option>\n            </mat-selection-list>\n          </mat-expansion-panel>\n          <mat-expansion-panel class=\"acordions\">\n            <mat-expansion-panel-header collapsedHeight=\"32px\" expandedHeight=\"32px\">\n              <mat-panel-title>\n                {{ 'GROUPS' | oReportsTranslate }}\n              </mat-panel-title>\n            </mat-expansion-panel-header>\n            <mat-selection-list dense cdkDropList [cdkDropListData]=\"columnsToGroupData\" (cdkDropListDropped)=\"dropGroups($event)\"\n              [(ngModel)]=\"currentPreference.groups\" (selectionChange)=\"onSelectionChangeGroups($event)\">\n              <mat-list-option checkboxPosition=\"before\" *ngFor=\"let column of columnsToGroupData\" [value]=\"column\" cdkDrag>\n                <div fxLayout=\"row\" fxLayoutAlign=\"space-around center\">\n                  <span mat-line fxFlex>\n                    {{ column | oTranslate }}\n                  </span>\n                  <mat-icon mat-list-icon class=\"button-edit\">drag_handle</mat-icon>\n                </div>\n              </mat-list-option>\n            </mat-selection-list>\n          </mat-expansion-panel>\n\n          <mat-expansion-panel class=\"acordions\" *ngIf=\"functionsData.length>0\">\n            <mat-expansion-panel-header collapsedHeight=\"32px\" expandedHeight=\"32px\">\n              <mat-panel-title>\n                {{ 'FUNCTIONS' | oReportsTranslate }}\n              </mat-panel-title>\n            </mat-expansion-panel-header>\n            <mat-selection-list #functionsList dense [(ngModel)]=\"currentPreference.functions\" [compareWith]=\"functionsCompareFunction\"\n              (selectionChange)=\"onSelectionChangeFunctions($event)\">\n              <mat-list-option checkboxPosition=\"before\" *ngFor=\"let function of functionsData\" [value]=\"function\">\n                <div fxLayout=\"row\" fxLayoutAlign=\"space-around center\">\n                  <span mat-line fxFlex>\n                    <ng-container *ngIf=\"function.columnName==='TOTAL'; else functionColumnTemplate\">\n                      {{function.type | oReportsTranslate}}\n                    </ng-container>\n                  </span>\n                  <ng-template #functionColumnTemplate>\n                    {{function.type | oReportsTranslate }}({{function.columnName | oReportsTranslate }})\n                  </ng-template>\n\n                  <mat-icon *ngIf=\"isCheckedFunction(function)\" mat-list-icon (click)=\"selectFunction($event, function)\" class=\"button-edit\">\n                    edit\n                  </mat-icon>\n                </div>\n              </mat-list-option>\n            </mat-selection-list>\n          </mat-expansion-panel>\n        </mat-accordion>\n\n        <div mat-dialog-actions fxLayout=\"row\" fxLayoutAlign=\"center center\" *ngIf=\"openedSidenav\">\n          <button type=\"button\" mat-stroked-button class=\"o-report-on-demand-clear-button\" (click)=\"clearCurrentPreferences()\">\n            {{'CLEAR' | oReportsTranslate }}</button>\n          <button type=\"button\" mat-stroked-button class=\"mat-primary\" (click)=\"previewReport()\" [disabled]=\"currentPreference.columns.length===0\">\n            {{'PREVIEW' | oReportsTranslate }}</button>\n        </div>\n\n      </div>\n    </mat-sidenav>\n    <mat-sidenav-content>\n      <div class=\"sidenav-container-content\">\n        <ngx-extended-pdf-viewer #pdfViewer [base64Src]=\"pdf\" [filenameForDownload]=\"currentPreference.title\" [showBookmarkButton]=\"false\"\n          [showPropertiesButton]=\"false\" [showOpenFileButton]=\"false\" useBrowserLocale=\"true\" delayFirstView=\"1000\" [textLayer]=\"true\">\n        </ngx-extended-pdf-viewer>\n      </div>\n    </mat-sidenav-content>\n  </mat-sidenav-container>\n</div>\n",
                encapsulation: ViewEncapsulation.None,
                host: {
                    '[class.o-report-on-demand]': 'true'
                },
                styles: [".o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-title .mat-icon{cursor:pointer}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content{max-height:calc(100% - 36px - 16px);height:100%;padding-top:16px;padding-bottom:0}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content ngx-extended-pdf-viewer .zoom{height:100%}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content .mat-icon{cursor:pointer}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content .mat-sidenav{visibility:visible!important;transform:none;top:0;left:0;padding:8px 16px;border:1px solid transparent}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content .mat-sidenav .mat-drawer-inner-container{overflow:hidden}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content .mat-sidenav .mat-dialog-actions{min-height:auto;padding-top:0}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content .mat-sidenav .mat-dialog-actions button.o-report-on-demand-clear-button{min-width:80px}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content .mat-sidenav .mat-radio-group{margin:0 12px}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content .mat-sidenav .mat-accordion{overflow-y:scroll}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content .mat-sidenav .mat-accordion .acordions.mat-expansion-panel{border-radius:0;box-shadow:none;margin-bottom:8px}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content .mat-sidenav .mat-accordion .acordions.mat-expansion-panel:last-of-type{margin-bottom:0}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content .mat-sidenav .mat-accordion .acordions.mat-expansion-panel .mat-expansion-panel-header{padding:0 8px}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content .mat-sidenav .mat-accordion .acordions.mat-expansion-panel .mat-expansion-panel-body{padding:0}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content .mat-sidenav .mat-accordion .mat-list-option .button-edit{cursor:pointer}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content .mat-sidenav .mat-accordion .mat-list-option.cdk-drag{cursor:move}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content .mat-sidenav .mat-accordion .mat-list-option .mat-list-item-content{padding:0 0 0 8px}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content .mat-sidenav .mat-accordion .mat-list-option .mat-list-item-content .mat-list-text{padding-right:8px}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content .mat-sidenav.mat-drawer-opened{border:1px solid #dee1e6;border-radius:4px;width:256px}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content .mat-sidenav-container{background-color:transparent}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content .mat-sidenav-container.opened .sidenav-container-content{margin-left:16px}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content .mat-sidenav-content{overflow:hidden}.o-dialog-class .mat-dialog-container .o-report-on-demand .mat-dialog-content .mat-sidenav-content .sidenav-container-content{margin-left:66px;height:100%}"]
            }] }
];
/** @nocollapse */
ReportOnDemandComponent.ctorParameters = () => [
    { type: Injector },
    { type: MatDialogRef },
    { type: OTableComponent, decorators: [{ type: Inject, args: [MAT_DIALOG_DATA,] }] }
];
ReportOnDemandComponent.propDecorators = {
    columnsList: [{ type: ViewChild, args: ['columnsList', { static: false },] }],
    functionsList: [{ type: ViewChild, args: ['functionsList', { static: false },] }],
    orderByList: [{ type: ViewChild, args: ['orderByList', { static: false },] }]
};
if (false) {
    /** @type {?} */
    ReportOnDemandComponent.prototype.columnsList;
    /** @type {?} */
    ReportOnDemandComponent.prototype.functionsList;
    /** @type {?} */
    ReportOnDemandComponent.prototype.orderByList;
    /** @type {?} */
    ReportOnDemandComponent.prototype.orientations;
    /** @type {?} */
    ReportOnDemandComponent.prototype.functionsData;
    /**
     * @type {?}
     * @private
     */
    ReportOnDemandComponent.prototype.initialFunctionsData;
    /** @type {?} */
    ReportOnDemandComponent.prototype.appliedConfiguration;
    /** @type {?} */
    ReportOnDemandComponent.prototype.selectedFunctions;
    /** @type {?} */
    ReportOnDemandComponent.prototype.stylesArray;
    /** @type {?} */
    ReportOnDemandComponent.prototype.columnsData;
    /**
     * @type {?}
     * @private
     */
    ReportOnDemandComponent.prototype.initialColumnsData;
    /** @type {?} */
    ReportOnDemandComponent.prototype.selectedColumnsData;
    /** @type {?} */
    ReportOnDemandComponent.prototype.columnsOrderBy;
    /** @type {?} */
    ReportOnDemandComponent.prototype.columnsToGroupData;
    /**
     * @type {?}
     * @private
     */
    ReportOnDemandComponent.prototype.initialColumnsToGroupData;
    /** @type {?} */
    ReportOnDemandComponent.prototype.openedSidenav;
    /** @type {?} */
    ReportOnDemandComponent.prototype.fullscreen;
    /**
     * @type {?}
     * @protected
     */
    ReportOnDemandComponent.prototype.service;
    /**
     * @type {?}
     * @protected
     */
    ReportOnDemandComponent.prototype.language;
    /**
     * @type {?}
     * @protected
     */
    ReportOnDemandComponent.prototype.columnsArray;
    /**
     * @type {?}
     * @protected
     */
    ReportOnDemandComponent.prototype.table;
    /**
     * @type {?}
     * @private
     */
    ReportOnDemandComponent.prototype.blankPdf;
    /** @type {?} */
    ReportOnDemandComponent.prototype.currentPreference;
    /** @type {?} */
    ReportOnDemandComponent.prototype.currentConfiguration;
    /** @type {?} */
    ReportOnDemandComponent.prototype.pdf;
    /** @type {?} */
    ReportOnDemandComponent.prototype.translateService;
    /**
     * @type {?}
     * @protected
     */
    ReportOnDemandComponent.prototype.appConfig;
    /**
     * @type {?}
     * @protected
     */
    ReportOnDemandComponent.prototype.snackBarService;
    /**
     * @type {?}
     * @protected
     */
    ReportOnDemandComponent.prototype.reportService;
    /**
     * @type {?}
     * @protected
     */
    ReportOnDemandComponent.prototype.dialogService;
    /** @type {?} */
    ReportOnDemandComponent.prototype.dialog;
    /** @type {?} */
    ReportOnDemandComponent.prototype.injector;
    /** @type {?} */
    ReportOnDemandComponent.prototype.dialogRef;
    /** @type {?} */
    ReportOnDemandComponent.prototype.data;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVwb3J0LW9uLWRlbWFuZC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9vbnRpbWl6ZS13ZWItbmd4LXJlcG9ydC8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL3JlcG9ydC1vbi1kZW1hbmQvcmVwb3J0LW9uLWRlbWFuZC9yZXBvcnQtb24tZGVtYW5kLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBZSxlQUFlLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUN0RSxPQUFPLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN2RSxPQUFPLEVBQUUsU0FBUyxFQUFVLE1BQU0sRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMxRCxPQUFPLEVBQUUsZ0JBQWdCLEVBQTBCLE1BQU0sbUJBQW1CLENBQUM7QUFDN0UsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsZUFBZSxFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFDcEYsT0FBTyxFQUFFLFNBQVMsRUFBRSxhQUFhLEVBQVcsZUFBZSxFQUFFLGlCQUFpQixFQUFFLGVBQWUsRUFBRSxJQUFJLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUNoSSxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sb0NBQW9DLENBQUM7QUFNcEUsT0FBTyxFQUFFLHlCQUF5QixFQUFzQixNQUFNLHdDQUF3QyxDQUFDO0FBQ3ZHLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUM1QyxPQUFPLEVBQUUsaUNBQWlDLEVBQUUsTUFBTSw2REFBNkQsQ0FBQztBQUNoSCxPQUFPLEVBQUUsOEJBQThCLEVBQUUsTUFBTSw4REFBOEQsQ0FBQztBQUM5RyxPQUFPLEVBQUUsNkJBQTZCLEVBQUUsTUFBTSw0REFBNEQsQ0FBQztBQUUzRyxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSx3Q0FBd0MsQ0FBQztBQVk5RSxNQUFN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eUM7Ozs7O0lBQ3pDLHFEQUFpRDs7SUFDakQsc0RBQXFDOztJQUNyQyxpREFBa0Q7O0lBRWxELHFEQUFpQzs7Ozs7SUFDakMsNERBQXlDOztJQUN6QyxnREFBcUM7O0lBQ3JDLDZDQUFtQzs7Ozs7SUFFbkMsMENBQTBCOzs7OztJQUMxQiwyQ0FBMkI7Ozs7O0lBQzNCLCtDQUFzQzs7Ozs7SUFDdEMsd0NBQWlDOzs7OztJQUNqQywyQ0FBc3FEOztJQUV0cUQsb0RBQTZDOztJQUM3Qyx1REFBa0Q7O0lBQ2xELHNDQUFtQjs7SUFFbkIsbURBQTJDOzs7OztJQUMzQyw0Q0FBK0I7Ozs7O0lBQy9CLGtEQUEyQzs7Ozs7SUFDM0MsZ0RBQXdDOzs7OztJQUN4QyxnREFBdUM7O0lBQ3ZDLHlDQUF5Qjs7SUFHdkIsMkNBQXlCOztJQUN6Qiw0Q0FBdUQ7O0lBQ3ZELHVDQUFxRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENka0RyYWdEcm9wLCBtb3ZlSXRlbUluQXJyYXkgfSBmcm9tICdAYW5ndWxhci9jZGsvZHJhZy1kcm9wJztcbmltcG9ydCB7IEluamVjdG9yLCBWaWV3Q2hpbGQsIFZpZXdFbmNhcHN1bGF0aW9uIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5qZWN0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBNYXRTZWxlY3Rpb25MaXN0LCBNYXRTZWxlY3Rpb25MaXN0Q2hhbmdlIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwnO1xuaW1wb3J0IHsgTWF0RGlhbG9nLCBNYXREaWFsb2dSZWYsIE1BVF9ESUFMT0dfREFUQSB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL2RpYWxvZyc7XG5pbXBvcnQgeyBBcHBDb25maWcsIERpYWxvZ1NlcnZpY2UsIE9Db2x1bW4sIE9UYWJsZUNvbXBvbmVudCwgT1RyYW5zbGF0ZVNlcnZpY2UsIFNuYWNrQmFyU2VydmljZSwgVXRpbCB9IGZyb20gJ29udGltaXplLXdlYi1uZ3gnO1xuaW1wb3J0IHsgT1JlcG9ydFNlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi9zZXJ2aWNlcy9vLXJlcG9ydC5zZXJ2aWNlJztcbmltcG9ydCB7IE9SZXBvcnRDb2x1bW5TdHlsZSB9IGZyb20gJy4uLy4uLy4uL3R5cGVzL3JlcG9ydC1jb2x1bW4tc3R5bGUudHlwZSc7XG5pbXBvcnQgeyBPUmVwb3J0Q29sdW1uIH0gZnJvbSAnLi4vLi4vLi4vdHlwZXMvcmVwb3J0LWNvbHVtbi50eXBlJztcbmltcG9ydCB7IE9SZXBvcnRDb25maWd1cmF0aW9uIH0gZnJvbSAnLi4vLi4vLi4vdHlwZXMvcmVwb3J0LWNvbmZpZ3VyYXRpb24udHlwZSc7XG5pbXBvcnQgeyBPUmVwb3J0RnVuY3Rpb24gfSBmcm9tICcuLi8uLi8uLi90eXBlcy9yZXBvcnQtZnVuY3Rpb24udHlwZSc7XG5pbXBvcnQgeyBPUmVwb3J0T3JkZXJCeSB9IGZyb20gJy4uLy4uLy4uL3R5cGVzL3JlcG9ydC1vcmRlckJ5LnR5cGUnO1xuaW1wb3J0IHsgRGVmYXVsdE9SZXBvcnRQcmVmZXJlbmNlcywgT1JlcG9ydFByZWZlcmVuY2VzIH0gZnJvbSAnLi4vLi4vLi4vdHlwZXMvcmVwb3J0LXByZWZlcmVuY2VzLnR5cGUnO1xuaW1wb3J0IHsgVXRpbHMgfSBmcm9tICcuLi8uLi8uLi91dGlsL3V0aWxzJztcbmltcG9ydCB7IEFwcGx5Q29uZmlndXJhdGlvbkRpYWxvZ0NvbXBvbmVudCB9IGZyb20gJy4uL2FwcGx5LWNvbmZpZ3VyYXRpb24vYXBwbHktY29uZmlndXJhdGlvbi1kaWFsb2cuY29tcG9uZW50JztcbmltcG9ydCB7IFNhdmVQcmVmZXJlbmNlc0RpYWxvZ0NvbXBvbmVudCB9IGZyb20gJy4uL3NhdmUtcHJlZmVyZW5jZXMtZGlhbG9nL3NhdmUtcHJlZmVyZW5jZXMtZGlhbG9nLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBTZWxlY3RGdW5jdGlvbkRpYWxvZ0NvbXBvbmVudCB9IGZyb20gJy4uL3NlbGVjdC1mdW5jdGlvbi1kaWFsb2cvc2VsZWN0LWZ1bmN0aW9uLWRpYWxvZy5jb21wb25lbnQnO1xuXG5pbXBvcnQgeyBTdHlsZURpYWxvZ0NvbXBvbmVudCB9IGZyb20gJy4uL3N0eWxlLWRpYWxvZy9zdHlsZS1kaWFsb2cuY29tcG9uZW50JztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnby1yZXBvcnQtb24tZGVtYW5kJyxcbiAgdGVtcGxhdGVVcmw6ICcuL3JlcG9ydC1vbi1kZW1hbmQuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9yZXBvcnQtb24tZGVtYW5kLmNvbXBvbmVudC5zY3NzJ10sXG4gIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXG4gIGhvc3Q6IHtcbiAgICAnW2NsYXNzLm8tcmVwb3J0LW9uLWRlbWFuZF0nOiAndHJ1ZSdcbiAgfVxufSlcblxuZXhwb3J0IGNsYXNzIFJlcG9ydE9uRGVtYW5kQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcblxuICBAVmlld0NoaWxkKCdjb2x1bW5zTGlzdCcsIHsgc3RhdGljOiBmYWxzZSB9KSBjb2x1bW5zTGlzdDogTWF0U2VsZWN0aW9uTGlzdDtcbiAgQFZpZXdDaGlsZCgnZnVuY3Rpb25zTGlzdCcsIHsgc3RhdGljOiBmYWxzZSB9KSBmdW5jdGlvbnNMaXN0OiBNYXRTZWxlY3Rpb25MaXN0O1xuICBAVmlld0NoaWxkKCdvcmRlckJ5TGlzdCcsIHsgc3RhdGljOiBmYWxzZSB9KSBvcmRlckJ5TGlzdDogTWF0U2VsZWN0aW9uTGlzdDtcblxuICBwdWJsaWMgb3JpZW50YXRpb25zID0gW3sgdGV4dDogXCJ2ZXJ0aWNhbFwiLCB2YWx1ZTogdHJ1ZSB9LCB7IHRleHQ6IFwiaG9yaXpvbnRhbFwiLCB2YWx1ZTogZmFsc2UgfV07XG4gIHB1YmxpYyBmdW5jdGlvbnNEYXRhOiBPUmVwb3J0RnVuY3Rpb25bXSA9IFtdO1xuICBwcml2YXRlIGluaXRpYWxGdW5jdGlvbnNEYXRhOiBPUmVwb3J0RnVuY3Rpb25bXSA9IFtdO1xuICBwdWJsaWMgYXBwbGllZENvbmZpZ3VyYXRpb246IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHVibGljIHNlbGVjdGVkRnVuY3Rpb25zID0gW107XG5cbiAgcHVibGljIHN0eWxlc0FycmF5ID0gW1xuICAgIHsgdmFsdWU6ICdncmlkJywgdmlld1ZhbHVlOiAnR1JJRCcgfSxcbiAgICB7IHZhbHVlOiAncm93TnVtYmVyJywgdmlld1ZhbHVlOiAnUk9XX05VTUJFUicgfSxcbiAgICB7IHZhbHVlOiAnY29sdW1uTmFtZScsIHZpZXdWYWx1ZTogJ0NPTFVNTlNfTkFNRVMnIH0sXG4gICAgeyB2YWx1ZTogJ2JhY2tncm91bmRPbk9kZFJvd3MnLCB2aWV3VmFsdWU6ICdCQUNLR1JPVU5EX09ERF9ST1dTJyB9LFxuICAgIHsgdmFsdWU6ICdoaWRlR3JvdXBEZXRhaWxzJywgdmlld1ZhbHVlOiAnR1JPVVBfREVUQUlMUycgfSxcbiAgICB7IHZhbHVlOiAnZ3JvdXBOZXdQYWdlJywgdmlld1ZhbHVlOiAnR1JPVVBfUEFHRScgfSxcbiAgICB7IHZhbHVlOiAnZmlyc3RHcm91cE5ld1BhZ2UnLCB2aWV3VmFsdWU6ICdGSVJTVF9HUk9VUF9QQUdFJyB9XG4gIF07XG5cblxuICBwdWJsaWMgY29sdW1uc0RhdGE6IEFycmF5PE9SZXBvcnRDb2x1bW4+O1xuICBwcml2YXRlIGluaXRpYWxDb2x1bW5zRGF0YTogQXJyYXk8T1JlcG9ydENvbHVtbj47XG4gIHB1YmxpYyBzZWxlY3RlZENvbHVtbnNEYXRhOiBzdHJpbmdbXTtcbiAgcHVibGljIGNvbHVtbnNPcmRlckJ5OiBBcnJheTxPUmVwb3J0T3JkZXJCeT4gPSBbXTtcblxuICBwdWJsaWMgY29sdW1uc1RvR3JvdXBEYXRhOiBhbnlbXTtcbiAgcHJpdmF0ZSBpbml0aWFsQ29sdW1uc1RvR3JvdXBEYXRhOiBhbnlbXTtcbiAgcHVibGljIG9wZW5lZFNpZGVuYXY6IGJvb2xlYW4gPSB0cnVlO1xuICBwdWJsaWMgZnVsbHNjcmVlbjogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIHByb3RlY3RlZCBzZXJ2aWNlOiBzdHJpbmc7XG4gIHByb3RlY3RlZCBsYW5ndWFnZTogc3RyaW5nO1xuICBwcm90ZWN0ZWQgY29sdW1uc0FycmF5OiBBcnJheTxzdHJpbmc+O1xuICBwcm90ZWN0ZWQgdGFibGU6IE9UYWJsZUNvbXBvbmVudDtcbiAgcHJpdmF0ZSBibGFua1BkZjogc3RyaW5nID0gJ0pWQkVSaTB4TGpZS0pjT2t3N3pEdHNPZkNqSWdNQ0J2WW1vS1BEd3ZUR1Z1WjNSb0lETWdNQ0JTTDBacGJIUmxjaTlHYkdGMFpVUmxZMjlrWlQ0K0NuTjBjbVZoYlFwNG5EUFFNMVFvNXlwVU1GQXcwRE13c2xBd3RUVFZNekkzVmJBd01kU3pNRE5VS0VybEN0ZFN5T01LVkFBQXR4SUlyZ3BsYm1SemRISmxZVzBLWlc1a2IySnFDZ296SURBZ2IySnFDalV3Q21WdVpHOWlhZ29LTlNBd0lHOWlhZ284UEFvK1BncGxibVJ2WW1vS0NqWWdNQ0J2WW1vS1BEd3ZSbTl1ZENBMUlEQWdVZ292VUhKdlkxTmxkRnN2VUVSR0wxUmxlSFJkQ2o0K0NtVnVaRzlpYWdvS01TQXdJRzlpYWdvOFBDOVVlWEJsTDFCaFoyVXZVR0Z5Wlc1MElEUWdNQ0JTTDFKbGMyOTFjbU5sY3lBMklEQWdVaTlOWldScFlVSnZlRnN3SURBZ05UazFMak13TXprek56QXdOemczTkNBNE5ERXVPRGc1TnpZek56YzVOVEk0WFM5SGNtOTFjRHc4TDFNdlZISmhibk53WVhKbGJtTjVMME5UTDBSbGRtbGpaVkpIUWk5SklIUnlkV1UrUGk5RGIyNTBaVzUwY3lBeUlEQWdVajQrQ21WdVpHOWlhZ29LTkNBd0lHOWlhZ284UEM5VWVYQmxMMUJoWjJWekNpOVNaWE52ZFhKalpYTWdOaUF3SUZJS0wwMWxaR2xoUW05NFd5QXdJREFnTlRrMUlEZzBNU0JkQ2k5TGFXUnpXeUF4SURBZ1VpQmRDaTlEYjNWdWRDQXhQajRLWlc1a2IySnFDZ28zSURBZ2IySnFDanc4TDFSNWNHVXZRMkYwWVd4dlp5OVFZV2RsY3lBMElEQWdVZ292VDNCbGJrRmpkR2x2YmxzeElEQWdVaUF2V0ZsYUlHNTFiR3dnYm5Wc2JDQXdYUW92VEdGdVp5aGxjeTFGVXlrS1BqNEtaVzVrYjJKcUNnbzRJREFnYjJKcUNqdzhMMEYxZEdodmNqeEdSVVpHTURBMU1EQXdOakV3TURjME1EQTNNakF3Tmprd01EWXpNREEyT1RBd05qRXdNREl3TURBMFJEQXdOakV3TURjeU1EQTNOREF3UlVRd01EWkZNREEyTlRBd04wRXdNREl3TURBMU5EQXdOamt3TURaRE1EQTNOakF3TmpVK0NpOURjbVZoZEc5eVBFWkZSa1l3TURVM01EQTNNakF3Tmprd01EYzBNREEyTlRBd056SStDaTlRY205a2RXTmxjanhHUlVaR01EQTBRekF3Tmprd01EWXlNREEzTWpBd05qVXdNRFJHTURBMk5qQXdOall3TURZNU1EQTJNekF3TmpVd01ESXdNREF6TnpBd01rVXdNRE14UGdvdlEzSmxZWFJwYjI1RVlYUmxLRVE2TWpBeU1qQTFNVEF4TkRVeU1EWXJNREluTURBbktUNCtDbVZ1Wkc5aWFnb0tlSEpsWmdvd0lEa0tNREF3TURBd01EQXdNQ0EyTlRVek5TQm1JQW93TURBd01EQXdNak0wSURBd01EQXdJRzRnQ2pBd01EQXdNREF3TVRrZ01EQXdNREFnYmlBS01EQXdNREF3TURFME1DQXdNREF3TUNCdUlBb3dNREF3TURBd05EQXlJREF3TURBd0lHNGdDakF3TURBd01EQXhOVGtnTURBd01EQWdiaUFLTURBd01EQXdNREU0TVNBd01EQXdNQ0J1SUFvd01EQXdNREF3TlRBd0lEQXdNREF3SUc0Z0NqQXdNREF3TURBMU9UWWdNREF3TURBZ2JpQUtkSEpoYVd4bGNnbzhQQzlUYVhwbElEa3ZVbTl2ZENBM0lEQWdVZ292U1c1bWJ5QTRJREFnVWdvdlNVUWdXeUE4UkRkQk9EaENSVFJGUkVGRFJrVTFSREZHTVRJd016TkZNRFV5TjBKRVJrVStDanhFTjBFNE9FSkZORVZFUVVOR1JUVkVNVVl4TWpBek0wVXdOVEkzUWtSR1JUNGdYUW92Ukc5alEyaGxZMnR6ZFcwZ0x6Z3dOVEE1TkRVNFFqZ3lOMFJDUkRRMlF6bEVPRGRCTWpZNE5qZENORUZEQ2o0K0NuTjBZWEowZUhKbFpnbzROellLSlNWRlQwWUsnO1xuXG4gIHB1YmxpYyBjdXJyZW50UHJlZmVyZW5jZTogT1JlcG9ydFByZWZlcmVuY2VzO1xuICBwdWJsaWMgY3VycmVudENvbmZpZ3VyYXRpb246IE9SZXBvcnRDb25maWd1cmF0aW9uO1xuICBwdWJsaWMgcGRmOiBzdHJpbmc7XG5cbiAgcHVibGljIHRyYW5zbGF0ZVNlcnZpY2U6IE9UcmFuc2xhdGVTZXJ2aWNlO1xuICBwcm90ZWN0ZWQgYXBwQ29uZmlnOiBBcHBDb25maWc7XG4gIHByb3RlY3RlZCBzbmFja0JhclNlcnZpY2U6IFNuYWNrQmFyU2VydmljZTtcbiAgcHJvdGVjdGVkIHJlcG9ydFNlcnZpY2U6IE9SZXBvcnRTZXJ2aWNlO1xuICBwcm90ZWN0ZWQgZGlhbG9nU2VydmljZTogRGlhbG9nU2VydmljZTtcbiAgcHVibGljIGRpYWxvZzogTWF0RGlhbG9nO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHB1YmxpYyBpbmplY3RvcjogSW5qZWN0b3IsXG4gICAgcHVibGljIGRpYWxvZ1JlZjogTWF0RGlhbG9nUmVmPFJlcG9ydE9uRGVtYW5kQ29tcG9uZW50PixcbiAgICBASW5qZWN0KE1BVF9ESUFMT0dfREFUQSkgcHVibGljIGRhdGE6IE9UYWJsZUNvbXBvbmVudFxuICApIHtcbiAgICB0aGlzLmFwcENvbmZpZyA9IHRoaXMuaW5qZWN0b3IuZ2V0KEFwcENvbmZpZyk7XG4gICAgdGhpcy50cmFuc2xhdGVTZXJ2aWNlID0gdGhpcy5pbmplY3Rvci5nZXQ8T1RyYW5zbGF0ZVNlcnZpY2U+KE9UcmFuc2xhdGVTZXJ2aWNlKTtcbiAgICB0aGlzLnNuYWNrQmFyU2VydmljZSA9IHRoaXMuaW5qZWN0b3IuZ2V0PFNuYWNrQmFyU2VydmljZT4oU25hY2tCYXJTZXJ2aWNlKTtcbiAgICB0aGlzLnJlcG9ydFNlcnZpY2UgPSB0aGlzLmluamVjdG9yLmdldDxPUmVwb3J0U2VydmljZT4oT1JlcG9ydFNlcnZpY2UpO1xuICAgIHRoaXMuZGlhbG9nU2VydmljZSA9IHRoaXMuaW5qZWN0b3IuZ2V0PERpYWxvZ1NlcnZpY2U+KERpYWxvZ1NlcnZpY2UpO1xuICAgIHRoaXMuZGlhbG9nID0gdGhpcy5pbmplY3Rvci5nZXQ8TWF0RGlhbG9nPihNYXREaWFsb2cpO1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy5pbml0aWFsaXplKCk7XG4gIH1cblxuICBwcm90ZWN0ZWQgaW5pdGlhbGl6ZSgpIHtcbiAgICB0aGlzLnRhYmxlID0gdGhpcy5kYXRhO1xuICAgIHRoaXMubGFuZ3VhZ2UgPSB0aGlzLnRyYW5zbGF0ZVNlcnZpY2UuZ2V0Q3VycmVudExhbmcoKTtcbiAgICB0aGlzLnNlcnZpY2UgPSB0aGlzLnRhYmxlLnNlcnZpY2U7XG4gICAgdGhpcy5jb2x1bW5zQXJyYXkgPSB0aGlzLnBhcnNlQ29sdW1uc1Zpc2libGUoKTtcbiAgICB0aGlzLmluaXRpYWxDb2x1bW5zRGF0YSA9IHRoaXMucGFyc2VSZXBvcnRDb2x1bW4odGhpcy5jb2x1bW5zQXJyYXkpO1xuICAgIHRoaXMuaW5pdGlhbENvbHVtbnNUb0dyb3VwRGF0YSA9IHRoaXMuY29sdW1uc0FycmF5O1xuICAgIHRoaXMuY3VycmVudENvbmZpZ3VyYXRpb24gPSB7IEVOVElUWTogdGhpcy50YWJsZS5lbnRpdHkgfTtcbiAgICB0aGlzLmluaXRpYWxpemVSZXBvcnRQcmVmZXJlbmNlcygpO1xuXG4gICAgdGhpcy5nZXRGdW5jdGlvbnMoKTtcbiAgfVxuXG4gIHB1YmxpYyBnZXREZWZhdWx0U2VydmljZUNvbmZpZ3VyYXRpb24oc2VydmljZU5hbWU/OiBzdHJpbmcpOiBhbnkge1xuICAgIGNvbnN0IGNvbmZpZ3VyYXRpb24gPSB0aGlzLmFwcENvbmZpZy5nZXRTZXJ2aWNlQ29uZmlndXJhdGlvbigpO1xuICAgIGxldCBzZXJ2Q29uZmlnID0ge307XG4gICAgaWYgKHNlcnZpY2VOYW1lICYmIGNvbmZpZ3VyYXRpb24uaGFzT3duUHJvcGVydHkoc2VydmljZU5hbWUpKSB7XG4gICAgICBzZXJ2Q29uZmlnID0gY29uZmlndXJhdGlvbltzZXJ2aWNlTmFtZV07XG4gICAgfVxuICAgIHJldHVybiBzZXJ2Q29uZmlnO1xuICB9XG5cbiAgcHVibGljIHByZXZpZXdSZXBvcnQoKTogdm9pZCB7XG4gICAgdGhpcy5vcGVuUmVwb3J0KCk7XG4gIH1cblxuICBwdWJsaWMgY2xlYXJDdXJyZW50UHJlZmVyZW5jZXMoKSB7XG4gICAgdGhpcy5pbml0aWFsaXplUmVwb3J0UHJlZmVyZW5jZXMoKTtcbiAgICBpZiAodGhpcy5jb2x1bW5zTGlzdCkge1xuICAgICAgdGhpcy5jb2x1bW5zTGlzdC5kZXNlbGVjdEFsbCgpO1xuICAgIH1cbiAgICBpZiAodGhpcy5mdW5jdGlvbnNMaXN0KSB7XG4gICAgICB0aGlzLmZ1bmN0aW9uc0xpc3QuZGVzZWxlY3RBbGwoKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5vcmRlckJ5TGlzdCkge1xuICAgICAgdGhpcy5vcmRlckJ5TGlzdC5kZXNlbGVjdEFsbCgpO1xuICAgIH1cbiAgfVxuXG4gIHByb3RlY3RlZCBpbml0aWFsaXplUmVwb3J0UHJlZmVyZW5jZXMoKSB7XG4gICAgLyogaW5pdGlhbGl6ZSBjb2x1bW5zRGF0YSBhbmQgZnVuY3Rpb25zRGF0YSBiZWNhdXNlIHRoZXkgYXJlIG1vZGlmaWVkIGJ5XG4gICAgY2hhbmdpbmcgc2V0dGluZ3MgKi9cbiAgICB0aGlzLmNvbHVtbnNEYXRhID0gVXRpbHMuY2xvbmVPYmplY3QodGhpcy5pbml0aWFsQ29sdW1uc0RhdGEpO1xuICAgIHRoaXMuZnVuY3Rpb25zRGF0YSA9IFV0aWxzLmNsb25lT2JqZWN0KHRoaXMuaW5pdGlhbEZ1bmN0aW9uc0RhdGEpO1xuICAgIHRoaXMuY29sdW1uc1RvR3JvdXBEYXRhID0gVXRpbHMuY2xvbmVPYmplY3QodGhpcy5pbml0aWFsQ29sdW1uc1RvR3JvdXBEYXRhKTtcbiAgICB0aGlzLmNvbHVtbnNPcmRlckJ5ID0gW107XG4gICAgdGhpcy5wZGYgPSB0aGlzLmJsYW5rUGRmO1xuICAgIHRoaXMuY3VycmVudFByZWZlcmVuY2UgPSBuZXcgRGVmYXVsdE9SZXBvcnRQcmVmZXJlbmNlcygpO1xuICAgIHRoaXMuY3VycmVudFByZWZlcmVuY2UuZW50aXR5ID0gdGhpcy50YWJsZS5lbnRpdHk7XG4gICAgdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5zZXJ2aWNlID0gdGhpcy50YWJsZS5zZXJ2aWNlO1xuICB9XG5cbiAgcHJvdGVjdGVkIHBhcnNlQ29sdW1uc1Zpc2libGUoKSB7XG4gICAgY29uc3QgY29sdW1uc0FycmF5ID0gVXRpbC5wYXJzZUFycmF5KHRoaXMudGFibGUuY29sdW1ucyk7XG4gICAgcmV0dXJuIHRoaXMudGFibGUub1RhYmxlT3B0aW9ucy5jb2x1bW5zLmZpbHRlcihvQ29sID0+IG9Db2wudHlwZSAhPT0gXCJpbWFnZVwiICYmIG9Db2wudmlzaWJsZSAmJiBjb2x1bW5zQXJyYXkuZmluZEluZGV4KGNvbHVtbiA9PiBjb2x1bW4gPT09IG9Db2wuYXR0cikgPiAtMSkubWFwKFxuICAgICAgKHg6IE9Db2x1bW4pID0+IHguYXR0clxuICAgIClcbiAgfVxuXG4gIHByb3RlY3RlZCBwYXJzZVJlcG9ydENvbHVtbihjb2x1bW5zOiBhbnlbXSk6IE9SZXBvcnRDb2x1bW5bXSB7XG4gICAgcmV0dXJuIGNvbHVtbnMubWFwKGNvbHVtbiA9PiB7XG4gICAgICBsZXQgcmVwb3J0Q29sdW1uOiBPUmVwb3J0Q29sdW1uID0ge1xuICAgICAgICBpZDogY29sdW1uLCBuYW1lOiB0aGlzLnRyYW5zbGF0ZVNlcnZpY2UuZ2V0KGNvbHVtbilcbiAgICAgIH07XG4gICAgICBsZXQgY29sdW1uU3R5bGUgPSB0aGlzLnBhcnNlQ29sdW1uU3R5bGUoY29sdW1uKTtcbiAgICAgIGlmIChVdGlsLmlzT2JqZWN0KGNvbHVtblN0eWxlKSAmJiBPYmplY3Qua2V5cyhjb2x1bW5TdHlsZSkubGVuZ3RoID4gMCkge1xuICAgICAgICByZXBvcnRDb2x1bW4uY29sdW1uU3R5bGUgPSBjb2x1bW5TdHlsZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXBvcnRDb2x1bW47XG4gICAgfSk7XG4gIH1cblxuICBwcm90ZWN0ZWQgcGFyc2VDb2x1bW5TdHlsZShjb2x1bW46IHN0cmluZyk6IE9SZXBvcnRDb2x1bW5TdHlsZSB7XG4gICAgbGV0IGNvbHVtblN0eWxlOiBPUmVwb3J0Q29sdW1uU3R5bGUgPSB7fTtcbiAgICBjb25zdCByZW5kZXJlciA9IHRoaXMuY3JlYXRlUmVuZGVyZXIoY29sdW1uKTtcbiAgICBpZiAoVXRpbC5pc0RlZmluZWQocmVuZGVyZXIpICYmIFV0aWwuaXNEZWZpbmVkKHJlbmRlcmVyLnR5cGUpKSB7XG4gICAgICBjb2x1bW5TdHlsZS5yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIH1cbiAgICByZXR1cm4gY29sdW1uU3R5bGU7XG4gIH1cblxuICBwcm90ZWN0ZWQgcGFyc2VDb2x1bW5zT3JkZXJCeShjb2x1bW5zT3JkZXJCeTogYW55KTogT1JlcG9ydE9yZGVyQnlbXSB7XG4gICAgcmV0dXJuIGNvbHVtbnNPcmRlckJ5Lm1hcChjb2x1bW4gPT4ge1xuICAgICAgcmV0dXJuIHsgY29sdW1uSWQ6IGNvbHVtbi5jb2x1bW5JZCwgY29sdW1uTmFtZTogY29sdW1uLm5hbWUsIGFzY2VuZGVudDogY29sdW1uLmFzY2VuZGVudCB9XG4gICAgfSk7XG4gIH1cblxuICBwcm90ZWN0ZWQgb3BlblJlcG9ydCgpIHtcbiAgICBjb25zdCBzZXJ2aWNlQ29uZmlndXJhdGlvbiA9IHRoaXMuZ2V0RGVmYXVsdFNlcnZpY2VDb25maWd1cmF0aW9uKHRoaXMuY3VycmVudFByZWZlcmVuY2Uuc2VydmljZSk7XG4gICAgbGV0IHBhdGhTZXJ2aWNlOiBzdHJpbmc7XG4gICAgaWYgKFV0aWwuaXNPYmplY3Qoc2VydmljZUNvbmZpZ3VyYXRpb24pICYmIHNlcnZpY2VDb25maWd1cmF0aW9uLmhhc093blByb3BlcnR5KCdwYXRoJykpIHtcbiAgICAgIHBhdGhTZXJ2aWNlID0gc2VydmljZUNvbmZpZ3VyYXRpb24ucGF0aDtcbiAgICB9XG4gICAgdGhpcy5yZXBvcnRTZXJ2aWNlLmNyZWF0ZVJlcG9ydCh7XG4gICAgICBcInRpdGxlXCI6IHRoaXMuY3VycmVudFByZWZlcmVuY2UudGl0bGUsIFwiZ3JvdXBzXCI6IHRoaXMuY3VycmVudFByZWZlcmVuY2UuZ3JvdXBzLCBcImVudGl0eVwiOiB0aGlzLmN1cnJlbnRQcmVmZXJlbmNlLmVudGl0eSwgXCJwYXRoXCI6IHBhdGhTZXJ2aWNlLFxuICAgICAgXCJzZXJ2aWNlXCI6IHRoaXMuY3VycmVudFByZWZlcmVuY2Uuc2VydmljZSwgXCJ2ZXJ0aWNhbFwiOiB0aGlzLmN1cnJlbnRQcmVmZXJlbmNlLnZlcnRpY2FsLCBcImZ1bmN0aW9uc1wiOiB0aGlzLmN1cnJlbnRQcmVmZXJlbmNlLmZ1bmN0aW9ucyxcbiAgICAgIFwic3R5bGVcIjogdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5zdHlsZSwgXCJzdWJ0aXRsZVwiOiB0aGlzLmN1cnJlbnRQcmVmZXJlbmNlLnN1YnRpdGxlLCBcImNvbHVtbnNcIjogdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5jb2x1bW5zLCBcIm9yZGVyQnlcIjogdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5vcmRlckJ5LFxuICAgICAgXCJsYW5ndWFnZVwiOiB0aGlzLmxhbmd1YWdlXG5cbiAgICB9KS5zdWJzY3JpYmUocmVzID0+IHtcbiAgICAgIGlmIChyZXMgJiYgcmVzLmRhdGEubGVuZ3RoICYmIHJlcy5jb2RlID09PSAwKSB7XG4gICAgICAgIHRoaXMucGRmID0gcmVzLmRhdGFbMF0uZmlsZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGdldEZ1bmN0aW9ucygpIHtcbiAgICB0aGlzLnJlcG9ydFNlcnZpY2UuZ2V0RnVuY3Rpb25zKHtcbiAgICAgIFwiY29sdW1uc1wiOiB0aGlzLmNvbHVtbnNBcnJheSwgXCJlbnRpdHlcIjogdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5lbnRpdHksXG4gICAgICBcInNlcnZpY2VcIjogdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5zZXJ2aWNlLCBcImxhbmd1YWdlXCI6IHRoaXMubGFuZ3VhZ2VcbiAgICB9KS5zdWJzY3JpYmUocmVzID0+IHtcbiAgICAgIGlmIChyZXMgJiYgcmVzLmRhdGEubGVuZ3RoICYmIHJlcy5jb2RlID09PSAwKSB7XG4gICAgICAgIHRoaXMuZnVuY3Rpb25zRGF0YSA9IHRoaXMucGFyc2VEZWZhdWx0RnVuY3Rpb25zRGF0YShyZXMuZGF0YVswXS5mdW5jdGlvbnMpO1xuICAgICAgICB0aGlzLmluaXRpYWxGdW5jdGlvbnNEYXRhID0gVXRpbHMuY2xvbmVPYmplY3QodGhpcy5mdW5jdGlvbnNEYXRhKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHBhcnNlRGVmYXVsdEZ1bmN0aW9uc0RhdGEobGlzdENvbHVtbnM6IE9SZXBvcnRGdW5jdGlvbltdKSB7XG4gICAgcmV0dXJuIGxpc3RDb2x1bW5zLmZpbHRlcihjb2x1bW4gPT5cbiAgICAgIHRoaXMuY29sdW1uc0RhdGEuXG4gICAgICAgIGZpbmRJbmRleChjb2x1bW5EYXRhID0+XG4gICAgICAgICAgY29sdW1uRGF0YS5jb2x1bW5TdHlsZSAmJiBjb2x1bW5EYXRhLmNvbHVtblN0eWxlLnJlbmRlcmVyICYmIGNvbHVtbkRhdGEuY29sdW1uU3R5bGUucmVuZGVyZXIudHlwZSA9PT0gJ3NlcnZpY2UnICYmIGNvbHVtbkRhdGEuaWQgPT09IGNvbHVtbi5jb2x1bW5OYW1lXG4gICAgICAgICkgPT09IC0xXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgcHJlZmVyZW5jZSBkYXRhIGlzIGNvbnNpc3RlbnQgd2l0aCB0aGUgdGFibGUgZGF0YVxuICAgKi9cbiAgcHJpdmF0ZSBjaGVja1ByZWZlcmVuY2VEYXRhKCkge1xuICAgIHRoaXMuY3VycmVudFByZWZlcmVuY2UuY29sdW1ucyA9IHRoaXMuY3VycmVudFByZWZlcmVuY2UuY29sdW1ucy5maWx0ZXIoY29sdW1uID0+IHRoaXMuaW5pdGlhbENvbHVtbnNEYXRhLmZpbmRJbmRleChjb2x1bW5EYXRhID0+IGNvbHVtbkRhdGEuaWQgPT09IGNvbHVtbi5pZCkgPiAtMSk7XG4gICAgdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5ncm91cHMgPSB0aGlzLmN1cnJlbnRQcmVmZXJlbmNlLmdyb3Vwcy5maWx0ZXIoY29sdW1uID0+IHRoaXMuaW5pdGlhbENvbHVtbnNUb0dyb3VwRGF0YS5maW5kSW5kZXgoY29sdW1uRGF0YSA9PiBjb2x1bW5EYXRhID09PSBjb2x1bW4pID4gLTEpO1xuICAgIHRoaXMuY3VycmVudFByZWZlcmVuY2UuZnVuY3Rpb25zID0gdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5mdW5jdGlvbnMuZmlsdGVyKGNvbHVtbiA9PiB0aGlzLmluaXRpYWxGdW5jdGlvbnNEYXRhLmZpbmRJbmRleChjb2x1bW5EYXRhID0+IGNvbHVtbkRhdGEuY29sdW1uTmFtZSA9PT0gY29sdW1uLmNvbHVtbk5hbWUpID4gLTEpO1xuICAgIHRoaXMuY3VycmVudFByZWZlcmVuY2Uub3JkZXJCeSA9IHRoaXMuY3VycmVudFByZWZlcmVuY2Uub3JkZXJCeS5maWx0ZXIoY29sdW1uID0+IHRoaXMuY29sdW1uc09yZGVyQnkuZmluZEluZGV4KGNvbHVtbkRhdGEgPT4gY29sdW1uRGF0YS5jb2x1bW5JZCA9PT0gY29sdW1uLmNvbHVtbklkKSA+IC0xKTtcbiAgfVxuXG4gIGFwcGx5Q29uZmlndXJhdGlvbihjb25maWd1cmF0aW9uOiBhbnkpIHtcbiAgICB0aGlzLmNsZWFyQ3VycmVudFByZWZlcmVuY2VzKCk7XG4gICAgdGhpcy5jdXJyZW50Q29uZmlndXJhdGlvbiA9IGNvbmZpZ3VyYXRpb247XG4gICAgdGhpcy5jdXJyZW50UHJlZmVyZW5jZSA9IEpTT04ucGFyc2UodGhpcy5jdXJyZW50Q29uZmlndXJhdGlvbi5QUkVGRVJFTkNFUyk7XG4gICAgdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5jb2x1bW5zLmZvckVhY2goKGNvbHVtbjogT1JlcG9ydENvbHVtbikgPT4gdGhpcy51cGRhdGVDb2x1bW5zT3JkZXJCeURhdGEoY29sdW1uLmlkKSk7XG5cbiAgICB0aGlzLmNoZWNrUHJlZmVyZW5jZURhdGEoKTtcbiAgICAvLyBTZXQgdGhlIGZ1bmN0aW9uc0RhdGEgd2l0aCB0aGUgZGF0YSB0aGF0IGlzIGxvYWRlZCBmcm9tIHRoZSBjb25maWd1cmF0aW9uIGJlY2F1c2UgaXQgY2hhbmdlc1xuICAgIHRoaXMuZnVuY3Rpb25zRGF0YSA9IHRoaXMuZnVuY3Rpb25zRGF0YS5tYXAoKGZ1bmN0aW9uRGF0YTogT1JlcG9ydEZ1bmN0aW9uKSA9PiB7XG4gICAgICBjb25zdCBpbmRleCA9IHRoaXMuY3VycmVudFByZWZlcmVuY2UuZnVuY3Rpb25zLmZpbmRJbmRleCh4ID0+IHguY29sdW1uTmFtZSA9PT0gZnVuY3Rpb25EYXRhLmNvbHVtbk5hbWUpO1xuICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgZnVuY3Rpb25EYXRhLnR5cGUgPSB0aGlzLmN1cnJlbnRQcmVmZXJlbmNlLmZ1bmN0aW9uc1tpbmRleF0udHlwZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmdW5jdGlvbkRhdGFcbiAgICB9KTtcblxuICAgIHRoaXMuY29sdW1uc0RhdGEuc29ydCgoYTogT1JlcG9ydENvbHVtbiwgYjogT1JlcG9ydENvbHVtbikgPT4ge1xuICAgICAgbGV0IGluZGV4QSA9IHRoaXMuY3VycmVudFByZWZlcmVuY2UuY29sdW1ucy5maW5kSW5kZXgoeCA9PiB4LmlkID09PSBhLmlkKTtcbiAgICAgIGxldCBpbmRleEIgPSB0aGlzLmN1cnJlbnRQcmVmZXJlbmNlLmNvbHVtbnMuZmluZEluZGV4KHggPT4geC5pZCA9PT0gYi5pZCk7XG4gICAgICByZXR1cm4gdGhpcy5nZXRTb3J0SW5kZXgoaW5kZXhBLCBpbmRleEIpO1xuXG4gICAgfSk7XG4gICAgdGhpcy5jb2x1bW5zT3JkZXJCeS5zb3J0KChhOiBPUmVwb3J0T3JkZXJCeSwgYjogT1JlcG9ydE9yZGVyQnkpID0+IHtcbiAgICAgIGxldCBpbmRleEEgPSB0aGlzLmN1cnJlbnRQcmVmZXJlbmNlLm9yZGVyQnkuZmluZEluZGV4KHggPT4geC5jb2x1bW5JZCA9PT0gYS5jb2x1bW5JZCk7XG4gICAgICBsZXQgaW5kZXhCID0gdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5vcmRlckJ5LmZpbmRJbmRleCh4ID0+IHguY29sdW1uSWQgPT09IGIuY29sdW1uSWQpO1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0U29ydEluZGV4KGluZGV4QSwgaW5kZXhCKTtcblxuICAgIH0pO1xuICAgIHRoaXMuY29sdW1uc1RvR3JvdXBEYXRhLnNvcnQoKGE6IHN0cmluZywgYjogc3RyaW5nKSA9PiB7XG4gICAgICBsZXQgaW5kZXhBID0gdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5ncm91cHMuZmluZEluZGV4KHggPT4geCA9PT0gYSk7XG4gICAgICBsZXQgaW5kZXhCID0gdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5ncm91cHMuZmluZEluZGV4KHggPT4geCA9PT0gYik7XG4gICAgICByZXR1cm4gdGhpcy5nZXRTb3J0SW5kZXgoaW5kZXhBLCBpbmRleEIpO1xuICAgIH0pO1xuXG4gIH1cblxuICBwcml2YXRlIGdldFNvcnRJbmRleChpbmRleEE6IG51bWJlciwgaW5kZXhCOiBudW1iZXIpOiBudW1iZXIge1xuICAgIGlmIChpbmRleEEgPT09IC0xKSB7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgaWYgKGluZGV4QiA9PT0gLTEpIHtcbiAgICAgIHJldHVybiBpbmRleEI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBpbmRleEEgLSBpbmRleEI7XG4gICAgfVxuXG4gIH1cblxuICBzaG93Q29sdW1uU3R5bGVEaWFsb2coZXZlbnQ6IEV2ZW50LCBpZDogc3RyaW5nKTogdm9pZCB7XG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgY29uc3QgY29sdW1uRGF0YTogT1JlcG9ydENvbHVtbiA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuY3VycmVudFByZWZlcmVuY2UuY29sdW1ucy5maW5kKCh4OiBPUmVwb3J0Q29sdW1uKSA9PiB4LmlkID09PSBpZCkpO1xuICAgIGlmIChVdGlsLmlzRGVmaW5lZChjb2x1bW5EYXRhKSkge1xuICAgICAgdGhpcy5kaWFsb2dcbiAgICAgICAgLm9wZW4oU3R5bGVEaWFsb2dDb21wb25lbnQsIHtcbiAgICAgICAgICBkYXRhOiBjb2x1bW5EYXRhLFxuICAgICAgICAgIHBhbmVsQ2xhc3M6IFsnby1kaWFsb2ctY2xhc3MnLCAnby10YWJsZS1kaWFsb2cnXVxuICAgICAgICB9KVxuICAgICAgICAuYWZ0ZXJDbG9zZWQoKVxuICAgICAgICAuc3Vic2NyaWJlKChkYXRhOiBPUmVwb3J0Q29sdW1uKSA9PiB7XG4gICAgICAgICAgaWYgKFV0aWwuaXNEZWZpbmVkKGRhdGEpICYmIGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbHVtbiA9IFV0aWxzLmNsb25lT2JqZWN0KGRhdGEpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVDb2x1bW5TdHlsZUNvbmZpZ3VyYXRpb25EYXRhKGNvbHVtbik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gIH1cblxuICB1cGRhdGVDb2x1bW5TdHlsZUNvbmZpZ3VyYXRpb25EYXRhKGRhdGE6IE9SZXBvcnRDb2x1bW4pIHtcblxuXG4gICAgbGV0IGNvbHVtbnMgPSBVdGlscy5jbG9uZU9iamVjdCh0aGlzLmN1cnJlbnRQcmVmZXJlbmNlLmNvbHVtbnMpO1xuICAgIHRoaXMuY3VycmVudFByZWZlcmVuY2UuY29sdW1ucyA9IFtdO1xuICAgIGNvbnN0IGluZGV4Q29sdW1uRGF0YSA9IHRoaXMuY29sdW1uc0RhdGEuZmluZEluZGV4KHggPT4geC5pZCA9PT0gZGF0YS5pZCk7XG4gICAgaWYgKGluZGV4Q29sdW1uRGF0YSA+IC0xKSB7XG4gICAgICB0aGlzLmNvbHVtbnNEYXRhW2luZGV4Q29sdW1uRGF0YV0gPSBkYXRhO1xuICAgIH1cbiAgICBjb25zdCBpbmRleENvbHVtblN0eWxlRGF0YSA9IGNvbHVtbnMuZmluZEluZGV4KHggPT4geC5pZCA9PT0gZGF0YS5pZCk7XG4gICAgaWYgKGluZGV4Q29sdW1uU3R5bGVEYXRhID4gLTEpIHtcbiAgICAgIGNvbHVtbnNbaW5kZXhDb2x1bW5TdHlsZURhdGFdID0gZGF0YTtcbiAgICB9XG5cbiAgICB0aGlzLmN1cnJlbnRQcmVmZXJlbmNlLmNvbHVtbnMgPSBjb2x1bW5zO1xuXG4gIH1cblxuXG4gIHNlbGVjdEZ1bmN0aW9uKGV2ZW50LCByZXBvcnRGdW5jdGlvbjogT1JlcG9ydEZ1bmN0aW9uKTogdm9pZCB7XG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgaWYgKHJlcG9ydEZ1bmN0aW9uLmNvbHVtbk5hbWUgIT0gJ1RPVEFMJykge1xuICAgICAgdGhpcy5kaWFsb2dcbiAgICAgICAgLm9wZW4oU2VsZWN0RnVuY3Rpb25EaWFsb2dDb21wb25lbnQsIHtcbiAgICAgICAgICBkYXRhOiByZXBvcnRGdW5jdGlvbixcbiAgICAgICAgICBwYW5lbENsYXNzOiBbJ28tZGlhbG9nLWNsYXNzJywgJ28tdGFibGUtZGlhbG9nJ11cbiAgICAgICAgfSlcbiAgICAgICAgLmFmdGVyQ2xvc2VkKClcbiAgICAgICAgLnN1YnNjcmliZSgoZGF0YTogYW55KSA9PiB7XG4gICAgICAgICAgLy9VcGRhdGVkIGN1cnJlbnQgZnVuY3Rpb25zIHNlbGVjdGVkIGFuZCBmdW5jdGlvbnNEYXRhXG4gICAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlZEZ1bmN0aW9uRGF0YShkYXRhKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlZFNlbGVjdEZ1bmN0aW9uKGRhdGEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGVkRnVuY3Rpb25EYXRhKGRhdGE6IE9SZXBvcnRGdW5jdGlvbikge1xuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5mdW5jdGlvbnNEYXRhLmZpbmRJbmRleCh4ID0+IHguY29sdW1uTmFtZSA9PT0gZGF0YS5jb2x1bW5OYW1lKTtcbiAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICB0aGlzLmZ1bmN0aW9uc0RhdGEucHVzaChkYXRhKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5mdW5jdGlvbnNEYXRhW2luZGV4XSA9IGRhdGE7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSB1cGRhdGVkU2VsZWN0RnVuY3Rpb24oc2VsZWN0ZWRGdW5jdGlvbjogT1JlcG9ydEZ1bmN0aW9uKSB7XG4gICAgdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5mdW5jdGlvbnMuZm9yRWFjaCgoZGF0YTogYW55LCBpOiBudW1iZXIpID0+IHtcbiAgICAgIGlmIChkYXRhLmNvbHVtbk5hbWUgPT09IHNlbGVjdGVkRnVuY3Rpb24uY29sdW1uTmFtZSkge1xuICAgICAgICB0aGlzLmN1cnJlbnRQcmVmZXJlbmNlLmZ1bmN0aW9uc1tpXSA9IGRhdGE7XG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIG9wZW5TYXZlQXNQcmVmZXJlbmNlcygpOiB2b2lkIHtcbiAgICB0aGlzLmRpYWxvZ1xuICAgICAgLm9wZW4oU2F2ZVByZWZlcmVuY2VzRGlhbG9nQ29tcG9uZW50LCB7XG4gICAgICAgIHBhbmVsQ2xhc3M6IFsnby1kaWFsb2ctY2xhc3MnLCAnby10YWJsZS1kaWFsb2cnXVxuICAgICAgfSlcbiAgICAgIC5hZnRlckNsb3NlZCgpXG4gICAgICAuc3Vic2NyaWJlKChkYXRhOiB7IG5hbWU6IHN0cmluZywgZGVzY3JpcHRpb246IHN0cmluZyB9KSA9PiB7XG4gICAgICAgIGlmIChVdGlsLmlzRGVmaW5lZChkYXRhKSAmJiBkYXRhKSB7XG4gICAgICAgICAgdGhpcy5zYXZlUHJlZmVyZW5jZXMoZGF0YSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gIH1cblxuICBkcm9wQ29sdW1ucyhldmVudDogQ2RrRHJhZ0Ryb3A8c3RyaW5nW10+KSB7XG4gICAgbW92ZUl0ZW1JbkFycmF5KHRoaXMuY29sdW1uc0RhdGEsIGV2ZW50LnByZXZpb3VzSW5kZXgsIGV2ZW50LmN1cnJlbnRJbmRleCk7XG4gICAgdGhpcy51cGRhdGVDb2x1bW5zU29ydCgpO1xuICB9XG5cbiAgZHJvcEdyb3VwcyhldmVudDogQ2RrRHJhZ0Ryb3A8YW55W10+KSB7XG4gICAgbW92ZUl0ZW1JbkFycmF5KHRoaXMuY29sdW1uc1RvR3JvdXBEYXRhLCBldmVudC5wcmV2aW91c0luZGV4LCBldmVudC5jdXJyZW50SW5kZXgpXG4gICAgdGhpcy51cGRhdGVDb2x1bW5Ub0dyb3VwU29ydCgpO1xuICB9XG5cbiAgZHJvcENvbHVtbnNPcmRlckJ5KGV2ZW50OiBDZGtEcmFnRHJvcDxzdHJpbmdbXT4pIHtcbiAgICBtb3ZlSXRlbUluQXJyYXkodGhpcy5jb2x1bW5zT3JkZXJCeSwgZXZlbnQucHJldmlvdXNJbmRleCwgZXZlbnQuY3VycmVudEluZGV4KTtcbiAgICB0aGlzLnVwZGF0ZUNvbHVtbkdyb3VwQnlTb3J0KCk7XG4gIH1cblxuICB1cGRhdGVDb2x1bW5zU29ydCgpIHtcbiAgICB0aGlzLmN1cnJlbnRQcmVmZXJlbmNlLmNvbHVtbnMuc29ydCgoYTogT1JlcG9ydENvbHVtbiwgYjogT1JlcG9ydENvbHVtbikgPT4ge1xuICAgICAgbGV0IGluZGV4QSA9IHRoaXMuY29sdW1uc0RhdGEuZmluZEluZGV4KHggPT4geC5pZCA9PT0gYS5pZCk7XG4gICAgICBsZXQgaW5kZXhCID0gdGhpcy5jb2x1bW5zRGF0YS5maW5kSW5kZXgoeCA9PiB4LmlkID09PSBiLmlkKTtcbiAgICAgIHJldHVybiBpbmRleEEgLSBpbmRleEI7XG4gICAgfSk7XG4gIH1cblxuICB1cGRhdGVDb2x1bW5Hcm91cEJ5U29ydCgpIHtcbiAgICB0aGlzLmN1cnJlbnRQcmVmZXJlbmNlLm9yZGVyQnkuc29ydCgoYTogT1JlcG9ydE9yZGVyQnksIGI6IE9SZXBvcnRPcmRlckJ5KSA9PiB7XG4gICAgICBsZXQgaW5kZXhBID0gdGhpcy5jb2x1bW5zT3JkZXJCeS5maW5kSW5kZXgoeCA9PiB4LmNvbHVtbklkID09PSBhLmNvbHVtbklkKTtcbiAgICAgIGxldCBpbmRleEIgPSB0aGlzLmNvbHVtbnNPcmRlckJ5LmZpbmRJbmRleCh4ID0+IHguY29sdW1uSWQgPT09IGIuY29sdW1uSWQpO1xuICAgICAgcmV0dXJuIGluZGV4QSAtIGluZGV4QjtcbiAgICB9KTtcbiAgfVxuXG4gIHVwZGF0ZUNvbHVtblRvR3JvdXBTb3J0KCkge1xuICAgIHRoaXMuY3VycmVudFByZWZlcmVuY2UuZ3JvdXBzLnNvcnQoKGE6IHN0cmluZywgYjogc3RyaW5nKSA9PiB7XG4gICAgICBsZXQgaW5kZXhBID0gdGhpcy5jb2x1bW5zVG9Hcm91cERhdGEuZmluZEluZGV4KHggPT4geCA9PT0gYSk7XG4gICAgICBsZXQgaW5kZXhCID0gdGhpcy5jb2x1bW5zVG9Hcm91cERhdGEuZmluZEluZGV4KHggPT4geCA9PT0gYik7XG4gICAgICByZXR1cm4gaW5kZXhBIC0gaW5kZXhCO1xuICAgIH0pO1xuICB9XG5cbiAgcHVibGljIG9uQXBwbHlDb25maWd1cmF0aW9uQ2xpY2tlZCgpOiB2b2lkIHtcbiAgICB0aGlzLmRpYWxvZy5vcGVuKEFwcGx5Q29uZmlndXJhdGlvbkRpYWxvZ0NvbXBvbmVudCwge1xuICAgICAgd2lkdGg6ICdjYWxjKCg3NWVtIC0gMTAwJSkgKiAxMDAwKScsXG4gICAgICBtYXhXaWR0aDogJzY1dncnLFxuICAgICAgbWluV2lkdGg6ICczMHZ3JyxcbiAgICAgIGRpc2FibGVDbG9zZTogdHJ1ZSxcbiAgICAgIHBhbmVsQ2xhc3M6IFsnby1kaWFsb2ctY2xhc3MnLCAnby10YWJsZS1kaWFsb2cnXSxcbiAgICAgIGRhdGE6IHsgZW50aXR5OiB0aGlzLmN1cnJlbnRQcmVmZXJlbmNlLmVudGl0eSwgc2VydmljZTogdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5zZXJ2aWNlIH0sXG4gICAgfSkuYWZ0ZXJDbG9zZWQoKVxuICAgICAgLnN1YnNjcmliZSgoZGF0YTogT1JlcG9ydENvbmZpZ3VyYXRpb24pID0+IHtcbiAgICAgICAgaWYgKFV0aWwuaXNEZWZpbmVkKGRhdGEpICYmIGRhdGEpIHtcbiAgICAgICAgICB0aGlzLmFwcGx5Q29uZmlndXJhdGlvbihkYXRhKTtcbiAgICAgICAgICB0aGlzLmFwcGxpZWRDb25maWd1cmF0aW9uID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfSwgX2Vycm9yID0+IHtcbiAgICAgICAgdGhpcy5hcHBsaWVkQ29uZmlndXJhdGlvbiA9IGZhbHNlO1xuICAgICAgfSk7XG4gIH1cblxuICBvcGVuU2F2ZVByZWZlcmVuY2VzKCk6IHZvaWQge1xuICAgIGlmIChVdGlsLmlzRGVmaW5lZCh0aGlzLmN1cnJlbnRDb25maWd1cmF0aW9uLklEKSkge1xuICAgICAgdGhpcy5zYXZlUHJlZmVyZW5jZXMoeyBuYW1lOiB0aGlzLmN1cnJlbnRDb25maWd1cmF0aW9uLk5BTUUsIGRlc2NyaXB0aW9uOiB0aGlzLmN1cnJlbnRDb25maWd1cmF0aW9uLkRFU0NSSVBUSU9OIH0sIHRydWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmRpYWxvZ1xuICAgICAgICAub3BlbihTYXZlUHJlZmVyZW5jZXNEaWFsb2dDb21wb25lbnQsIHtcbiAgICAgICAgICBwYW5lbENsYXNzOiBbJ28tZGlhbG9nLWNsYXNzJywgJ28tdGFibGUtZGlhbG9nJ11cbiAgICAgICAgfSlcbiAgICAgICAgLmFmdGVyQ2xvc2VkKClcbiAgICAgICAgLnN1YnNjcmliZSgoZGF0YTogeyBuYW1lOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcgfSkgPT4ge1xuICAgICAgICAgIGlmIChVdGlsLmlzRGVmaW5lZChkYXRhKSAmJiBkYXRhKSB7XG4gICAgICAgICAgICB0aGlzLnNhdmVQcmVmZXJlbmNlcyhkYXRhLCB0cnVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICB9XG5cbiAgc2F2ZVByZWZlcmVuY2VzKGRhdGE6IGFueSwgdXBkYXRlPzogYm9vbGVhbikge1xuICAgIGxldCBwcmVmZXJlbmNlID0ge1xuICAgICAgXCJuYW1lXCI6IGRhdGEubmFtZSwgXCJkZXNjcmlwdGlvblwiOiBkYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgXCJlbnRpdHlcIjogdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5lbnRpdHksIFwic2VydmljZVwiOiB0aGlzLmN1cnJlbnRQcmVmZXJlbmNlLnNlcnZpY2UsIFwidHlwZVwiOiBcIlJFUE9SVFwiLCBcInBhcmFtc1wiOiB7XG4gICAgICAgIFwidGl0bGVcIjogdGhpcy5jdXJyZW50UHJlZmVyZW5jZS50aXRsZSwgXCJncm91cHNcIjogdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5ncm91cHMsXG4gICAgICAgIFwidmVydGljYWxcIjogdGhpcy5jdXJyZW50UHJlZmVyZW5jZS52ZXJ0aWNhbCwgXCJmdW5jdGlvbnNcIjogdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5mdW5jdGlvbnMsIFwic3R5bGVcIjogdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5zdHlsZSxcbiAgICAgICAgXCJzdWJ0aXRsZVwiOiB0aGlzLmN1cnJlbnRQcmVmZXJlbmNlLnN1YnRpdGxlLCBcImNvbHVtbnNcIjogdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5jb2x1bW5zLCBcIm9yZGVyQnlcIjogdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5vcmRlckJ5LCBcImVudGl0eVwiOiB0aGlzLmN1cnJlbnRQcmVmZXJlbmNlLmVudGl0eSwgXCJzZXJ2aWNlXCI6IHRoaXMuY3VycmVudFByZWZlcmVuY2Uuc2VydmljZVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh1cGRhdGUpIHtcbiAgICAgIHRoaXMucmVwb3J0U2VydmljZS5zYXZlUHJlZmVyZW5jZXModGhpcy5jdXJyZW50Q29uZmlndXJhdGlvbi5JRCwgcHJlZmVyZW5jZSkuc3Vic2NyaWJlKHJlcyA9PiB7XG4gICAgICAgIHRoaXMuc2hvd0NvbmZpcm1PcGVyYXRpbkluU25hY2tCYXIocmVzKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJlcG9ydFNlcnZpY2Uuc2F2ZUFzUHJlZmVyZW5jZXMocHJlZmVyZW5jZSkuc3Vic2NyaWJlKHJlcyA9PiB7XG4gICAgICAgIGlmIChyZXMgJiYgcmVzLmNvZGUgPT09IDApIHtcbiAgICAgICAgICB0aGlzLnNob3dDb25maXJtT3BlcmF0aW5JblNuYWNrQmFyKHJlcyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc2hvd0NvbmZpcm1PcGVyYXRpbkluU25hY2tCYXIocmVzOiBhbnkpIHtcbiAgICBpZiAocmVzICYmIHJlcy5jb2RlID09PSAwKSB7XG4gICAgICB0aGlzLnNuYWNrQmFyU2VydmljZS5vcGVuKCdNRVNTQUdFUy5TQVZFRCcsIHsgaWNvbjogJ2NoZWNrX2NpcmNsZScgfSk7XG4gICAgfVxuICB9XG5cbiAgc2V0RnVsbHNjcmVlbkRpYWxvZygpOiB2b2lkIHtcbiAgICBVdGlscy5zZXRGdWxsc2NyZWVuRGlhbG9nKHRoaXMuZnVsbHNjcmVlbiwgdGhpcy5kaWFsb2dSZWYpO1xuICAgIHRoaXMuZnVsbHNjcmVlbiA9ICF0aGlzLmZ1bGxzY3JlZW47XG4gIH1cblxuICBvblNlbGVjdGlvbkNoYW5nZUNvbHVtbnMoZXZlbnQ6IE1hdFNlbGVjdGlvbkxpc3RDaGFuZ2UpIHtcbiAgICBjb25zdCBzZWxlY3RlZENvbHVtbjogT1JlcG9ydENvbHVtbiA9IGV2ZW50Lm9wdGlvbi52YWx1ZTtcbiAgICBjb25zdCBzZWxlY3RDb2x1bW5JZCA9IHNlbGVjdGVkQ29sdW1uLmlkO1xuICAgIHRoaXMudXBkYXRlQ29sdW1uc09yZGVyQnlEYXRhKHNlbGVjdENvbHVtbklkLCBldmVudCk7XG5cbiAgfVxuXG4gIG9uU2VsZWN0aW9uQ2hhbmdlR3JvdXBzKGV2ZW50OiBNYXRTZWxlY3Rpb25MaXN0Q2hhbmdlKSB7XG4gICAgaWYgKCFldmVudC5vcHRpb24uc2VsZWN0ZWQpIHJldHVybjtcbiAgICBsZXQgZ3JvdXBTZWxlY3RlZDogc3RyaW5nID0gZXZlbnQub3B0aW9uLnZhbHVlO1xuICAgIHRoaXMudXBkYXRlQ29sdW1uc09yZGVyQnlEYXRhKGdyb3VwU2VsZWN0ZWQsIGV2ZW50KTtcbiAgICBpZiAoZXZlbnQub3B0aW9uLnNlbGVjdGVkICYmXG4gICAgICB0aGlzLmN1cnJlbnRQcmVmZXJlbmNlLmNvbHVtbnMuZmluZEluZGV4KHggPT4geC5pZCA9PT0gZ3JvdXBTZWxlY3RlZCkgPT09IC0xKSB7XG4gICAgICBjb25zdCBjb2x1bW5TdHlsZVNlbGVjdGVkOiBPUmVwb3J0Q29sdW1uW10gPSB0aGlzLmNvbHVtbnNEYXRhLmZpbHRlcigoeDogT1JlcG9ydENvbHVtbikgPT4geC5pZCA9PT0gZ3JvdXBTZWxlY3RlZClcbiAgICAgIGlmIChjb2x1bW5TdHlsZVNlbGVjdGVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdGhpcy5hZGRDb2x1bW5EYXRhKGNvbHVtblN0eWxlU2VsZWN0ZWRbMF0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG5cbiAgdXBkYXRlQ29sdW1uc09yZGVyQnlEYXRhKGNvbHVtbklkOiBzdHJpbmcsIGV2ZW50PzogTWF0U2VsZWN0aW9uTGlzdENoYW5nZSkge1xuXG4gICAgaWYgKCFldmVudCkge1xuICAgICAgY29uc3QgZXhpc3RDb2x1bW4gPSB0aGlzLmNvbHVtbnNBcnJheS5maW5kSW5kZXgoY29sID0+IGNvbCA9PT0gY29sdW1uSWQpO1xuICAgICAgaWYgKGV4aXN0Q29sdW1uID09PSAtMSkge1xuICAgICAgICBjb25zb2xlLndhcm4oJ1RoZSBsb2FkZWQgY29uZmlndXJhdGlvbiBoYXMgdGhlIGNvbHVtbiAnICsgY29sdW1uSWQgKyAnIGNvbmZpZ3VyZWQgYnV0IHRoaXMgY29sdW1uIGRvZXMgbm90IGV4aXN0IGFzIGEgdGFibGUgY29sdW1uJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBjb2x1bW5Hcm91cEJ5U2VsZWN0ZWQ6IE9SZXBvcnRPcmRlckJ5ID0geyBjb2x1bW5JZDogY29sdW1uSWQsIGFzY2VuZGVudDogdHJ1ZSB9XG4gICAgbGV0IGluZGV4ID0gdGhpcy5jb2x1bW5zT3JkZXJCeS5maW5kSW5kZXgoeCA9PiB4LmNvbHVtbklkID09PSBjb2x1bW5JZCk7XG4gICAgaWYgKCghZXZlbnQpIHx8IChldmVudCAmJiBldmVudC5vcHRpb24uc2VsZWN0ZWQpKSB7XG4gICAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgIHRoaXMuY29sdW1uc09yZGVyQnkucHVzaChjb2x1bW5Hcm91cEJ5U2VsZWN0ZWQpO1xuICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICB0aGlzLmNvbHVtbnNPcmRlckJ5LnNwbGljZShpbmRleCk7XG4gICAgfVxuXG4gIH1cblxuXG4gIGFkZENvbHVtbkRhdGEoY29sdW1uU2VsZWN0ZWQpIHtcbiAgICAvL09iamVjdCBEZWVwIENsb25pbmdcbiAgICBsZXQgY3VycmVudFByZWZlcmVuY2UgPSBVdGlscy5jbG9uZU9iamVjdCh0aGlzLmN1cnJlbnRQcmVmZXJlbmNlKTtcbiAgICBjdXJyZW50UHJlZmVyZW5jZS5jb2x1bW5zLnB1c2goY29sdW1uU2VsZWN0ZWQpO1xuICAgIHRoaXMuY3VycmVudFByZWZlcmVuY2UgPSBjdXJyZW50UHJlZmVyZW5jZTtcbiAgICB0aGlzLnVwZGF0ZUNvbHVtbnNTb3J0KCk7XG4gIH1cblxuICBvblNlbGVjdGlvbkNoYW5nZUZ1bmN0aW9ucyhldmVudDogTWF0U2VsZWN0aW9uTGlzdENoYW5nZSkge1xuICAgIGlmICghZXZlbnQub3B0aW9uLnNlbGVjdGVkIHx8IGV2ZW50Lm9wdGlvbi52YWx1ZS5jb2x1bW5OYW1lID09PSAnVE9UQUwnKSByZXR1cm47XG4gICAgY29uc3QgZnVuY3Rpb25TZWxlY3QgPSBldmVudC5vcHRpb24udmFsdWU7XG4gICAgY29uc3QgY29sdW1uU2VsZWN0ZWRUb0dyb3VwID0gZnVuY3Rpb25TZWxlY3QuY29sdW1uTmFtZTtcblxuICAgIGlmIChldmVudC5vcHRpb24uc2VsZWN0ZWQgJiZcbiAgICAgIHRoaXMuY3VycmVudFByZWZlcmVuY2UuY29sdW1ucy5maW5kSW5kZXgoeCA9PiB4LmlkID09PSBjb2x1bW5TZWxlY3RlZFRvR3JvdXApID09PSAtMSkge1xuICAgICAgY29uc3QgY29sdW1uID0gdGhpcy5jb2x1bW5zRGF0YS5maW5kKHggPT4geC5pZCA9PT0gY29sdW1uU2VsZWN0ZWRUb0dyb3VwKTtcbiAgICAgIHRoaXMuYWRkQ29sdW1uRGF0YShjb2x1bW4pO1xuICAgIH1cbiAgfVxuXG5cbiAgY2hhbmdlT3JkZXIoY29sdW1uOiBPUmVwb3J0T3JkZXJCeSwgZXZlbnQpIHtcbiAgICBjb25zdCBjb2x1bW5TZWxlY3RlZFRvT3JkZXIgPSB0aGlzLmNvbHVtbnNPcmRlckJ5LmZpbmQoeCA9PiB4LmNvbHVtbklkID09PSBjb2x1bW4uY29sdW1uSWQpO1xuICAgIGlmIChjb2x1bW5TZWxlY3RlZFRvT3JkZXIpIHtcbiAgICAgIGNvbHVtblNlbGVjdGVkVG9PcmRlci5hc2NlbmRlbnQgPSAhY29sdW1uU2VsZWN0ZWRUb09yZGVyLmFzY2VuZGVudDtcbiAgICB9XG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gIH1cblxuICBpc0NoZWNrZWRDb2x1bW4oY29sdW1uOiBPUmVwb3J0Q29sdW1uKSB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudFByZWZlcmVuY2UuY29sdW1ucy5sZW5ndGggPiAwID8gdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5jb2x1bW5zLmZpbHRlcih4ID0+IHguaWQgPT09IGNvbHVtbi5pZCkubGVuZ3RoID4gMCA6IGZhbHNlO1xuICB9XG5cbiAgaXNDaGVja2VkRnVuY3Rpb24oY29sdW1uOiBPUmVwb3J0RnVuY3Rpb24pIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50UHJlZmVyZW5jZS5mdW5jdGlvbnMubGVuZ3RoID4gMCA/IHRoaXMuY3VycmVudFByZWZlcmVuY2UuZnVuY3Rpb25zLmZpbHRlcih4ID0+ICh4LmNvbHVtbk5hbWUgPT09IGNvbHVtbi5jb2x1bW5OYW1lICYmIHgudHlwZSA9PT0gY29sdW1uLnR5cGUpICYmIHgudHlwZSAhPT0gJ1RPVEFMJykubGVuZ3RoID4gMCA6IGZhbHNlO1xuICB9XG5cbiAgY29sdW1uc09yZGVyQnlDb21wYXJlRnVuY3Rpb24oY28xOiBPUmVwb3J0T3JkZXJCeSwgY28yOiBPUmVwb3J0T3JkZXJCeSkge1xuICAgIHJldHVybiBjbzEuY29sdW1uSWQgPT09IGNvMi5jb2x1bW5JZDtcbiAgfVxuXG4gIG9uQ2hlY2tib3hTdHlsZUNsaWNrKHZhbHVlKSB7XG4gICAgaWYgKHRoaXMuY3VycmVudFByZWZlcmVuY2Uuc3R5bGVbdmFsdWVdKSB7XG4gICAgICB0aGlzLmN1cnJlbnRQcmVmZXJlbmNlLnN0eWxlW3ZhbHVlXSA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmN1cnJlbnRQcmVmZXJlbmNlLnN0eWxlW3ZhbHVlXSA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgY29sdW1uc0NvbXBhcmVGdW5jdGlvbihjbzE6IE9SZXBvcnRDb2x1bW4sIGNvMjogT1JlcG9ydENvbHVtbikge1xuICAgIHJldHVybiBjbzEuaWQgPT09IGNvMi5pZDtcbiAgfVxuXG4gIGZ1bmN0aW9uc0NvbXBhcmVGdW5jdGlvbihjbzE6IE9SZXBvcnRGdW5jdGlvbiwgY28yOiBPUmVwb3J0RnVuY3Rpb24pIHtcbiAgICByZXR1cm4gY28xLmNvbHVtbk5hbWUgPT09IGNvMi5jb2x1bW5OYW1lO1xuICB9XG5cblxuXG4gIHByb3RlY3RlZCBjcmVhdGVSZW5kZXJlcihjb2x1bW46IHN0cmluZyk6IGFueSB7XG4gICAgbGV0IG9Db2x1bW46IE9Db2x1bW4gPSB0aGlzLnRhYmxlLm9UYWJsZU9wdGlvbnMuY29sdW1ucy5maW5kKHggPT4geC5hdHRyID09PSBjb2x1bW4pO1xuICAgIGxldCBuZXdSZW5kZXJlcjogYW55O1xuICAgIGlmIChVdGlsLmlzRGVmaW5lZChvQ29sdW1uKSAmJiBVdGlsLmlzRGVmaW5lZChvQ29sdW1uLnR5cGUpICYmIG9Db2x1bW4udHlwZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgIGNvbnN0IHR5cGUgPSBvQ29sdW1uLnR5cGU7XG4gICAgICBuZXdSZW5kZXJlciA9IHt9O1xuXG4gICAgICBsZXQgY29sdW1uUmVuZGVyZXI6IGFueSA9IG9Db2x1bW4ucmVuZGVyZXI7XG4gICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgY2FzZSAnY3VycmVuY3knOlxuICAgICAgICAgIG5ld1JlbmRlcmVyLnR5cGUgPSB0eXBlXG4gICAgICAgICAgbmV3UmVuZGVyZXIuY3VycmVuY3lTeW1ib2wgPSBjb2x1bW5SZW5kZXJlci5jdXJyZW5jeVN5bWJvbDtcbiAgICAgICAgICBuZXdSZW5kZXJlci5jdXJyZW5jeVN5bWJvbFBvc2l0aW9uID0gY29sdW1uUmVuZGVyZXIuY3VycmVuY3lTeW1ib2xQb3NpdGlvbjtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZGF0ZSc6XG4gICAgICAgICAgbmV3UmVuZGVyZXIudHlwZSA9IHR5cGVcbiAgICAgICAgICBuZXdSZW5kZXJlci5mb3JtYXQgPSBjb2x1bW5SZW5kZXJlci5mb3JtYXQ7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2ludGVnZXInOlxuICAgICAgICAgIG5ld1JlbmRlcmVyLnR5cGUgPSB0eXBlXG4gICAgICAgICAgbmV3UmVuZGVyZXIuZ3JvdXBpbmcgPSBjb2x1bW5SZW5kZXJlci5ncm91cGluZztcbiAgICAgICAgICBuZXdSZW5kZXJlci50aG91c2FuZFNlcGFyYXRvciA9IGNvbHVtblJlbmRlcmVyLnRob3VzYW5kU2VwYXJhdG9yO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdyZWFsJzpcbiAgICAgICAgICBuZXdSZW5kZXJlci50eXBlID0gdHlwZVxuICAgICAgICAgIG5ld1JlbmRlcmVyLmRlY2ltYWxTZXBhcmF0b3IgPSBjb2x1bW5SZW5kZXJlci5kZWNpbWFsU2VwYXJhdG9yO1xuICAgICAgICAgIG5ld1JlbmRlcmVyLmdyb3VwaW5nID0gY29sdW1uUmVuZGVyZXIuZ3JvdXBpbmc7XG4gICAgICAgICAgbmV3UmVuZGVyZXIudGhvdXNhbmRTZXBhcmF0b3IgPSBjb2x1bW5SZW5kZXJlci50aG91c2FuZFNlcGFyYXRvcjtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnc2VydmljZSc6XG4gICAgICAgICAgbmV3UmVuZGVyZXIudHlwZSA9IHR5cGVcbiAgICAgICAgICBuZXdSZW5kZXJlci5lbnRpdHkgPSBjb2x1bW5SZW5kZXJlci5lbnRpdHk7XG4gICAgICAgICAgbmV3UmVuZGVyZXIuc2VydmljZSA9IGNvbHVtblJlbmRlcmVyLnNlcnZpY2U7XG4gICAgICAgICAgbmV3UmVuZGVyZXIua2V5Q29sdW1uID0gb0NvbHVtbi5hdHRyO1xuICAgICAgICAgIG5ld1JlbmRlcmVyLmNvbHVtbnMgPSBVdGlsLnBhcnNlQXJyYXkoY29sdW1uUmVuZGVyZXIuY29sdW1ucyk7XG4gICAgICAgICAgbmV3UmVuZGVyZXIudmFsdWVDb2x1bW4gPSBjb2x1bW5SZW5kZXJlci52YWx1ZUNvbHVtbjtcbiAgICAgICAgICBuZXdSZW5kZXJlci5wYXJlbnRLZXlzID0gVXRpbC5wYXJzZUFycmF5KGNvbHVtblJlbmRlcmVyLnBhcmVudEtleXMpO1xuICAgICAgICAgIGNvbnN0IHNlcnZpY2VDb25maWd1cmF0aW9uID0gdGhpcy5nZXREZWZhdWx0U2VydmljZUNvbmZpZ3VyYXRpb24oY29sdW1uUmVuZGVyZXIuc2VydmljZSk7XG4gICAgICAgICAgaWYgKFV0aWwuaXNPYmplY3Qoc2VydmljZUNvbmZpZ3VyYXRpb24pICYmIE9iamVjdC5oYXNPd25Qcm9wZXJ0eShzZXJ2aWNlQ29uZmlndXJhdGlvbi5wYXRoKSkge1xuICAgICAgICAgICAgbmV3UmVuZGVyZXIucGF0aCA9IHNlcnZpY2VDb25maWd1cmF0aW9uLnBhdGg7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbmV3UmVuZGVyZXI7XG4gIH1cbn1cblxuIl19